{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-]","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u4e3b\u9875","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre> <p>https://zhengzihao1998.github.io./</p>"},{"location":"about/","title":"\u5173\u4e8e\u200b\u6211","text":"<p>\u200b\u4e00\u4e2a\u200b\u8bb0\u5f55\u200b\u7b14\u8bb0\u200b\u7684\u200b\u7f51\u7ad9\u200b\uff0c\u200b\u4e3b\u8981\u200b\u662f\u200b\u4e3a\u4e86\u200b\u8d44\u6599\u200b\u67e5\u8be2\u200b\u548c\u200b\u7559\u5b58\u200b</p> \\[x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a}\\]"},{"location":"blog/","title":"\u7b14\u8bb0","text":""},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/","title":"git\u200b\u76f8\u5173\u200b\u6307\u4ee4","text":"<p>\u200b\u6b64\u5904\u200b\u5b58\u653e\u200b\u4e00\u4e9b\u200b\u5173\u4e8e\u200b\u90e8\u7f72\u200b\u9759\u6001\u200b\u9875\u9762\u200b\u76f8\u5173\u200b\u7684\u200bgit\u200b\u6307\u4ee4\u200b</p>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#git-command","title":"git command","text":"<pre><code>echo \"# 1\" &gt;&gt; README.md \ngit init \ngit add README.md           // \u200b\u4f7f\u7528\u200b git add \u200b\u547d\u4ee4\u200b\u5c06\u200b\u5de5\u4f5c\u200b\u533a\u4e2d\u200b\u7684\u200b\u4fee\u6539\u200b\u6dfb\u52a0\u200b\u5230\u200b\u6682\u5b58\u533a\u200b\ngit commit -m \"\u200b\u7b2c\u4e00\u6b21\u200b\u63d0\u4ea4\u200b\"   // \u200b\u5c06\u200b\u6682\u5b58\u533a\u200b\u4e2d\u200b\u7684\u200b\u4fee\u6539\u200b\u63d0\u4ea4\u200b\u5230\u200b\u7248\u672c\u200b\u5e93\u200b\ngit branch -M main \ngit remote add origin https://github.com/zhengzihao1998/1.git\ngit push -u origin main\n\ngit remote add origin https://github.com/zhengzihao1998/1.git\ngit branch -M main \ngit push -u origin main     // \u200b\u5c06\u200b\u672c\u5730\u200b\u7248\u672c\u200b\u5e93\u200b\u7684\u200b\u63d0\u4ea4\u200b\u63a8\u9001\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\n\ngit status          // \u200b\u67e5\u770b\u200b\u54ea\u4e9b\u200b\u6587\u4ef6\u200b\u5728\u200b\u6682\u5b58\u533a\u200b\u4e2d\u200b\n\ngit remote -v       // \u200b\u663e\u793a\u200b\u6240\u6709\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\n\ngit rm -r --cache .\ngit add .           // \u200b\u5c06\u200b\u5de5\u4f5c\u200b\u533a\u4e2d\u200b\u7684\u200b\u6240\u6709\u200b\u4fee\u6539\u200b\u6dfb\u52a0\u200b\u5230\u200b\u6682\u5b58\u533a\u200b\ngit commit -m \u201cgitignore working\u201d\ngit push --force origin main    // \u200b\u672c\u5730\u200b\u8986\u76d6\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\n\ngit init // \u200b\u5728\u200b\u76ee\u5f55\u200b\u4e2d\u200b\u521b\u5efa\u200b\u65b0\u200b\u7684\u200b \u200b\u672c\u5730\u200b Git \u200b\u4ed3\u5e93\u200b\n\nhttps://pypi.tuna.tsinghua.edu.cn/simple\n\nwindows\n\nconda search cudatoolkit --info\nconda search cudnn --info\n\nconda install cudatoolkit=11.8\nconda install cudnn\n\npip3 uninstall urllib3\npip install urllib3==1.23 -i https://pypi.tuna.tsinghua.edu.cn/simple\n</code></pre>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#_1","title":"\u4e2d\u6587\u641c\u7d22\u200b\u652f\u6301","text":""},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#_2","title":"\u914d\u7f6e","text":"<pre><code>pip install jieba -i https://pypi.tuna.tsinghua.edu.cn/simple\n</code></pre>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#mkdocsyml","title":"mkdocs.yml","text":"<pre><code>plugins:\n  - search:\n      separator: '[\\s\\u200b\\-]'\n</code></pre>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#_3","title":"\u8f85\u52a9\u200b\u8d44\u6599","text":"<p>https://www.runoob.com/git/git-branch.html</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/","title":"Discrete-Time Mean-Variance Strategy Based on Reinforcement Learning","text":"<p>Key Words: </p> <p>Autor\uff1a Xiangyu Cui,\u2217, Xun Li, Yun Shi, Si Zhao</p> <p>[TODO]\u200b\u8fd9\u7bc7\u200b\u7efc\u8ff0\u200b\u53ef\u4ee5\u200b\u770b\u4e00\u770b\u200b Hambly, B., Xu, R., and Yang, H. (2023). Recent advances in reinforcement learning in finance. Mathematical Finance, 33(3):437\u2013503.</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#2","title":"2 \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u7684\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898","text":"<ul> <li>2.1 \u200b\u7ecf\u5178\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898\u200b</li> <li>2.2 \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u7684\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898\u200b</li> </ul>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#21","title":"2.1 \u200b\u7ecf\u5178\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898","text":"<p>\u200b\u9996\u5148\u200b\u8003\u8651\u200b\u7531\u200b\u4e24\u4e2a\u200b\u8d44\u4ea7\u200b\u7ec4\u6210\u200b\u7684\u200b\u5e02\u573a\u200b\uff1a</p> <ul> <li>\u200b\u65e0\u98ce\u9669\u200b\u8d44\u4ea7\u200b\uff0c\u200b\u56de\u62a5\u7387\u200b \\(r_f\\)</li> <li>\u200b\u98ce\u9669\u200b\u8d44\u4ea7\u200b\uff0ct\u200b\u5230\u200bt+1\u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u7387\u200b \\(r_t\\)\uff0c\u200b\u670d\u4ece\u200b\u5747\u503c\u200b\u4e3a\u200b \\(a\\)\uff0c\u200b\u65b9\u5dee\u200b\u4e3a\u200b \\(\\sigma^2\\) \u200b\u7684\u200b\u6b63\u6001\u5206\u5e03\u200b\u3002</li> </ul> <p>\u200b\u5047\u8bbe\u200b\uff1a \\(r_t,t=0,1,\\dots,T-1\\)  \u200b\u662f\u200b\u7edf\u8ba1\u200b\u4e0a\u200b\u72ec\u7acb\u200b\u7684\u200b</p> <ul> <li>\u200b\u6295\u8d44\u8005\u200b\u8fdb\u5165\u200b\u5e02\u573a\u200b\u7684\u200b\u521d\u59cb\u200b\u8d22\u5bcc\u200b\u4e3a\u200b \\(x_0\\)</li> <li>\u200b\u6295\u8d44\u8005\u200b\u5e0c\u671b\u200b\u5728\u200b\u7b56\u7565\u200b \\(\\mathbf{u} = \\{u_0, u_1,\\dots,u_{T-1} \\}\\) \u200b\u4e0b\u200b\u7684\u200b\u6700\u7ec8\u200b\u8d22\u5bcc\u200b\u671f\u671b\u503c\u200b\u4e3a\u200b \\(x_T = b\\)</li> </ul> <p>\u200b\u7b80\u5355\u200b\u8bf4\u200b\uff0c\u200b\u6295\u8d44\u8005\u200b\u5c06\u4f1a\u200b\u9762\u4e34\u200b\u4ee5\u4e0b\u200b\u7684\u200b\u4f18\u5316\u200b\u95ee\u9898\u200b\uff1a</p> \\[\\begin{align*}         \\min\\ &amp;\\operatorname{Var}(x_T^u), \\\\[2mm]         \\text{s.t. }&amp;\\mathbb{E}[x_T^u] = b,\\\\[2mm]         &amp;x_{t+1}= r_f x_t + r_t u_t,\\quad\\quad t = 0,1,\\dots,T-1 \\end{align*}\\] <p>\u200b\u5f15\u5165\u200b Lagrange multiplier \\(w\\)\uff0c\u200b\u5c06\u200b\u95ee\u9898\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u65e0\u200b\u7ea6\u675f\u6761\u4ef6\u200b\u95ee\u9898\u200b\u3002</p> \\[\\begin{equation}     \\min_u\\ \\mathbb{E}(x_T^u)^2-b^2-2w(\\mathbb{E}[x_T^u]-b) = \\min_u\\ \\mathbb{E}(x_T^u - w)^2 - (w-b)^2. \\end{equation}\\] <p>\u200b\u8be5\u200b\u95ee\u9898\u200b\u5b58\u5728\u200b\u89e3\u6790\u200b\u89e3\u200b \\(\\mathbf{u}^*=\\{u_0^*,u_1^*,\\dots,u_{T-1}^*\\}\\) \u200b\u4f9d\u8d56\u4e8e\u200b \\(w\\). \u200b\u8be6\u7ec6\u200b\u7684\u200b\u63a8\u5bfc\u200b\u53ef\u89c1\u200b (2000)Optimal dynamic portfolio selection: Multiperiod mean-variance formulation</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#22","title":"2.2 \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u7684\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898","text":"<p>\u200b\u5728\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u6846\u67b6\u200b\u4e2d\u200b\uff0c\u200b\u63a7\u5236\u200b\u8fc7\u7a0b\u200b \\(\\mathbf{u} = \\{u_t,0\\le t &lt;T\\}\\) \u200b\u662f\u200b\u968f\u673a\u5316\u200b\u7684\u200b\uff0c\u200b\u4ee3\u8868\u200b\u63a2\u7d22\u200b\u548c\u200b\u5b66\u4e60\u200b\uff0c\u200b\u4ece\u800c\u200b\u5f62\u6210\u200b\u4e86\u200b\u4ee5\u200b\u6d4b\u5ea6\u200b\u503c\u200b\u6216\u200b\u5206\u5e03\u200b\u63a7\u5236\u200b\u7684\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u5176\u200b\u5bc6\u5ea6\u200b\u51fd\u6570\u200b\u8868\u793a\u200b\u4e3a\u200b \\(\\boldsymbol{\\pi} = \\{\\pi_t,0\\le t &lt; T\\}\\). \u200b\u56e0\u6b64\u200b\uff0c\u200b\u8d22\u5bcc\u200b\u7684\u200b\u52a8\u6001\u200b\u8868\u793a\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     x_{t+1}^\\pi = r_f x_t^\\pi + r_t u_t^\\pi. \\end{equation}\\] <p>\u200b\u5047\u5b9a\u200b\uff1a</p> <ul> <li>\u200b\u8d85\u989d\u200b\u6536\u76ca\u200b \\(r_t\\) \u200b\u670d\u4ece\u200b\u4e00\u4e2a\u200b\u5747\u503c\u200b\u4e3a\u200b \\(a\\) \u200b\u548c\u200b\u65b9\u5dee\u200b \\(\\sigma^2\\) \u200b\u7684\u200b\u5206\u5e03\u200b\u3002</li> <li>\\(u_t^\\pi\\) \u200b\u662f\u200b\u4e00\u4e2a\u200b\u968f\u673a\u200b\u63a7\u5236\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u6982\u7387\u5bc6\u5ea6\u200b\u4e3a\u200b \\(\\pi_t\\)\u3002</li> <li>\\(r_t\\) \u200b\u4e0e\u200b \\(u_t^\\pi\\) \u200b\u662f\u200b\u72ec\u7acb\u200b\u7684\u200b\u3002</li> </ul> <p>\u200b\u90a3\u4e48\u200b\u5728\u200b\u5468\u671f\u200b \\(t\\) \u200b\u5904\u200b\uff0c\\(r_t u_t^\\pi\\) \u200b\u7684\u200b\u6761\u4ef6\u200b\u4e00\u9636\u77e9\u200b\u548c\u200b\u4e8c\u9636\u200b\u77e9\u200b\u53ef\u4ee5\u200b\u8868\u793a\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{align*}     &amp;\\mathbb{E}_t[r_tu_t^\\pi] = \\mathbb{E}_t[r_t]\\mathbb{E}_t[u_t^\\pi] = a\\int_{\\mathbb{R}}u\\pi_t(u)du,\\\\     &amp;\\mathbb{E}_t[(r_tu_t^\\pi)^2]=\\mathbb{E}_t[(r_t)^2]\\mathbb{E}_t[(u_t^\\pi)^2]=(a^2+\\sigma^2)\\int_{\\mathbb{R}}u^2\\pi_t(u)du. \\end{align*}\\] <p>\u200b\u968f\u673a\u200b\u5206\u5e03\u200b\u63a7\u5236\u200b\u8fc7\u7a0b\u200b \\(\\boldsymbol{\\pi} =\\{\\pi_t,0 \\le t &lt; T\\}\\) \u200b\u5efa\u6a21\u200b\u603b\u4f53\u6c34\u5e73\u200b\u7531\u200b\u7d2f\u79ef\u200b\u71b5\u200b\u6355\u6349\u200b\u7684\u200b\u63a2\u7d22\u200b\u3002</p> \\[\\begin{equation*}     \\mathcal{H}(\\boldsymbol{\\pi}) := -\\sum_{t=0}^{T-1}\\int_{\\mathbb{R}}\\pi_t(u)\\ln\\pi_t(u)du. \\end{equation*}\\] <p>\u200b\u5728\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u5e02\u573a\u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u63a2\u7d22\u6027\u200bMV\u200b\u95ee\u9898\u200b\u7684\u200b\u76ee\u6807\u200b\u51fd\u6570\u200b\u53d8\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     V^\\pi = \\min_\\pi \\mathbb{E}\\left[(x_T^\\pi - w)^2 + \\lambda \\sum_{t=0}^{T-1}\\int_{\\mathbb{R}}\\pi_t(u)\\ln\\pi_t(u)du\\right] - (w-b)^2. \\end{equation}\\] \u200b\u539f\u5148\u200b\u7684\u200b\u76ee\u6807\u200b\u51fd\u6570\u200b \\[\\begin{equation*}     \\min_u\\ \\mathbb{E}(x_T^u - w)^2 - (w-b)^2. \\end{equation*}\\] <ul> <li>\\(\\lambda :\\) temperature parameter measures the trade-off between exploitation and exploration in this MV problem.</li> </ul> <p>\u200b\u95ee\u9898\u200b(3)\u200b\u4e2d\u200b\u7406\u8bba\u200b\u7684\u200b\u6700\u4f18\u200b\u53cd\u9988\u200b\u63a7\u5236\u200b\u548c\u200b\u76f8\u5e94\u200b\u7684\u200b\u6700\u4f18\u200b\u503c\u200b\u51fd\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b\u5b9a\u4e49\u200b\u5728\u200b\u7b56\u7565\u200b \\(\\boldsymbol{\\pi}\\) \u200b\u4e0b\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b \\(J(t,x;w)\\):</p> \\[\\begin{equation*}     J(t,x;w) = \\mathbb{E}\\left[(x_T^\\pi - w)^2 + \\lambda \\sum_{s=t}^{T-1}\\int_{\\mathbb{R}}\\pi_s(u)\\ln\\pi_s(u)du \\mid x_t^\\pi = x \\right] - (w-b)^2 \\end{equation*}\\] <p>\\(J^*(t,x;w)\\) \u200b\u79f0\u4e3a\u200b\u95ee\u9898\u200b(3)\u200b\u7684\u200b\u6700\u4f18\u200b\u503c\u200b\u51fd\u6570\u200b\uff1a</p> \\[\\begin{align*}     &amp;J^*(t,x;w) = \\min_{\\pi_{t}, \\ldots, \\pi_{T-1}}\\mathbb{E}\\left[(x_T^\\pi - w)^2 + \\lambda \\sum_{s=t}^{T-1}\\int_{\\mathbb{R}}\\pi_s(u)\\ln\\pi_s(u)du \\mid x_t^\\pi = x \\right] - (w-b)^2,\\\\     &amp;J^*(T,x;w) = (x-w)^2 - (w-b)^2. \\end{align*}\\] <p>Theorem 1. At period t, the optimal value function is given by</p> \\[\\begin{equation}     \\begin{split}         &amp;J^*(t,x;w) \\\\         =&amp;\\left(\\frac{\\sigma^2 r_f^2}{a^2+\\sigma^2}\\right)^{T-t}(x-\\rho_t w)^2 + \\frac{\\lambda}{2}(T-t)\\ln\\left(\\frac{a^2 + \\sigma^2}{\\pi \\lambda}\\right) \\\\         &amp;+ \\frac{\\lambda}{2}\\sum_{i=t+1}^{T}(T-i)\\ln\\left(\\frac{\\sigma^2 r_f^2}{a^2 + \\sigma^2}\\right) - (w-b)^2.     \\end{split} \\end{equation}\\] <p>where \\(\\rho_t = (r_f^{-1})^{T-t}\\). Moreover, the optimal feedback control is Gaussian, with its density function given by</p> \\[\\begin{equation}     \\pi^*(u;t,x,w) = \\mathcal{N}\\left(u \\,\\Bigg| \\, - \\frac{ar_f(x-\\rho_t w)}{a^2 + \\sigma^2}, \\frac{\\lambda}{2(a^2 + \\sigma^2)}\\left( \\frac{a^2 + \\sigma^2}{\\sigma^2 r_f^2} \\right)^{T-t-1}\\right) . \\end{equation}\\] <p>[NOTE:\u200b\u8d85\u989d\u200b\u6536\u76ca\u200b \\(r_t\\) \u200b\u670d\u4ece\u200b\u4e00\u4e2a\u200b\u5747\u503c\u200b\u4e3a\u200b \\(a\\) \u200b\u548c\u200b\u65b9\u5dee\u200b \\(\\sigma^2\\) \u200b\u7684\u200b\u5206\u5e03\u200b\u3002]</p> \u200b\u5b9a\u7406\u200b1\u200b\u6709\u200b\u4e24\u70b9\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b <ol> <li>\u200b\u65b9\u5dee\u200b\u9879\u200b\u8861\u91cf\u200b\u6700\u4f18\u200b\u7684\u200b\u9ad8\u65af\u200b\u7b56\u7565\u200b\u5728\u200b \\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u7684\u200b\u63a2\u7d22\u200b\u7a0b\u5ea6\u200b\uff0c\u200b\u610f\u5473\u7740\u200b\u63a2\u7d22\u200b\u4f1a\u200b\u968f\u7740\u200b\u65f6\u95f4\u200b\u8870\u51cf\u200b\u3002agent \u200b\u521d\u59cb\u200b\u4f1a\u200b\u6700\u5927\u200b\u7a0b\u5ea6\u200b\u7684\u200b\u8fdb\u884c\u200b\u63a2\u7d22\u200b\uff0c\u200b\u7136\u540e\u200b\u63a2\u7d22\u200b\u7a0b\u5ea6\u200b\u4f1a\u200b\u968f\u200b\u65f6\u95f4\u200b\u9010\u6e10\u200b\u8870\u51cf\u200b\u3002 \u200b\u968f\u7740\u200b\u65f6\u95f4\u200b\u63a5\u8fd1\u200b\u5230\u671f\u65e5\u200b\uff0c\u200b\u5229\u7528\u200b\u4f1a\u200b\u4e3b\u5bfc\u200b\u63a2\u7d22\u200b\u5e76\u4e14\u200b\u4f1a\u200b\u53d8\u5f97\u200b\u8d8a\u6765\u8d8a\u200b\u91cd\u8981\u200b\uff0c\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b\u6709\u200b\u4e00\u4e2a\u200b\u5c06\u200b\u5bf9\u200b\u6295\u8d44\u8005\u200b\u7684\u200b\u884c\u52a8\u200b\u8fdb\u884c\u200b\u8bc4\u4f30\u200b\u7684\u200b deadline T\u3002</li> <li>\u200b\u6700\u4f18\u200b\u9ad8\u65af\u200b\u7b56\u7565\u200b\u7684\u200b\u5747\u503c\u200b\u4e0e\u200b\u63a2\u7d22\u200b\u6743\u91cd\u200b \\(\\lambda\\) \u200b\u65e0\u5173\u200b\uff0c\u200b\u65b9\u5dee\u200b\u4e0e\u200b\u72b6\u6001\u200b \\(x\\) \u200b\u65e0\u5173\u200b\u3002\u200b\u5b8c\u7f8e\u200b\u7684\u200b\u5c06\u200b\u5229\u7528\u200b\u548c\u200b\u63a2\u7d22\u200b\u8fdb\u884c\u200b\u4e86\u200b\u5206\u79bb\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u524d\u8005\u200b\u7531\u200b\u5747\u503c\u200b\u6355\u6349\u200b\uff0c\u200b\u540e\u8005\u200b\u7531\u200b\u65b9\u5dee\u200b\u6355\u6349\u200b\u3002</li> </ol>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#3","title":"3. \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u7b97\u6cd5","text":"<p>\u200b\u4e0a\u8ff0\u200b\u5185\u5bb9\u200b\u8bc1\u660e\u200b\u5e76\u200b\u7ed9\u51fa\u200b\u4e86\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u5747\u503c\u200b-\u200b\u65b9\u5dee\u200b\u95ee\u9898\u200b\u7684\u200b\u6700\u4f18\u200b\u89e3\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u8bbe\u8ba1\u200b\u5bf9\u5e94\u200b\u7684\u200bRL\u200b\u7b97\u6cd5\u200b\u6765\u200b \u200b\u76f4\u63a5\u200b\u5b66\u4e60\u200b\u6c42\u89e3\u200b\u548c\u200b\u8f93\u51fa\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u5206\u914d\u200b\u7b56\u7565\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u8981\u200b\u505a\u200b\u7684\u200b\u5185\u5bb9\u200b\u6709\u200b\u4e24\u200b\u90e8\u5206\u200b\uff1a</p> <ul> <li>1.\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u548c\u200b\u7b56\u7565\u200b\u6536\u655b\u200b</li> <li>2.\u200b\u4e00\u4e2a\u200b\u81ea\u200b\u6821\u6b63\u200b\u65b9\u6848\u200b\u6765\u200b\u5b66\u4e60\u200b\u771f\u6b63\u200b\u7684\u200b\u62c9\u683c\u6717\u200b\u65e5\u200b\u4e58\u5b50\u200b \\(w\\) </li> </ul> \u200b\u6ce8\u610f\u200b <p>\u200b\u8be5\u200bRL\u200b\u7b97\u6cd5\u200b\u8df3\u8fc7\u200b\u4e86\u200b\u6a21\u578b\u200b\u53c2\u6570\u200b\u7684\u200b\u4f30\u8ba1\u200b\uff0c\u200b\u5982\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b \\(r_t\\) \u200b\u7684\u200b\u5747\u503c\u200b\u548c\u200b\u65b9\u5dee\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u53c2\u6570\u200b\u96be\u4ee5\u200b\u51c6\u786e\u200b\u4f30\u8ba1\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#31","title":"3.1 \u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u548c\u200b\u7b56\u7565\u200b\u6536\u655b","text":"\u4e3a\u4ec0\u4e48\u200b\u9700\u8981\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u548c\u200b\u7b56\u7565\u200b\u6536\u655b\u200b <p>\u200b\u7b56\u7565\u200b\u6539\u8fdb\u200b\u65b9\u6848\u200b\u53ef\u4ee5\u200b\u5411\u200b\u6b63\u786e\u200b\u7684\u200b\u65b9\u5411\u200b\u66f4\u65b0\u200b\u5f53\u524d\u200b\u7b56\u7565\u200b\uff0c\u200b\u4ee5\u200b\u6539\u8fdb\u200b value function \u3002 \u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u4f1a\u200b\u4fdd\u8bc1\u200b\u8fed\u4ee3\u200b\u540e\u200b\u7684\u200b value function \u200b\u662f\u975e\u200b\u589e\u7684\u200b\uff08\u200b\u5728\u200b\u6700\u5c0f\u5316\u200b\u7684\u200b\u95ee\u9898\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff09\u3002 \u200b\u7b56\u7565\u200b\u6536\u655b\u200b\u4fdd\u8bc1\u200b\u4f1a\u200b\u6700\u7ec8\u200b\u6536\u655b\u200b\u5230\u200b optimal value function \u3002</p> <p>\u200b\u4ee5\u4e0b\u200b\u7ed9\u51fa\u200b\u7684\u200b\u5b9a\u7406\u200b\u8bf4\u660e\u200b\u4e86\u200b\uff0c\u200b\u5728\u200b\u56fa\u5b9a\u200b \\(w\\) \u200b\u548c\u200b\u7ed9\u5b9a\u200b\u670d\u4ece\u200b\u4ee5\u4e0b\u200b\u5206\u5e03\u200b\u7684\u200b\u6700\u521d\u200b\u7684\u200b\u5bb9\u8bb8\u200b\u63a7\u5236\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u6700\u7ec8\u200b\u7b56\u7565\u200b\u4f1a\u200b\u6536\u655b\u200b\u5230\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b</p> <p>Theorem 2. Suppose \\(w\\in \\mathbb{R}\\) is fixed and \\(\\boldsymbol{\\pi}^0\\) is an arbitrarily given admissible feedback control policy, subjecting to</p> \\[  \\pi_t^0(u;x,w) = \\mathcal{N}\\left( u \\mid K(x-\\rho_t w), \\lambda BC^{T-t-1} \\right) \\] <p>Then we can calculate \\(J^{\\pi^0}(t,x;w)\\)</p> \\[\\begin{align*}     \\text{where} &amp;\\\\     &amp; \\rho_t = r_f^{-(T-t)} \\\\     &amp; A=r_f^2 + (a^2 + \\sigma^2)K^2 + 2r_f a K \\\\     &amp; f(t) = \\frac{\\lambda B (a^2 + \\sigma^2)[1-(CA)^{T-t}]}{1-CA} - \\frac{\\lambda}{2}\\ln (2\\pi \\lambda B)(T-t) - \\frac{\\lambda}{2}(T-t)-\\frac{\\lambda}{2}\\ln C\\sum_{i=0}^{T-t-1}i-(w-b)^2  \\end{align*}\\] <p>\\(f(t)\\) is a smooth function that only depends on \\(t\\)</p> \\[\\begin{equation*}     \\begin{split}         &amp;J^{\\pi^0}(t,x;w) \\\\         = &amp; A^{T-t}(x-\\rho_t w)^2 + \\frac{\\lambda B (a^2 + \\sigma^2)[1-(CA)^{T-t}]}{1-CA} - \\frac{\\lambda}{2}\\ln (2\\pi \\lambda B)(T-t)\\\\         &amp; - \\frac{\\lambda}{2}(T-t)-\\frac{\\lambda}{2}\\ln C\\sum_{i=0}^{T-t-1}i-(w-b)^2 \\\\         = &amp; A^{T-t}(x-\\rho_t w)^2 + f(t)     \\end{split} \\end{equation*}\\] <p>Using the condition  \\(\\pi_{t}^{k+1}(u ; x, w)=\\arg \\min _{\\pi_{t}^{k}(u)} J^{\\pi^{k}}(t, x ; w)\\) to update the feedback policy and making this iteration for k times, we can get  \\(\\pi_{t}^{k}(u ; x, w)\\)  and the corresponding value function \\(J^{\\pi^{k}}(t, x ; w):\\)</p> \\[\\begin{equation}     \\pi_{t}^{k}(u ; x, w)=\\mathcal{N}\\left(u \\left\\lvert\\,-\\frac{a r_{f}\\left(x-\\rho_{t} w\\right)}{a^{2}+\\sigma^{2}}\\right., \\frac{\\lambda}{2\\left(a^{2}+\\sigma^{2}\\right) A^{T-t-k}}\\left(\\frac{a^{2}+\\sigma^{2}}{\\sigma^{2} r_{f}^{2}}\\right)^{k-1} \\right), \\end{equation}\\] \\[\\begin{equation}     \\begin{split}         &amp; J^{\\pi^k}(t,x;w) \\\\         = &amp; A^{T-t-k}\\left(\\frac{\\sigma^{2} r_{f}^{2}}{a^{2}+\\sigma^{2}}\\right)^{k}\\left(x-\\rho_{t} w\\right)^{2}+\\frac{\\lambda}{2} k \\ln \\left(\\frac{a^{2}+\\sigma^{2}}{\\pi \\lambda}\\right) \\\\         &amp; + \\frac{\\lambda}{2} \\sum_{i=0}^{k-1} i \\ln \\left(\\frac{\\sigma^{2} r_{f}^{2}}{a^{2}+\\sigma^{2}}\\right) + \\frac{\\lambda \\ln A}{2} k(T-t-k)+f(t+k).     \\end{split} \\end{equation}\\] Note <p>\u200b\u4e0a\u8ff0\u200b\u5b9a\u7406\u200b\u63cf\u8ff0\u200b\u4e86\u200b\u4ee5\u4e0b\u200b\u8fed\u4ee3\u200b\u8fc7\u7a0b\u200b\u662f\u200b\u5408\u7406\u200b\u7684\u200b\u3002\u200b\u5373\u200b\uff1a</p> <p> \u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\uff1a\u200b\u7ed9\u5b9a\u200b\u5f53\u524d\u200b\u7b56\u7565\u200b \\(\\pi^k\\) \u200b\u8ba1\u7b97\u200b\u5176\u200b\u5bf9\u5e94\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b \\(J^{\\pi^k}\\)</p> <p> \u200b\u7b56\u7565\u200b\u6539\u8fdb\u200b\uff1a\u200b\u9009\u62e9\u200b\u8ba9\u200b \\(J^{\\pi^k}\\) \u200b\u6700\u5c0f\u5316\u200b\u7684\u200b\u7b56\u7565\u200b\u5206\u5e03\u200b\uff1a</p> \\[\\pi_{t}^{k+1}(u ; x, w)=\\arg \\min _{\\pi_{t}^{0}(u)} J^{\\pi^{k}}(t, x ; w) \\] <p>\u200b\u8be5\u200b\u5b9a\u7406\u200b\u8bc1\u660e\u200b\u4e86\u200b\uff0c\u200b\u8be5\u200b\u8fed\u4ee3\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u80fd\u591f\u200b\u4f7f\u200b\u66f4\u65b0\u200b\u540e\u200b\u7684\u200b\u7b56\u7565\u200b\u80fd\u591f\u200b\u6536\u655b\u200b\u5230\u200b\u7406\u8bba\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#32","title":"3.2 \u200b\u7b97\u6cd5\u200b\u8bbe\u8ba1","text":"<p>\u200b\u8bbe\u8ba1\u200bRL\u200b\u7b97\u6cd5\u200b\u53bb\u200b\u6c42\u89e3\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u9009\u62e9\u200b\u95ee\u9898\u200b\u3002\u200b\u7b97\u6cd5\u200b\u5305\u542b\u200b\u4e09\u4e2a\u200b\u6b65\u9aa4\u200b\uff1a\u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\uff0c\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u548c\u200b\u5b66\u4e60\u200b Lagrange multiplier \\(w\\) \u200b\u7684\u200b\u81ea\u200b\u6821\u6b63\u200b\u65b9\u6848\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#policy-evaluation","title":"Policy Evaluation","text":"<p>\u200b\u901a\u8fc7\u200b Bellman equation \u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b</p> \\[ J^{\\pi}(t, x ; w)=\\mathbb{E}\\left[J^{\\pi}\\left(t+1, x_{t+1} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}(u) \\ln \\pi_{t}(u) d u \\Bigg| x_{t}=x\\right] \\] <p>\u200b\u5c06\u200b\u65b9\u7a0b\u200b\u8fdb\u884c\u200b\u91cd\u6392\u200b\uff0c\u200b\u5f97\u5230\u200b</p> \\[\\mathbb{E}\\left[J^{\\pi}\\left(t+1, x_{t+1} ; w\\right)-J^{\\pi}\\left(t, x_{t} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}(u) \\ln \\pi_{t}(u) d u \\Bigg| x_{t}=x\\right]=0 \\] <p>\u200b\u5b9a\u4e49\u200b Bellman's error</p> \\[\\delta_{t}=\\hat{J}_{t}^{\\pi}+\\lambda \\int_{\\mathbb{R}} \\pi_{t}(u) \\ln \\pi_{t}(u) d u \\] <p>\u200b\u5176\u4e2d\u200b \\(\\hat{J}_{t}^{\\pi}=J^{\\pi}\\left(t+1, x_{t+1} ; w\\right)-J^{\\pi}\\left(t, x_{t} ; w\\right)\\).</p> <p>\u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\u7684\u200b\u76ee\u6807\u200b\u662f\u200b\u8981\u200b\u6700\u5c0f\u5316\u200b\u8d1d\u5c14\u66fc\u200b\u8bef\u5dee\u200b \\(\\delta_t\\). </p> <ul> <li>\\(J^\\theta\\) \u200b\u53c2\u6570\u200b\u5316\u200b\u7684\u200b value function\uff0c\\(\\theta\\) \u200b\u9700\u8981\u200b\u5b66\u4e60\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u5411\u91cf\u200b</li> <li>\\(\\pi^\\phi\\) \u200b\u53c2\u6570\u200b\u5316\u200b\u7684\u200b policy\uff0c\\(\\phi\\) \u200b\u9700\u8981\u200b\u5b66\u4e60\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u5411\u91cf\u200b</li> </ul> <p>\u200b\u7136\u540e\u200b\u6700\u5c0f\u5316\u200b </p> \\[\\begin{align*}     C(\\theta, \\phi) &amp; =\\frac{1}{2} \\mathbb{E}\\left[\\sum_{i=0}^{T-1}\\left|\\delta_{i}\\right|^{2}\\right] \\\\     &amp; =\\frac{1}{2} \\mathbb{E}\\left[\\sum_{i=0}^{T-1}\\left|J^{\\theta}\\left(i+1, x_{i+1} ; w\\right)-J^{\\theta}\\left(i, x_{i} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{i}^{\\phi}(u) \\ln \\pi_{i}^{\\phi}(u) d u\\right|^{2}\\right] \\\\     &amp; =\\frac{1}{2} \\mathbb{E}\\left[\\sum_{i=0}^{T-1}\\left|\\hat{J}_{i}^{\\theta}+\\lambda \\int_{\\mathbb{R}} \\pi_{i}^{\\phi}(u) \\ln \\pi_{i}^{\\phi}(u) d u\\right|^{2}\\right] \\end{align*}\\] <p>\u200b\u5176\u4e2d\u200b \\(\\pi^{\\phi}=\\left\\{\\pi_{t}^{\\phi}, t=0,1, \\ldots, T-1\\right\\}\\). </p> <p>\u200b\u7528\u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u6536\u96c6\u200b\u6837\u672c\u200b \\(D=\\{(t,x_t),t=0,1,\\dots,T \\}\\)</p> <p>\\(t=0\\)\uff0c\u200b\u521d\u59cb\u200b\u6837\u672c\u200b \\((0,x_0)\\)</p> <p>\\(t=0,1,\\dots,T-1\\)\uff0c\u200b\u91c7\u6837\u200b \\(\\pi_t^\\phi\\) \u200b\u83b7\u5f97\u200b\u5728\u200b\u98ce\u9669\u200b\u8d44\u4ea7\u200b\u7684\u200b\u5206\u914d\u200b \\(u_t\\)\uff0c \u200b\u5e76\u4e14\u200b\u89c2\u5bdf\u200b \\(t+1\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u8d22\u5bcc\u200b\u503c\u200b \\(x_{t+1}\\)</p> <p>\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u53bb\u200b\u8fd1\u4f3c\u200b \\(C(\\theta,\\phi)\\)</p> \\[\\begin{align*}     C(\\theta, \\phi) &amp; =\\frac{1}{2} \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[J^{\\theta}\\left(t+1, x_{t+1} ; w\\right)-J^{\\theta}\\left(t, x_{t} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}^{\\phi}(u) \\ln \\pi_{t}^{\\phi}(u) d u\\right]^{2} \\\\     &amp; =\\frac{1}{2} \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}^{\\phi}(u) \\ln \\pi_{t}^{\\phi}(u) d u\\right]^{2} \\end{align*}\\] <p>\u200b\u6839\u636e\u200b\u5148\u524d\u200b\u6c42\u51fa\u200b\u7684\u200b\u6700\u4f18\u200b\u503c\u200b\u51fd\u6570\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u8003\u8651\u200b\u5c06\u503c\u200b\u51fd\u6570\u53c2\u6570\u200b\u5316\u4e3a\u200b\uff1a</p> \\[J^{\\theta}(t, x ; w)=\\theta_{1}^{T-t}\\left(x-\\rho_{t} w\\right)^{2}+\\theta_{2} t^{2}+\\theta_{3} t+\\theta_{4}, \\] Recall \\[\\begin{align*}         &amp;J^*(t,x;w) \\\\         =&amp;\\left(\\frac{\\sigma^2 r_f^2}{a^2+\\sigma^2}\\right)^{T-t}(x-\\rho_t w)^2 + \\frac{\\lambda}{2}(T-t)\\ln\\left(\\frac{a^2 + \\sigma^2}{\\pi \\lambda}\\right) \\\\         &amp;+ \\frac{\\lambda}{2}\\sum_{i=t+1}^{T}(T-i)\\ln\\left(\\frac{\\sigma^2 r_f^2}{a^2 + \\sigma^2}\\right) - (w-b)^2. \\end{align*}\\] <p>\u200b\u5176\u4e2d\u200b \\(\\rho_t = r_f^{-(T-t)}\\) \u200b\u548c\u200b \\(r_f\\) \u200b\u90fd\u200b\u662f\u200b\u5df2\u77e5\u200b\u7684\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#policy-improvement","title":"Policy Improvement","text":"<p>\u200b\u4ece\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u66f4\u65b0\u200b\u65b9\u6848\u200b\u4e2d\u200b\uff0c\u200b\u7b56\u7565\u200b \\(\\pi_t^{\\phi}(u)\\) \u200b\u7684\u200b\u5747\u503c\u200b\u548c\u200b\u65b9\u5dee\u200b\u5206\u522b\u200b\u662f\u200b\uff0c\\(-\\frac{a r_{f}\\left(x-\\rho_{t} w\\right)}{a^{2}+\\sigma^{2}}\\) \u200b\u548c\u200b \\(\\frac{\\lambda}{2\\left(a^{2}+\\sigma^{2}\\right) \\theta_{1}^{T-t-1}}\\) \u200b\u7531\u6b64\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b\u71b5\u200b</p> \\[\\begin{align*}     H\\left(\\pi_{t}^{\\phi}\\right) &amp; =-\\int_{\\mathbb{R}} \\pi_{t}^{\\phi}(u) \\ln \\pi_{t}^{\\phi}(u) d u \\\\     &amp; =\\frac{1}{2} \\ln \\left(\\frac{\\pi e \\lambda}{a^{2}+\\sigma^{2}}\\right)-\\frac{\\ln \\theta_{1}}{2}(T-t-1) \\end{align*}\\] <p>\u200b\u5c06\u200b\u5176\u200b\u8fdb\u884c\u200b\u53c2\u6570\u200b\u5316\u200b\uff0c\u200b\u8868\u793a\u200b\u4e3a\u200b \\(H\\left(\\pi_{t}^{\\phi}\\right)=\\phi_{1}+\\phi_{2}(T-t-1)\\) \uff0c\u200b\u53ef\u4ee5\u200b\u5bfc\u51fa\u200b\uff1a</p> \\[ \\left\\{\\begin{array}{l}     \\phi_{1}=\\frac{1}{2} \\ln \\left(\\frac{\\pi e \\lambda}{a^{2}+\\sigma^{2}}\\right) \\\\     \\phi_{2}=-\\frac{\\ln \\theta_{1}}{2} \\\\     \\theta_{1}=\\frac{\\sigma^{2} r_{f}^{2}}{a^{2}+\\sigma^{2}}     \\end{array}\\right. \\] <p>\u200b\u7528\u200b \\(\\phi_1\\) \u200b\u548c\u200b \\(\\phi_2\\) \u200b\u91cd\u65b0\u200b\u8868\u793a\u200b\u7b56\u7565\u200b</p> \\[\\begin{align*}     &amp; \\pi_{t}^{\\phi}(u ; x, w) \\\\     = &amp; \\mathcal{N}\\left(u \\left\\lvert\\,-\\frac{a r_{f}\\left(x-\\rho_{t} w\\right)}{a^{2}+\\sigma^{2}}\\right., \\frac{\\lambda}{2\\left(a^{2}+\\sigma^{2}\\right) \\theta_{1}^{T-t-1}}\\right) \\\\     = &amp; \\mathcal{N}\\left(u \\left\\lvert\\,-\\sqrt{\\frac{r_{f}^{2}-e^{-2 \\phi_{2}}}{\\lambda \\pi}} e^{\\frac{2 \\phi_{1}-1}{2}}\\left(x-\\rho_{t} w\\right)\\right., \\frac{1}{2 \\pi} e^{2 \\phi_{2}(T-t-1)+2 \\phi_{1}-1}\\right) \\end{align*}\\] <p>\u200b\u5229\u7528\u200b\u4e0a\u8ff0\u200b\u5f97\u5230\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u5f62\u5f0f\u200b\u7684\u200b \\(H\\left(\\pi_{t}^{\\phi}\\right)=\\phi_{1}+\\phi_{2}(T-t-1)\\)\uff0c\u200b\u91cd\u5199\u200b \\(C(\\theta,\\phi)\\) \u200b\u5f97\u5230\u200b</p> \\[C(\\theta, \\phi)=\\frac{1}{2} \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right]^{2} \\] <p>\u200b\u8be5\u200b\u8bba\u6587\u200b\u91c7\u7528\u200b\u968f\u673a\u200b\u68af\u5ea6\u200b\u4e0b\u964d\u200b\uff08SGD\uff09\u200b\u7684\u200b\u65b9\u5f0f\u200b\u53bb\u200b\u66f4\u65b0\u200b\u53c2\u6570\u200b \\((\\phi_1,\\phi_2)'\\) \u200b\u548c\u200b \\((\\theta_2,\\theta_3)'\\)</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/","title":"Deep Learning in Characteristics-Sorted Factor Models","text":"<p>Key Words: Cross-sectional Returns, Deep Learning, Latent Factors, Nonlinearity, Security Sorting.</p> <p>Autor\uff1a Guanhao Feng, Jingyu He, Nicholas G. Polson, Jianeng Xu*</p> <p>Forthcoming, Journal of Financial and Quantitative Analysis</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#ii","title":"II \u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u548c\u200b\u5b9e\u8bc1\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7","text":"<ul> <li>II.A \u200b\u5df2\u200b\u5b9e\u73b0\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b\u7684\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u4f18\u5316\u200b</li> <li>II.B \u200b\u7279\u5f81\u200b\u6392\u5e8f\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u91cd\u6784\u200b</li> <li>II.C \u200b\u5b9e\u73b0\u200bFama-French\u200b\u6a21\u578b\u200b\u4f5c\u4e3a\u200b\u7279\u4f8b\u200b</li> </ul>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iia","title":"II.A  \u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u4f18\u5316","text":"<p>\u200b\u6807\u51c6\u200b\u7684\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u7ebf\u6027\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u57fa\u4e8e\u200b\u56e0\u5b50\u200b\u98ce\u9669\u200b\u6ea2\u4ef7\u200b(factor risk premia)\u200b\u5206\u89e3\u200b\u5982\u4e0b\u200b:</p> \\[\\begin{equation}     E_{t-1}(r_{i,t}) = \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\boldsymbol{\\lambda_f} \\end{equation}\\] <ul> <li>\\(r_{i,t}:\\) \u200b\u8d44\u4ea7\u200b \\(i\\) \u200b\u5728\u200b\u65f6\u95f4\u200b \\(t\\) \u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b</li> <li>\\(\\boldsymbol{\\beta}_{i,t-1}:\\) \u200b\u56e0\u5b50\u200b\u5728\u200b\u65f6\u95f4\u200b \\(t-1\\) \u200b\u66f4\u65b0\u200b\u7684\u200b\u8f7d\u8377\u200b</li> <li>\\(\\boldsymbol{\\lambda_f}:\\) \\(K \\times 1\\) \u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_t\\) \u200b\u7684\u200b\u98ce\u9669\u200b\u6ea2\u4ef7\u200b</li> </ul> <p>\u200b\u4efb\u4f55\u200b\u6f5c\u5728\u200b\u7684\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b \\(\\alpha_i\\) \u200b\u90fd\u200b\u4f1a\u200b\u88ab\u200b\u6dfb\u52a0\u200b\u5728\u200b\u53f3\u4fa7\u200b</p> \\[\\begin{equation}     E_{t-1}(r_{i,t}) = \\alpha_i + \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\boldsymbol{\\lambda_f} \\end{equation}\\] \u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b <p>\u200b\u7b2c\u4e00\u79cd\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u53ef\u200b\u88ab\u200b\u516c\u5f0f\u200b\u63cf\u8ff0\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     \\tilde{r}_{i t}=a_{i}+b_{i}^{\\prime} \\tilde{f}_{t}+\\tilde{e}_{i t}     \\tag{1} \\end{equation}\\] <ul> <li>\\(i=1,2,\\dots, N\\) \u200b\u4ee3\u8868\u200b\u4e0d\u540c\u200b\u7684\u200b\u80a1\u7968\u200b</li> <li>\\(t = 1,2,\\dots, T\\) \u200b\u4ee3\u8868\u200b\u4e0d\u540c\u200b\u7684\u200b\u65f6\u6bb5\u200b</li> <li>\\(\\tilde{r}_{i t}\\) \u200b\u4ee3\u8868\u200b\u80a1\u7968\u200b \\(i\\) \u200b\u5728\u200b \\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u6536\u76ca\u7387\u200b</li> </ul> <p>\u200b\u8be5\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u542b\u4e49\u200b\u662f\u200b\uff0c\u200b\u80a1\u7968\u200b\u5728\u200b\u6bcf\u200b\u4e00\u200b\u65f6\u523b\u200b\u7684\u200b\u6536\u76ca\u7387\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b\u4e09\u4e2a\u200b\u90e8\u5206\u200b\uff1a</p> <ol> <li>\u200b\u4e0d\u968f\u200b\u65f6\u95f4\u200b\u6539\u53d8\u200b\u7684\u200b\u5e38\u6570\u200b\u9879\u200b \\(a_i\\)\u3002</li> <li>\u200b\u7531\u200b\u67d0\u4e2a\u200b\u53d8\u91cf\u200b \\(\\tilde{f}\\) \u200b\u9a71\u52a8\u200b\u7684\u200b\u90e8\u5206\u200b\u3002</li> <li>\u200b\u6a21\u578b\u200b\u672a\u80fd\u200b\u89e3\u91ca\u200b\u3001\u200b\u4f46\u200b\u4e0e\u200b \\(\\tilde{f}\\) \u200b\u65e0\u5173\u200b\u7684\u200b\u90e8\u5206\u200b\u3002</li> </ol> <p>\u200b\u6309\u7167\u200bBack(2010)\u200b\u4e66\u4e0a\u200b\u7684\u200b\u53eb\u6cd5\u200b\uff0c\u200b\u4e0d\u59a8\u200b\u5c06\u200b\u516c\u5f0f\u200b(1)\u200b\u79f0\u4e3a\u200b\u7edf\u8ba1\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b(statistical factor model)\uff0c \\(\\tilde{f}_t\\) \u200b\u79f0\u4e3a\u200b\u56e0\u5b50\u200b</p> <p>\u200b\u7b2c\u4e8c\u79cd\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u53ef\u4ee5\u200b\u88ab\u200b\u516c\u5f0f\u200b\u63cf\u8ff0\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     E[\\tilde{r}_{it}] = r_{ft} + b_i^\\prime \\lambda_t     \\tag{2} \\end{equation}\\] <ul> <li>\\(r_{ft}\\) \u200b\u662f\u200b \\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u65e0\u98ce\u9669\u200b\u5229\u7387\u200b</li> </ul> <p>\u200b\u8be5\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u542b\u4e49\u200b\u662f\u200b\uff0c\u200b\u80a1\u7968\u200b\u5728\u200b\u6bcf\u200b\u4e00\u200b\u65f6\u523b\u200b\u7684\u200b\u6536\u76ca\u7387\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b\u4e24\u4e2a\u200b\u90e8\u5206\u200b\uff1a</p> <ol> <li>\u200b\u65e0\u98ce\u9669\u200b\u5229\u7387\u200b</li> <li>\u200b\u7531\u200b \\(\\lambda_t\\) \u200b\u8d21\u732e\u200b\u7684\u200b\u90e8\u5206\u200b(\u200b\u4e5f\u200b\u79f0\u4f5c\u200b\u98ce\u9669\u200b\u6ea2\u4ef7\u200b)</li> </ol> <p>GRS\u200b\u68c0\u9a8c\u200b\u3002\u200b\u5982\u679c\u200b\u5b58\u5728\u200b\u5145\u5206\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b\u7684\u200b\u4e8c\u6b21\u200b\u9879\u200b\u5e94\u8be5\u200b\u5728\u200b\u7edf\u8ba1\u200b\u4e0a\u200b\u548c\u200b\u7ecf\u6d4e\u200b\u4e0a\u200b\u90fd\u200b\u662f\u200b\u4e0d\u200b\u663e\u8457\u200b\u7684\u200b\u3002\u200b\u4f46\u662f\u200b\uff0c\u200b\u5728\u200b\u5b66\u672f\u200b\u6587\u732e\u200b\u4e2d\u200b\u5e76\u200b\u4e0d\u200b\u5b58\u5728\u200b\u8fd9\u6837\u200b\u7684\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u3002</p> <p>\u200b\u8fd9\u200b\u7bc7\u6587\u7ae0\u200b\u8bad\u7ec3\u200b\u4e86\u200b\u57fa\u4e8e\u200b\u6ede\u540e\u200b\u7279\u5f81\u200b\u7684\u200bbetas\u200b\u975e\u7ebf\u6027\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u65b9\u7a0b\u200b(2)\u200b\u4e2d\u200b\u603b\u4f53\u200b\u6a21\u578b\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         r_{i,t} &amp;= \\alpha_i + \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\mathbf{f}_t + \\epsilon_{i,t}, \\\\         \\boldsymbol{\\beta}_{i,t-1}^\\intercal &amp; = G(\\mathbf{z}_{i,t-1})     \\end{split} \\end{equation}\\] <p>\u200b\u5176\u4e2d\u200b betas \u200b\u7684\u200b\u5e73\u884c\u200b\u795e\u7ecf\u7f51\u7edc\u200b\\(G(\\cdot )\\) \u200b\u662f\u200b\u4e0e\u200b\u6f5c\u5728\u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_t\\) \u200b\u5171\u540c\u200b\u5b66\u4e60\u200b\u7684\u200b\u3002III.C\u200b\u4e2d\u6709\u200b\u8be6\u7ec6\u200b\u7684\u200b\u51fd\u6570\u200b\u5f62\u5f0f\u200b\u3002</p> <p>\u200b\u8ba9\u200b \\(\\widehat{r}_{i, t}\\) \u200b\u4ee3\u8868\u200b\u7531\u200b\u4ea4\u6613\u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_t\\) \u200b\u6784\u9020\u200b\u7684\u200b\u7ebf\u6027\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u53bb\u200b\u6a21\u62df\u200b\u8d44\u4ea7\u200b\u56de\u62a5\u200b \\(r_{i,t}\\)\u3002 \\(\\widehat{r}_{i, t} = \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\mathbf{f}_t\\)\u3002\u200b\u82e5\u200b\u6b8b\u5dee\u200b\u9879\u200b \\(\\epsilon_{i,t}\\) \u200b\u7684\u200b\u5e73\u5747\u503c\u200b\u4e3a\u200b0\uff0c\u200b\u5219\u200b\u622a\u8ddd\u200b\u9879\u200b\\(\\alpha_{i}\\) \u200b\u7b49\u4e8e\u200b\u5e73\u5747\u200b\u62df\u5408\u200b\u8bef\u5dee\u200b \\(\\frac{1}{T}\\sum_{t=1}^{T}\\alpha_{i,t}\\)\uff0c\u200b\u5176\u4e2d\u200b \\(\\alpha_{i,t} = r_{i,t} - \\widehat{r}_{i,t}\\)</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iib","title":"II.B  \u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u4e2d\u200b\u7684\u200b\u7279\u5f81\u200b\u6392\u5e8f\u200b\u56e0\u5b50","text":"<p>\u200b\u4e3a\u4e86\u200b\u5bf9\u200b\u98ce\u9669\u200b\u8c03\u6574\u200b\u540e\u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b\u8fdb\u884c\u200b\u5efa\u6a21\u200b\uff0c \u200b\u589e\u5f3a\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u9664\u4e86\u200b\\(P_b\\)-factor \u200b\u57fa\u51c6\u200b\u6a21\u578b\u200b \\(\\mathbf{f}_{b,t}\\)  \uff08CAPM\u200b\u6216\u200bFama-French 5\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\uff09\u200b\u4e4b\u5916\u200b\uff0c \u200b\u8fd8\u200b\u751f\u6210\u200b\u4e86\u200b \\(P_d\\) \u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_{d,t}\\)\uff0c \u200b\u5171\u540c\u200b\u5b9a\u4ef7\u200b\u4e2a\u80a1\u200b\u56de\u62a5\u200b\u3002 \u200b\u8fd9\u91cc\u200b\u4f7f\u7528\u200b \\(\\mathbf{f}_t = [\\mathbf{f}_{d,t}^\\intercal,\\mathbf{f}_{b,t}^\\intercal]^\\intercal\\)  \u200b\u8868\u793a\u200b\u4e24\u7ec4\u200b\u56e0\u5b50\u200b\uff0c\u200b\u5373\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u548c\u200b\u57fa\u51c6\u200b\u56e0\u5b50\u200b\u3002 \u200b\u5c06\u200b\u5df2\u200b\u5b9e\u73b0\u200b\u56de\u62a5\u200b\u9884\u6d4b\u200b \\(\\widehat{r}_{i,t}\\) \u200b\u6784\u9020\u200b\u4e3a\u200b \\(\\mathbf{f}_{d,t}\\) \u200b\u548c\u200b \\(\\mathbb{f}_{b,f}\\) \u200b\u7684\u200b\u65e0\u200b\u622a\u8ddd\u200b\u9879\u200b\u7684\u200b\u7ebf\u6027\u7ec4\u5408\u200b\u3002 \u200b\u56e0\u6b64\u200b\uff0c\u200b\u62df\u5408\u200b\u8bef\u5dee\u200b \\(\\alpha_{i,t}\\)\uff0c\u200b\u8861\u91cf\u200b\u4e86\u200b\u6a2a\u622a\u9762\u200b\u548c\u200b\u65f6\u95f4\u200b\u5e8f\u5217\u200b\u7684\u200b\u53d8\u5316\u200b\u3002\u200b\u5b8c\u6574\u200b\u7684\u200b\u6a21\u578b\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         \\widehat{r}_{i,t} &amp; = \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_t \\\\             &amp; = \\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{d,t} + \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{b,t}, \\\\         \\alpha_{i,t} &amp; = r_{i,t} - \\widehat{r}_{i,t}, \\\\         \\mathbf{f}_{d,t} &amp; = \\mathbf{W}_{t-1} \\mathbf{r}_t, \\\\         \\mathbf{W}_{t-1} &amp; = H(\\mathbf{Z}_{t-1}), \\\\         \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1}) &amp; = G(\\mathbf{z}_{i,t-1}),     \\end{split} \\end{equation}\\] <ul> <li>\\(\\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal = [\\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal, \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal]\\)  \u200b\u662f\u200b\u5206\u522b\u200b\u5bf9\u5e94\u200b\u4e8e\u200b\u6f5c\u5728\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u548c\u200b\u57fa\u51c6\u200b\u56e0\u5b50\u200b\u7684\u200b\u52a8\u6001\u200b betas \u3002</li> <li>\\(\\mathbf{r}_t = (r_{1,t},\\dots,r_{N,t})\\) \u200b\u8868\u793a\u200b\u6708\u4efd\u200b \\(t\\) \u200b\u65f6\u200b \\(N\\) \u200b\u4e2a\u80a1\u200b\u7684\u200b\u56de\u62a5\u200b\u5411\u91cf\u200b</li> <li>\\(\\mathbf{W}_{t-1}\\) \u200b\u662f\u200b\u7531\u200b\u6708\u4efd\u200b \\(t\u22121\\) \u200b\u786e\u5b9a\u200b\u7684\u200b \\(P_d \\times N\\) \u200b\u77e9\u9635\u200b\uff0c \u200b\u7528\u4e8e\u200b long-short \u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b\u3002</li> <li>\\(\\mathbf{Z}_{t-1} = (\\mathbf{z}_{1,t-1},\\dots,\\mathbf{z}_{N,t-1})\\)  \u200b\u662f\u200b\u6ede\u540e\u200b\u516c\u53f8\u200b\u7279\u5f81\u200b\u7684\u200b \\(K_0 \\times N\\) \u200b\u7ef4\u200b\u77e9\u9635\u200b\u3002</li> </ul> <p>\u200b\u76ee\u6807\u200b\u662f\u200b\u6700\u5c0f\u5316\u200b\u5728\u200b\u6240\u6709\u200b\u5468\u671f\u200b\u548c\u200b\u8d44\u4ea7\u200b\u7684\u200b\u5df2\u200b\u5b9e\u73b0\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b\u7684\u200b\u4e8c\u6b21\u200b\u548c\u200b\uff1a</p> \\[\\begin{equation}     \\mathcal{L}_\\lambda = \\sum_{i=1}^{N}\\sum_{t=1}^{T_i}(r_{i,t} - \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_t)^2 + \\lambda \\times \\text{penalty(DL)},  \\end{equation}\\]"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iic-fama-french-5","title":"II.C  \u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u4e2d\u200b\u7684\u200bFama-French 5 \u200b\u56e0\u5b50\u200b\u6a21\u578b","text":"Deep Learning Network Architecture"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iii","title":"III \u200b\u6df1\u5ea6\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7684\u200b\u7ed3\u6784","text":"Deep Learning Network Architecture <ul> <li>III.A \u200b\u63ed\u793a\u200b\u5982\u4f55\u200b\u5728\u200b\u524d\u9988\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u5bf9\u200b [inputs] \u200b\u516c\u53f8\u200b\u7279\u5f81\u200b\u8fdb\u884c\u200b\u964d\u7ef4\u200b</li> <li>III.B \u200b\u8ba1\u7b97\u200b\u591a\u7a7a\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b(long-short portfolio)\u200b\u7684\u200b\u6743\u91cd\u200b</li> <li>III.C \u200b\u8ba1\u7b97\u200b [intermediate features] \u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b</li> <li>III.D \u200b\u63cf\u8ff0\u200b\u4f18\u5316\u200b\u76ee\u6807\u200b\uff0c\u200b\u603b\u7ed3\u200b\u5b8c\u6574\u200b\u7684\u200b\u589e\u5f3a\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b</li> </ul> <p>\u200b\u4ee5\u200b\u65f6\u95f4\u200b \\(t\\) \u200b\u4e3a\u200b\u7d22\u5f15\u200b\u7684\u200b\u5178\u578b\u200b\u8bad\u7ec3\u200b\u89c2\u5bdf\u200b\u5305\u62ec\u200b\u4ee5\u4e0b\u200b\u6570\u636e\u7c7b\u578b\u200b\uff1a</p> <ul> <li>\\(\\{r_{i,t}\\}_{i=1}^N\\)\uff0c\\(N\\) \u200b\u53ea\u200b\u4e2a\u80a1\u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b</li> <li>\\(\\{z_{k,i,t-1}:1\\leq k \\leq K_0\\}_{i=1}^N\\)\uff0c\\(N\\) \u200b\u53ea\u200b\u4e2a\u80a1\u200b\u7684\u200b \\(K_0\\) \u200b\u4e2a\u200b\u6ede\u540e\u200b\u7279\u5f81\u200b</li> <li>\\(\\{f_{d,t}\\}_{d=1}^{P_b}\\)\uff0c\\(P_b\\) \u200b\u4e2a\u200b\u57fa\u51c6\u200b\u56e0\u5b50\u200b</li> </ul>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiia","title":"III.A  \u200b\u6df1\u5ea6\u200b\u7279\u5f81","text":"<p>\u200b\u5bf9\u200b\u539f\u59cb\u6570\u636e\u200b\u7684\u200b\u7279\u5f81\u200b\u8fdb\u884c\u200b\u964d\u7ef4\u200b\uff0c\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7684\u200b asset \\(i = 1,2,\\dots,N\\)  \u200b\u548c\u200b \\(l\\)-th \u200b\u5c42\u200b\u7684\u200b\u7ed3\u6784\u200b\u5982\u4e0b\u200b\uff08\u200b\u539f\u59cb\u200b\u8f93\u5165\u200b [inputs] \u200b\u4e3a\u200b \\(l = 0\\) \u200b\u5c42\u200b\uff09\uff1a</p> \\[\\begin{equation*}     \\begin{split}         \\mathbf{z}_{i,t-1}^{[l]} &amp; = F^{[l]}(A^{[l]}\\mathbf{z}_{i,t-1}^{[l-1]} + b^{[l]}),\\quad for \\quad l = 1,2,\\dots,L \\\\         \\mathbf{z}_{i,t-1}^{[0]} &amp; := [z_{1,i,t-1},\\dots,z_{K_0,i,t-1}]^\\intercal,       \\end{split} \\end{equation*}\\] <ul> <li>\\(\\mathbf{z}_{i,t-1}^{[l]}\\)\uff0c\\(K_l \\times N\\) \u200b\u77e9\u9635\u200b \\(\\mathbf{Z}_{t-1}^{[l]}\\) \u200b\u7684\u200b \\(i\\)-th \u200b\u5217\u200b</li> <li>\u200b\u5355\u200b\u53d8\u91cf\u200b\u6fc0\u6d3b\u200b\u51fd\u6570\u200b \\(F(\\cdot) = tanh(\\cdot)\\) \u200b\u4f5c\u7528\u200b\u5230\u200b\u77e9\u9635\u200b\u7684\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u5143\u7d20\u200b\u4e0a\u200b</li> <li>\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7684\u200b\u6743\u91cd\u200b \\(A\\) \u200b\u548c\u200b\u504f\u5dee\u200b \\(b\\) \u200b\u662f\u200b\u8fd9\u90e8\u5206\u200b\u9700\u8981\u200b\u88ab\u200b\u8bad\u7ec3\u200b\u7684\u200b\u53c2\u6570\u200b</li> </ul> \\[\\{(A^{[l]}, b^{[l]}):A^{l}\\in \\mathbb{R}^{K_l \\times K_{l-1}},b^{[l]}\\in \\mathbb{R}^{K_l}    \\}_{l=1}^L \\] <p>\u200b\u4e0e\u200b\u6807\u51c6\u200b\u7684\u200b\u6df1\u5ea6\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7ed3\u6784\u200b\u4e0d\u540c\u200b\uff0c \u200b\u6bcf\u4e2a\u200b\u795e\u7ecf\u5143\u200b\u90fd\u200b\u4e0e\u200b\u524d\u200b\u4e00\u5c42\u200b\u7684\u200b\u6240\u6709\u200b\u795e\u7ecf\u5143\u200b\u5b8c\u5168\u200b\u8fde\u63a5\u200b\uff0c \u200b\u8fd9\u4e9b\u200b\u53d8\u6362\u200b\u662f\u200b\u6309\u5217\u200b\u6267\u884c\u200b\u7684\u200b\uff0c\u200b\u6ca1\u6709\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200b\u80a1\u7968\u200b\u4e4b\u95f4\u200b\u8fdb\u884c\u200b\u901a\u4fe1\u200b\u3002 \u200b\u6b64\u200b\u90e8\u5206\u200b\u4e2d\u200b\u6267\u884c\u200b\u7684\u200b\u6240\u6709\u200b\u53d8\u6362\u200b\u90fd\u200b\u5728\u200b\u5355\u200b\u53ea\u200b\u80a1\u7968\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u3002 \u200b\u4e24\u4e2a\u200b\u4e0d\u540c\u200b\u7684\u200b\u80a1\u7968\u200b\u7684\u200b\u6570\u636e\u200b\uff08\u200b\u548c\u200b\u4e2d\u95f4\u200b\u7ed3\u679c\u200b\uff09\u200b\u662f\u200b\u5206\u5f00\u200b\u7684\u200b\uff0c \u200b\u5e76\u4e14\u200b\u4e0d\u200b\u76f8\u4e92\u200b\u5e72\u6270\u200b\u3002 \u200b\u8fd9\u79cd\u200b\u8bbe\u7f6e\u200b\u5141\u8bb8\u200b\u7279\u5b9a\u200b\u4e2a\u4f53\u200b\u80a1\u7968\u200b\u7684\u200b\u6df1\u5c42\u200b\u7279\u5f81\u200b\u7531\u200b\u5176\u200b\u81ea\u8eab\u200b\u51b3\u5b9a\u200b\uff0c \u200b\u800c\u200b\u4e0d\u662f\u200b\u7531\u200b\u5176\u4ed6\u200b\u80a1\u7968\u200b\u51b3\u5b9a\u200b\u3002 \u200b\u7136\u540e\u200b\uff0c\u200b\u6839\u636e\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u5bf9\u200b\u6240\u6709\u200b\u80a1\u7968\u200b\u8fdb\u884c\u200b\u5206\u7c7b\u200b\uff0c \u200b\u6536\u96c6\u200b\u4e0d\u540c\u200b\u80a1\u7968\u200b\u7684\u200b\u4fe1\u606f\u200b\u3002 \u200b\u5b9e\u8bc1\u200b\u7814\u7a76\u200b\u53d1\u73b0\u200b\uff0c\u200b\u7814\u7a76\u200b\u7ed3\u679c\u200b\u5bf9\u200b\u6fc0\u6d3b\u200b\u51fd\u6570\u200b\u7684\u200b\u9009\u62e9\u200b\u4e0d\u200b\u654f\u611f\u200b\uff0c \u200b\u800c\u200b\u7279\u5f81\u200b\u7684\u200b\u7ec4\u5408\u200b\u548c\u200b\u8f6c\u5316\u200b\u53d1\u6325\u200b\u7740\u200b\u66f4\u200b\u91cd\u8981\u200b\u7684\u200b\u4f5c\u7528\u200b\u3002 \u200b\u8fd9\u79cd\u200b\u591a\u5c42\u200b\u7ed3\u6784\u200b\u603b\u7ed3\u200b\u4e86\u200b\u4ece\u200b\u539f\u59cb\u200b\u7279\u5f81\u200b\u5230\u200b\u4f4e\u7ef4\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u7684\u200b\u4fe1\u606f\u200b\u3002</p> \\[\\begin{align}     \\mathbf{Y}_{t-1} &amp;:= \\mathbf{Z}_{t-1}^{[L]}, \\\\     \\mathbf{Z}_{t-1}^{[l]} &amp;:= F^{[l]}(A^{[l]}\\mathbf{Z}_{t-1}^{[l-1]} + b^{[l]}),\\quad for \\quad l = 1,2,\\dots,L\\\\     \\mathbf{Z}_{t-1}^{[0]} &amp;:= \\mathbf{Z}_{t-1}. \\end{align}\\] Deep Deep Neural Network of Characteristics"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiib","title":"III.B  \u200b\u6392\u5e8f\u200b\u548c\u200b\u975e\u7ebf\u6027\u200b\u6743\u91cd","text":"<p>\u200b\u7ed9\u5b9a\u200b\u7531\u200b\u516c\u5f0f\u200b\uff086\uff09\u200b\u7ed9\u51fa\u200b\u7684\u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u7ed3\u6784\u200b\u5f97\u5230\u200b\u7684\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b \\(\\mathbf{Y}_{t-1}\\)\uff0c\u200b\u53ef\u4ee5\u200b\u6309\u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u6784\u9020\u200b\u7684\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b \\(\\mathbf{W}_{t-1}\\)\u3002</p> <p>\u200b\u5b9a\u4e49\u200b \\(h^{[0]} : \\mathbb{R}^N \\rightarrow [-1,1]^N\\) \u200b\u6839\u636e\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u7684\u200b\u6392\u540d\u200b\u6765\u200b\u8ba1\u7b97\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u7684\u200b\u6743\u91cd\u200b\u3002\u200b\u5f53\u200b\u53d8\u91cf\u200b\u4e3a\u200b\u77e9\u9635\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u5b83\u200b\u4f5c\u7528\u200b\u5230\u200b\u6240\u6709\u200b\u884c\u4e0a\u200b\u3002 \u200b\u8ba9\u200b \\(\\mathbb{y}_{t-1} = (y_1,\\dots,y_N)\\) \u200b\u4e3a\u200b \\(N\\times 1\\)\u200b\u5411\u91cf\u200b\uff0c\u200b\u4ee3\u8868\u200b1\u200b\u4e2a\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b(\\(\\mathbf{Y}_{t-1}\u200b\u7684\u200b\u4e00\u884c\u200b\\)) \u200b\u6743\u91cd\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         \\mathbf{W}_{t-1} = h^{[0]}(\\mathbf{y}_{t-1}) &amp;=              \\begin{matrix}                 \\text{long portfolio} \\\\                 \\overbrace{\\begin{bmatrix}                     \\text{softmax}(y_1^+)\\\\                     \\text{softmax}(y_2^+)\\\\                     \\vdots \\\\                     \\text{softmax}(y_N^+)                 \\end{bmatrix}}             \\end{matrix}              -               \\begin{matrix}                 \\text{short portfolio} \\\\                 \\overbrace{\\begin{bmatrix}                     \\text{softmax}(y_1^-)\\\\                     \\text{softmax}(y_2^-)\\\\                     \\vdots \\\\                     \\text{softmax}(y_N^-)                 \\end{bmatrix}}             \\end{matrix},\\\\             \\text{where} y^+ :&amp;= -50e^{-5y},\\quad y^- := -50e^{5y},\\\\             \\text{softmax}(y_i) &amp;=\\frac{e^{y_i}}{\\sum_{i=1}^{N}e^{y_i}}.     \\end{split} \\end{equation}\\] Comparison: Weight vs. Rank  <p>III.A\u200b\u548c\u200bIII.B\u200b\u5171\u540c\u200b\u8bf4\u660e\u200b\u4e86\u200b\u4ece\u200b\u6ede\u540e\u200b\u7279\u5f81\u200b \\(\\mathbf{Z}_{t\u22121}\\) \u200b\u5230\u200b\u4e2a\u4f53\u200b\u8d44\u4ea7\u200b\u6743\u91cd\u200b\\(\\mathbf{W}_{t-1}\\)\u200b\u7684\u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u53d8\u6362\u200b\u3002\u200b\u4e3a\u4e86\u200b\u7b80\u5355\u200b\u8d77\u200b\u89c1\u200b\uff0c\u200b\u5c06\u200b\u8be5\u200b\u53d8\u6362\u200b\u8bb0\u200b\u4e3a\u200b</p> \\[\\begin{equation}     \\mathbf{W}_{t-1} = H(\\mathbf{Z}_{t-1}) \\end{equation}\\]"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiic-betas","title":"III.C  \u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u548c\u200b\u975e\u7ebf\u6027\u200b\u52a8\u6001\u200bbetas","text":"<p>\u200b\u672c\u200b\u5c0f\u8282\u200b\u7ee7\u7eed\u200b\u6784\u5efa\u200b\u57fa\u4e8e\u200blong-short\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b \\(\\mathbf{W}_{t-1}\\)\u200b\u7684\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\uff0c \u200b\u7136\u540e\u200b\u6784\u5efa\u200b\u4e00\u4e2a\u200b\u7528\u4e8e\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u7684\u200b\u589e\u5f3a\u200b\u7684\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u3002 \u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4e2a\u80a1\u200b\u56de\u62a5\u200b\u548c\u200b\u76f8\u5e94\u200b\u7684\u200b\u6743\u91cd\u200b\u6765\u200b\u521b\u5efa\u200blong-short\u200b\u56e0\u5b50\u200b\u3002 \u200b\u8be5\u200b\u6a21\u578b\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b \\(L\\) \u200b\u5c42\u200b\u751f\u6210\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u3002 \u200b\u518d\u63a5\u200b1\u200b\u5c42\u53bb\u200b\u751f\u6210\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b\\(\\mathbf{W}_{t-1}\\)\uff0c\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         \\mathbf{W}_{t-1} &amp; := \\text{Input frome Equation(9)} \\\\         \\mathbf{f}_{b,t} &amp; := \\mathbf{W}_{t-1} \\mathbf{r}_t \\\\         \\widehat{r}_{i,t} &amp; := \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_t = \\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{d,t} + \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{b,t}     \\end{split} \\end{equation}\\] <p>\u200b\u76ee\u524d\u200b\u5173\u4e8e\u200b\u6761\u4ef6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u6587\u732e\u200b\u4e3b\u8981\u200b\u91c7\u7528\u200b\u4e86\u200b\u7ebf\u6027\u200b\u51fd\u6570\u200b\u5f62\u5f0f\u200b\u6765\u200b\u8868\u793a\u200b\u516c\u53f8\u200b\u7279\u5f81\u200b\u4e0a\u200b\u7684\u200b\u8d1d\u5854\u200b\u7cfb\u6570\u200b\u3002 \u200b\u672c\u200b\u6846\u67b6\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u79cd\u200b\u5185\u90e8\u200b\u4e00\u81f4\u200b\u7684\u200bbeta\u200b\u5efa\u6a21\u200b\u3002 \u200b\u5177\u4f53\u6765\u8bf4\u200b\uff0c\u200b\u5047\u8bbe\u200bbeta\u200b\u9075\u5faa\u200b\u4e00\u4e2a\u200b\u5728\u200b\u540c\u200b\u4e00\u7ec4\u200b\u9ad8\u7ef4\u200b\u7279\u5f81\u200b\u4e0a\u200b\u7684\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7ed3\u6784\u200b \u200b\u6765\u200b\u8bad\u7ec3\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u3002</p> \\[\\begin{equation}     [\\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal, \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal]^\\intercal = G(\\mathbf{z}_{i,t-1}) \\end{equation}\\] <p>\u200b\u5c06\u200bbeta\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u4e0e\u200b\u56e0\u5b50\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u8054\u5408\u200b\u8bad\u7ec3\u200b\uff0c \u200b\u6700\u5c0f\u5316\u200b\u635f\u5931\u200b\u51fd\u6570\u200b\u3002</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiid","title":"III.D  \u200b\u6700\u5c0f\u5316\u200b\u635f\u5931\u200b\u51fd\u6570","text":"\\[\\begin{equation}     \\mathcal{L}_\\lambda(\\widehat{\\Theta }) := \\frac{1}{NT}\\sum_{t=1}^{T}\\sum_{i=1}^{N}(r_{i,t}-\\widehat{r}_{i,t})^2 + \\lambda\\sum_{l=1}^{L-1}\\sum_{i\\neq j}|A_{i,j}^{[l]}|, \\end{equation}\\] <ul> <li>\\(\\widehat{\\Theta }\\) \u200b\u795e\u7ecf\u7f51\u7edc\u200b\u4e2d\u200b\u6240\u6709\u200b\u53c2\u6570\u200b</li> </ul> \\[\\begin{equation}     \\begin{split}         &amp;\\widehat{r}_{i,t} = \\boldsymbol{\\widehat{\\beta}}_d(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{d,t} + \\boldsymbol{\\widehat{\\beta}}_b(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{b,t}\\\\         &amp;[\\boldsymbol{\\widehat{\\beta}}_d(\\mathbf{z}_{i,t-1})^\\intercal, \\boldsymbol{\\widehat{\\beta}}_b(\\mathbf{z}_{i,t-1})^\\intercal]^\\intercal = G(\\mathbf{z}_{i,t-1})     \\end{split} \\end{equation}\\] \\[\\begin{equation}     \\widehat{\\Theta } = \\text{arg min}\\mathcal{L}_\\lambda \\end{equation}\\]"},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/category/git/","title":"Git","text":""},{"location":"blog/category/reinforcement-learning/","title":"Reinforcement Learning","text":""},{"location":"blog/category/deep-learning/","title":"Deep Learning","text":""}]}