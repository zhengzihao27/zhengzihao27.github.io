{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-]","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u4e3b\u9875","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre> <p>https://zhengzihao1998.github.io./</p> <ul> <li> <p> Set up in 5 minutes</p> <p>Install <code>mkdocs-material</code> with <code>pip</code> and get up and running in minutes</p> <p> Getting started</p> </li> <li> <p> It's just Markdown</p> <p>Focus on your content and generate a responsive and searchable static site</p> <p> Reference</p> </li> <li> <p> Made to measure</p> <p>Change the colors, fonts, language, icons, logo and more with a few lines</p> <p> Customization</p> </li> <li> <p> Open Source, MIT</p> <p>Material for MkDocs is licensed under MIT and available on [GitHub]</p> <p> License</p> </li> </ul>"},{"location":"about/","title":"\u5173\u4e8e\u200b\u6211","text":"<p>\u200b\u4e00\u4e2a\u200b\u8bb0\u5f55\u200b\u7b14\u8bb0\u200b\u7684\u200b\u7f51\u7ad9\u200b\uff0c\u200b\u4e3b\u8981\u200b\u662f\u200b\u4e3a\u4e86\u200b\u8d44\u6599\u200b\u67e5\u8be2\u200b\u548c\u200b\u7559\u5b58\u200b</p> \\[x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a}\\]"},{"location":"blog/","title":"\u7b14\u8bb0","text":""},{"location":"blog/2024/09/30/games002-notes/","title":"Linux + Shell","text":"<p>Games002-Notes</p>"},{"location":"blog/2024/09/30/games002-notes/#what","title":"What","text":"<p>Linux \u200b\u662f\u200b\u4e00\u7fa4\u200b\u5f00\u6e90\u200b\u7684\u200b\u3001\u200b\u57fa\u4e8e\u200b Linux \u200b\u5185\u6838\u200b\u7684\u200b\u7c7b\u200b Unix \u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u96c6\u5408\u200b\u3002</p>"},{"location":"blog/2024/09/30/games002-notes/#why","title":"Why","text":"\u4f18\u70b9\u200b\uff1a \u200b\u65b9\u4fbf\u200b\u7684\u200b\u5305\u200b\u7ba1\u7406\u200b  \u200b\u5f00\u6e90\u200b  \u200b\u5feb\u200b\u800c\u200b\u7a33\u5b9a\u200b  \u200b\u529f\u80fd\u9f50\u5168\u200b  ... \u200b\u5e94\u7528\u200b\u573a\u666f\u200b\uff1a \u200b\u8fdc\u7a0b\u200b\u670d\u52a1\u5668\u200b  \u200b\u4eff\u771f\u200b\u73af\u5883\u200b  OS\uff0c\u200b\u7f51\u7edc\u200b\u7b49\u200b\u9886\u57df"},{"location":"blog/2024/09/30/games002-notes/#how","title":"How","text":"<p>\u200b\u4ee5\u4e0b\u200b\u4e09\u79cd\u200b\u65b9\u5f0f\u200b\u9009\u200b\u4e00\u79cd\u200b\u5373\u53ef\u200b\u8bbf\u95ee\u200bLinux  </p> <ol> <li>\u200b\u5b89\u88c5\u200bLinux\u200b\u7cfb\u7edf\u200b\u77e5\u4e4e\u200b </li> <li>\u200b\u4f7f\u7528\u200bWSL\u200b\u5b98\u65b9\u200b\u6587\u6863\u200b </li> <li>\u200b\u4f7f\u7528\u200b\u865a\u62df\u673a\u200b</li> </ol>"},{"location":"blog/2024/09/30/games002-notes/#shell","title":"\u6253\u5f00\u200bShell","text":"UbuntuWindows <pre><code>Ctrl + Alt + T\n</code></pre> <pre><code>PowerShell \u200b\u4e2d\u200b\u952e\u5165\u200b wsl \u200b\u540e\u200b\u56de\u8f66\u200b\n</code></pre>"},{"location":"blog/2024/09/30/games002-notes/#_1","title":"\u5e38\u7528\u547d\u4ee4","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b \u200b\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b <code>date</code> \u200b\u663e\u793a\u200b\u65f6\u95f4\u200b <code>rm</code> \u200b\u5220\u9664\u200b <code>shutdown -h now</code> \u200b\u5173\u95ed\u7cfb\u7edf\u200b <code>mv</code> \u200b\u79fb\u52a8\u200b\u3001\u200b\u91cd\u547d\u540d\u200b <code>man</code> \u200b\u67e5\u770b\u200b\u5e2e\u52a9\u200b\u6587\u6863\u200b <code>cp</code> \u200b\u590d\u5236\u200b <code>cat</code> \u200b\u663e\u793a\u6587\u4ef6\u200b\u5185\u5bb9\u200b <code>touch</code> \u200b\u65b0\u5efa\u200b\u6587\u4ef6\u200b <code>cd</code> \u200b\u5207\u6362\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b <code>ln</code> \u200b\u94fe\u63a5\u200b <code>pwd</code> \u200b\u663e\u793a\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b <code>find</code> \u200b\u5bfb\u627e\u200b\u6587\u4ef6\u200b <code>ls</code> \u200b\u67e5\u770b\u200b\u76ee\u5f55\u200b\u4e2d\u200b\u7684\u200b\u6587\u4ef6\u200b <code>whereis</code> \u200b\u5bfb\u627e\u200b\u547d\u4ee4\u200b\u8def\u5f84\u200b <code>mkdir</code> \u200b\u65b0\u5efa\u200b\u76ee\u5f55\u200b <code>passwd</code> \u200b\u4fee\u6539\u200b\u5bc6\u7801\u200b <code>neofetch</code> \u200b\u67e5\u770b\u200b\u7cfb\u7edf\u200b <code>atop</code> \u200b\u76d1\u89c6\u7cfb\u7edf\u200b <code>less</code> \u200b\u6eda\u52a8\u200b\u67e5\u770b\u200b\u5185\u5bb9\u200b <code>grep</code> \u200b\u641c\u7d22\u200b\u5b57\u7b26\u4e32\u200b <code>exa</code> \u200b\u6bd4\u200b <code>ls</code> \u200b\u66f4\u597d\u200b\u7528\u200b <code>tldr</code> \u200b\u547d\u4ee4\u200b\u63d0\u793a\u200b <p>Note</p> <p>Shell \u200b\u672c\u8d28\u200b\u662f\u200b\u8c03\u7528\u200b\u7cfb\u7edf\u200b\u5185\u7f6e\u200b\u7684\u200b\u7a0b\u5e8f\u200b\u3002 Shell \u200b\u4f1a\u200b\u904d\u5386\u200bPATH(\u200b\u73af\u5883\u53d8\u91cf\u200b)\u200b\u4e2d\u200b\u7684\u200b\u6240\u6709\u200b\u4f4d\u7f6e\u200b\u6765\u200b\u641c\u7d22\u200b</p>"},{"location":"blog/2024/09/30/games002-notes/#linux","title":"Linux\u200b\u4e2d\u200b\u7684\u200b\u8def\u5f84","text":"<ul> <li> \u200b\u7edd\u5bf9\u8def\u5f84\u200b v.s. \u200b\u76f8\u5bf9\u8def\u5f84\u200b \u200b\u7edd\u5bf9\u8def\u5f84\u200b\uff1a<code>/</code>\u200b\u5f00\u5934\u200b \u200b\u76f8\u5bf9\u8def\u5f84\u200b\u4ece\u200b<code>\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b</code>\u200b\u51fa\u53d1\u200b   </li> <li>cd\u200b\u6307\u4ee4\u200b\u5207\u6362\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b  </li> <li> \u200b\u7279\u6b8a\u200b\u8def\u5f84\u200b\uff1a <code>.</code>:\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b   <code>..</code>:\u200b\u7236\u200b\u8def\u5f84\u200b <code>-</code>:\u200b\u4e0a\u6b21\u200b\u5230\u8fbe\u200b\u7684\u200b\u8def\u5f84\u200b <code>~</code>:home\u200b\u6240\u5728\u200b\u8def\u5f84\u200b </li> </ul>"},{"location":"blog/2024/09/30/games002-notes/#reference","title":"Reference","text":"<p>[1] https://games-cn.org/games002-slides/</p>"},{"location":"blog/2024/09/30/games002-notes/","title":"Windows + CMD + PowerShell","text":"<p>Games002-Notes</p>"},{"location":"blog/2024/09/30/games002-notes/#what","title":"What","text":"<p>Windows \u200b\u662f\u200b\u4e00\u7ec4\u200b\u7531\u200b\u5fae\u8f6f\u200b\u5f00\u53d1\u200b\u3001\u200b\u7ecf\u8425\u200b\u3001\u200b\u9500\u552e\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5bb6\u65cf\u200b\u3002</p>"},{"location":"blog/2024/09/30/games002-notes/#cmd","title":"CMD\u200b\u5e38\u7528\u547d\u4ee4","text":"CMD \u200b\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b Linux Shell \u200b\u547d\u4ee4\u200b <code>help</code> \u200b\u67e5\u770b\u200b\u5e2e\u52a9\u200b\u6587\u6863\u200b <code>man</code> <code>cls</code> \u200b\u6e05\u5c4f\u200b <code>clear</code> <code>echo</code> \u200b\u663e\u793a\u200b\u6d88\u606f\u200b <code>echo</code> <code>cd</code> \u200b\u5207\u6362\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b <code>cd</code> <code>del</code>/<code>erase</code> \u200b\u5220\u9664\u200b <code>rm</code> <code>move</code> \u200b\u79fb\u52a8\u200b\u3001\u200b\u91cd\u547d\u540d\u200b <code>mv</code> <code>copy</code> \u200b\u590d\u5236\u200b <code>cp</code> <code>mkdir</code>/<code>md</code> \u200b\u65b0\u5efa\u200b\u76ee\u5f55\u200b <code>mkdir</code> <code>type</code> \u200b\u663e\u793a\u6587\u4ef6\u200b\u5185\u5bb9\u200b <code>cat</code> <code>fc</code> \u200b\u6bd4\u8f83\u200b\u6587\u4ef6\u200b\u5185\u5bb9\u200b <code>diff</code> <code>dir</code> \u200b\u663e\u793a\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b <code>ls</code> <code>findstr</code> \u200b\u641c\u7d22\u200b\u5b57\u7b26\u4e32\u200b <code>grep</code> <code>where</code> \u200b\u5bfb\u627e\u200b\u547d\u4ee4\u200b\u8def\u5f84\u200b <code>whereis</code>"},{"location":"blog/2024/09/30/games002-notes/#_1","title":"\u8d26\u6237\u200b\u6743\u9650","text":"<ul> <li> <p>Windows \u200b\u4e2d\u200b\u4e09\u7c7b\u200b\u4e0d\u540c\u200b\u6743\u9650\u200b\u7684\u200b\u8d26\u6237\u200b  </p> <ul> <li>\u200b\u7ba1\u7406\u5458\u200b\u8d26\u6237\u200b\uff1a\u200b\u6700\u9ad8\u200b\u6743\u9650\u200b\uff0c\u200b\u5b8c\u5168\u200b\u4f7f\u7528\u200b\u8ba1\u7b97\u673a\u200b\uff0c\u200b\u53ef\u200b\u7ba1\u7406\u200b\u5176\u4ed6\u200b\u8d26\u6237\u200b  </li> <li>\u200b\u6807\u51c6\u200b\u7528\u6237\u200b\u8d26\u6237\u200b\uff1a\u200b\u53ef\u4ee5\u200b\u8bbf\u95ee\u200b\u8ba1\u7b97\u673a\u200b\u3001\u200b\u6267\u884c\u7a0b\u5e8f\u200b\uff0c\u200b\u65e0\u6cd5\u200b\u66f4\u6539\u200b\u5f71\u54cd\u200b\u5176\u4ed6\u200b\u7528\u6237\u200b\u7684\u200b\u8bbe\u7f6e\u200b\u4ee5\u53ca\u200b\u7cfb\u7edf\u200b\u8bbe\u7f6e\u200b/\u200b\u5b89\u88c5\u200b\u8f6f\u4ef6\u200b  </li> <li>\u200b\u6765\u5bbe\u200b\u8d26\u6237\u200b\uff1a\u200b\u7528\u4e8e\u200b\u4e34\u65f6\u200b\u8bbf\u95ee\u200b\uff0c\u200b\u65e0\u6cd5\u200b\u66f4\u6539\u200b\u7cfb\u7edf\u200b\u8bbe\u7f6e\u200b\u3001\u200b\u5b89\u88c5\u200b\u5e94\u7528\u200b\u3001\u200b\u8bbf\u95ee\u200b\u79c1\u5bc6\u200b\u6587\u4ef6\u200b  </li> </ul> </li> <li> <p>\u200b\u4e3a\u200b\u7a0b\u5e8f\u200b\u63d0\u5347\u200b\u6743\u9650\u200b\u2014\u2014\u201c\u200b\u4ee5\u200b\u7ba1\u7406\u5458\u200b\u8eab\u4efd\u200b\u8fd0\u884c\u200b\u201d</p> </li> </ul>"},{"location":"blog/2024/09/30/games002-notes/#reference","title":"Reference","text":"<p>[1] https://games-cn.org/games002-slides/</p>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/","title":"git\u200b\u76f8\u5173\u200b\u6307\u4ee4","text":"<p>\u200b\u6b64\u5904\u200b\u5b58\u653e\u200b\u4e00\u4e9b\u200b\u5173\u4e8e\u200b\u90e8\u7f72\u200b\u9759\u6001\u200b\u9875\u9762\u200b\u76f8\u5173\u200b\u7684\u200bgit\u200b\u6307\u4ee4\u200b</p>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#git-command","title":"git command","text":"<pre><code>echo \"# 1\" &gt;&gt; README.md \ngit init \ngit add README.md           // \u200b\u4f7f\u7528\u200b git add \u200b\u547d\u4ee4\u200b\u5c06\u200b\u5de5\u4f5c\u200b\u533a\u4e2d\u200b\u7684\u200b\u4fee\u6539\u200b\u6dfb\u52a0\u200b\u5230\u200b\u6682\u5b58\u533a\u200b\ngit commit -m \"\u200b\u7b2c\u4e00\u6b21\u200b\u63d0\u4ea4\u200b\"   // \u200b\u5c06\u200b\u6682\u5b58\u533a\u200b\u4e2d\u200b\u7684\u200b\u4fee\u6539\u200b\u63d0\u4ea4\u200b\u5230\u200b\u7248\u672c\u200b\u5e93\u200b\ngit branch -M main \ngit remote add origin https://github.com/zhengzihao1998/1.git\ngit push -u origin main\n\ngit remote add origin https://github.com/zhengzihao1998/1.git\ngit branch -M main \ngit push -u origin main     // \u200b\u5c06\u200b\u672c\u5730\u200b\u7248\u672c\u200b\u5e93\u200b\u7684\u200b\u63d0\u4ea4\u200b\u63a8\u9001\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\n\ngit status          // \u200b\u67e5\u770b\u200b\u54ea\u4e9b\u200b\u6587\u4ef6\u200b\u5728\u200b\u6682\u5b58\u533a\u200b\u4e2d\u200b\n\ngit remote -v       // \u200b\u663e\u793a\u200b\u6240\u6709\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\n\ngit rm -r --cache .\ngit add .           // \u200b\u5c06\u200b\u5de5\u4f5c\u200b\u533a\u4e2d\u200b\u7684\u200b\u6240\u6709\u200b\u4fee\u6539\u200b\u6dfb\u52a0\u200b\u5230\u200b\u6682\u5b58\u533a\u200b\ngit commit -m \u201cgitignore working\u201d\ngit push --force origin main    // \u200b\u672c\u5730\u200b\u8986\u76d6\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\n\ngit init // \u200b\u5728\u200b\u76ee\u5f55\u200b\u4e2d\u200b\u521b\u5efa\u200b\u65b0\u200b\u7684\u200b \u200b\u672c\u5730\u200b Git \u200b\u4ed3\u5e93\u200b\n</code></pre>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#conda","title":"conda","text":"<pre><code>// \u200b\u6e05\u534e\u200b\u6e90\u200b\nhttps://pypi.tuna.tsinghua.edu.cn/simple\n\npip install \u200b\u7b2c\u4e09\u65b9\u200b\u5e93\u200b\u7684\u200b\u540d\u79f0\u200b -i https://pypi.tuna.tsinghua.edu.cn/simple\n\n//windows powershell\n\nconda search cudatoolkit --info\nconda search cudnn --info\n\nconda install cudatoolkit=11.8\nconda install cudnn\n\npip3 uninstall urllib3\npip install urllib3==1.23 -i https://pypi.tuna.tsinghua.edu.cn/simple\n\n// wsl\nnvidia-smi \uff0c\u200b\u770b\u5230\u200b\u663e\u5361\u200b\u5f53\u524d\u200b\u7684\u200b\u72b6\u6001\u200b\u4f8b\u5982\u200b\u6e29\u5ea6\u200b\u3001\u200b\u663e\u5b58\u200b\u5360\u7528\u200b\u60c5\u51b5\u200b\u7b49\u200b\nwatch -n 1 nvidia-smi # 1\u200b\u8868\u793a\u200b\u6bcf\u200b1\u200b\u79d2\u200b\u5237\u65b0\u200b\u4e00\u6b21\u200b\n\nsource ~/.bashrc   \u200b\u4f7f\u7528\u200b\u4ee3\u7801\u200b\uff0c\u200b\u6fc0\u6d3b\u200bconda\n\n// \u200b\u5220\u9664\u200bubuntu\u200b\u5b50\u7cfb\u7edf\u200b\nwsl --unregister Ubuntu-22.04.4 LTS\n\nconda --version\nconda activate\nconda deactivate\n\nconda create -n \u200b\u865a\u62df\u73af\u5883\u200b\u540d\u79f0\u200b python=3.10\nconda activate \u200b\u865a\u62df\u73af\u5883\u200b\u540d\u79f0\u200b\nconda info --env\n\nconda env list\nconda env remove -n &lt;\u200b\u865a\u62df\u73af\u5883\u200b\u540d\u79f0\u200b&gt;\n\nexit()\u200b\u6216\u200bquit()\n\n\n// \u200b\u4f7f\u7528\u200b VSCode \u200b\u6253\u5f00\u200b\u5f53\u524d\u200b\u8def\u5f84\u200b\u7684\u200b\ud83d\udcc2\u200b\u6587\u4ef6\u5939\u200b\ncode ./\n\n\n// \u200b\u5220\u9664\u200b\u6587\u4ef6\u5939\u200b    \nrm \u200b\u6587\u4ef6\u5939\u200b\nrm -rf /root/logs/game\n\n\npowershell\n1.\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e0b\u200b\n  \u200b\u65b0\u5efa\u200b\u6587\u4ef6\u200b\n    New-item 1\uff08\u200b\u6587\u4ef6\u540d\u200b\uff09.doc\uff08\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u540e\u7f00\u200bdoc\\txt\u200b\u7b49\u200b\uff09\n    New-item  1.doc\n  \u200b\u5220\u9664\u200b\u6587\u4ef6\u200b\n    remove-item\u200b\u7a7a\u683c\u200b1\uff08\u200b\u6587\u4ef6\u540d\u200b\uff09.doc\uff08\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u540e\u7f00\u200bdoc\\txt\u200b\u7b49\u200b\uff09\n    remove-item  1.doc\n  \u200b\u5bf9\u200b\u6587\u4ef6\u200b\u6dfb\u52a0\u200b\u5185\u5bb9\u200b\n    Set-content \u200b\u7a7a\u683c\u200b1.txt\uff08\u200b\u6587\u4ef6\u540d\u200b+\u200b\u540e\u7f00\u200b\uff09\u200b\u7a7a\u683c\u200b-value\u200b\u7a7a\u683c\u200b\u201d123\uff08\u200b\u5185\u5bb9\u200b\uff09\u201d\n    Set-content  1.txt  -value  \u201c123\u201d\n  \u200b\u5728\u200b\u6587\u4ef6\u200b\u4e2d\u52a0\u200b\u5185\u5bb9\u200b\n    add-content\u200b\u7a7a\u683c\u200b1.txt(\u200b\u6587\u4ef6\u540d\u200b+\u200b\u540e\u7f00\u200b)\u200b\u7a7a\u683c\u200b-value \u200b\u7a7a\u683c\u200b\"123\u201d\uff08\u200b\u8981\u200b\u6dfb\u52a0\u200b\u7684\u200b\u5185\u5bb9\u200b\uff09\n    add-content   1.doc  -value  \u201c123\u201d\n  \u200b\u5220\u9664\u200b\u6587\u4ef6\u200b\u5185\u5bb9\u200b\n    Clear-content\u200b\u7a7a\u683c\u200b1.txt\uff08\u200b\u6587\u4ef6\u540d\u200b\uff09\n    Clear-content  1.txt\n  \u200b\u6253\u5f00\u200b\u521b\u5efa\u200b\u7684\u200b\u6587\u4ef6\u200b\n    .\\1.txt\n    .\\\u200b\u6587\u4ef6\u540d\u200b+\u200b\u540e\u7f00\u200b\n\n2.\u200b\u5728\u200b\u5176\u4ed6\u200b\u76ee\u5f55\u200b\n\n\nWSL \u200b\u8bbf\u95ee\u200b Windows \u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b/mnt/{Windows\u200b\u76d8\u7b26\u200b}\nls\uff1a\u200b\u5217\u51fa\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e2d\u200b\u7684\u200b\u6587\u4ef6\u200b\u548c\u200b\u5b50\u76ee\u5f55\u200b\npwd \u200b\u5f53\u524d\u200b\u8def\u5f84\u200b\n\n\u200b\u8fd0\u884c\u200bpython\u200b\u6587\u4ef6\u200b python main.py\n</code></pre> <p>\u200b\u6279\u91cf\u200b\u6ce8\u91ca\u200b ctrl + K + C \u200b\u53d6\u6d88\u200b\u6ce8\u91ca\u200b ctrl + K + U</p>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#_1","title":"\u4e2d\u6587\u641c\u7d22\u200b\u652f\u6301","text":""},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#_2","title":"\u914d\u7f6e","text":"<pre><code>pip install jieba -i https://pypi.tuna.tsinghua.edu.cn/simple\n</code></pre>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#mkdocsyml","title":"mkdocs.yml","text":"<pre><code>plugins:\n  - search:\n      separator: '[\\s\\u200b\\-]'\n</code></pre>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#_3","title":"\u8f85\u52a9\u200b\u8d44\u6599","text":"<p>https://www.runoob.com/git/git-branch.html</p>"},{"location":"blog/2024/09/19/%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9B%B8%E5%85%B3/#python","title":"python","text":"<p>\u200b\u751f\u6210\u200b requirements.txt \u200b\u6587\u4ef6\u200b</p>"},{"location":"blog/2024/10/16/discrete-time-exploratory-mv-algorithm/","title":"Discrete-Time Exploratory-MV Algorithm","text":"<p>Here is a code in order to replicate experiments made in the article \"Discrete-Time Mean-Variance Strategy Based on Reinforcement Learning\". It was made for group learning.</p> <p>This tutorial was created for group learning.</p>"},{"location":"blog/2024/10/16/discrete-time-exploratory-mv-algorithm/#1-requirement","title":"1. Requirement","text":"<p>python &gt;= 3.9</p> main.py<pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom skewt_scipy.skewt import skewt\n</code></pre>"},{"location":"blog/2024/10/16/discrete-time-exploratory-mv-algorithm/#2-value-function","title":"2. Value function","text":"<p>Value function parametrized by \\(\\theta\\)</p> \\[J^{\\theta}(t, x ; w)=\\theta_{1}^{T-t}\\left(x-\\rho_{t} w\\right)^{2}+\\theta_{2} t^{2}+\\theta_{3} t+\\theta_{4}, \\] main.py<pre><code>def J_theta(theta_1, theta_2, theta_3, theta_4, w, T, x_t, t, rho_t):\n    return (theta_1**(T-t)) * ((x_t - rho_t * w)**2) + \\\n        theta_2 * (t**2) + theta_3 * t + theta_4\n</code></pre>"},{"location":"blog/2024/10/16/discrete-time-exploratory-mv-algorithm/#3-update-parameter","title":"3. Update parameter","text":"<p>First, we need to calculate the gradient of \\(C(\\theta,\\phi)\\).</p> <ul> <li>Gradient of \\(C(\\theta,\\phi)\\) in \\(\\theta\\).  </li> </ul> \\[     \\frac{\\partial C}{\\partial \\theta_{2}}=\\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right]\\left((t+1)^{2}-t^{2}\\right), \\] \\[     \\frac{\\partial C}{\\partial \\theta_{3}}=\\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right], \\] main.py<pre><code>def grad_theta(theta_1, theta_2, theta_3, theta_4, w, T, lamb, phi_1, phi_2,\n               vec_xi, vec_xi1, vec_ti, vec_ti1, rho_ti, rho_ti1):\n\n    grad_theta_2 = ((((J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi1, vec_ti1, rho_ti1) - J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi, vec_ti, rho_ti))) - lamb *(phi_1 + phi_2*(T - vec_ti - 1)))*(vec_ti1**2 - vec_ti**2)).sum()\n    grad_theta_3 = ((((J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi1, vec_ti1, rho_ti1) - J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi, vec_ti, rho_ti))) - lamb *(phi_1 + phi_2*(T - vec_ti - 1)))).sum()\n\n    return grad_theta_2, grad_theta_3\n</code></pre> <ul> <li>Gradient of \\(C(\\theta,\\phi)\\) in \\(\\phi\\).  </li> </ul> \\[     \\frac{\\partial C}{\\partial \\phi_{1}}=-\\lambda \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right], \\] \\[     \\begin{split}         \\frac{\\partial C}{\\partial \\phi_{2}}= &amp;\\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right] \\times \\\\         &amp; \\left[2(T-t) e^{-2 \\phi_{2}(T-t)}\\left(x_{t}-\\rho_{t} w\\right)^{2}\\right. \\\\         &amp; \\left.-2(T-t-1) e^{-2 \\phi_{2}(T-t-1)}\\left(x_{t+1}-\\rho_{t+1} w\\right)^{2}-\\lambda(T-t-1)\\right].     \\end{split} \\] main.py<pre><code>def grad_phi(theta_1, theta_2, theta_3, theta_4, w, T, lamb, phi_1, phi_2,\n               vec_xi, vec_xi1, vec_ti, vec_ti1, rho_ti, rho_ti1):\n\n    grad_phi_1 = -lamb * ((J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi1, vec_ti1, rho_ti1) - J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi, vec_ti, rho_ti)) - lamb *(phi_1 + phi_2*(T - vec_ti - 1))).sum()\n\n    frac1 = 2*((vec_xi -rho_ti*w)**2)*np.exp(-2*phi_2*(T-vec_ti))*(T-vec_ti)\n    frac2 = 2*((vec_xi1-rho_ti1*w)**2)*np.exp(-2*phi_2*(T-vec_ti1))*(T-vec_ti1)\n\n    first_term = ((J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi1, vec_ti1, rho_ti1) - J_theta(theta_1, theta_2, theta_3, theta_4, w, T, vec_xi, vec_ti, rho_ti)) - lamb *(phi_1 + phi_2*(T - vec_ti - 1)))\n    second_term = (frac1-frac2) - lamb*(T-vec_ti-1)\n\n    grad_phi_2 = (first_term * second_term).sum()\n\n    return grad_phi_1, grad_phi_2\n</code></pre> <p>Next, we need to update \\((\\theta_{2},\\theta_{3})\\) and \\((\\phi_{1},\\phi_{2})\\) according to the gradient.</p> <p>The learning scheme for the \\(\\theta\\) is as follows</p> \\[     \\begin{split}         &amp;\\theta \\leftarrow \\theta-\\eta_{\\theta} \\nabla_{\\theta} C(\\theta, \\phi) \\\\         &amp;\\theta_1 \\leftarrow e^{-2\\phi_2} \\\\         &amp;\\theta_4 \\leftarrow -\\theta_{2} T^{2}-\\theta_{3} T-(w-b)^{2}     \\end{split} \\] main.py<pre><code>def update_theta(theta_1, theta_2, theta_3, theta_4, w, T, lamb, phi_1, phi_2, lr_theta, b,\n                vec_xi, vec_xi1, vec_ti, vec_ti1, rho_ti, rho_ti1):\n\n    grad_theta_2, grad_theta_3 = grad_theta(theta_1, theta_2, theta_3, theta_4, w, T, lamb, phi_1, phi_2, vec_xi, vec_xi1, vec_ti, vec_ti1, rho_ti, rho_ti1)\n\n    theta_2 = theta_2 - (lr_theta*grad_theta_2)\n    theta_3 = theta_3 - (lr_theta*grad_theta_3)\n\n    theta_1 = np.exp(-2 * phi_2)\n    theta_4 = -(theta_2 * (T**2)) - theta_3 * T - (w-b)**2\n\n    return theta_1, theta_2, theta_3, theta_4\n</code></pre> <p>The learning scheme for the \\(\\phi\\) is as follows</p> \\[     \\phi \\leftarrow \\phi-\\eta_{\\phi} \\nabla_{\\phi} C(\\theta, \\phi)  \\] main.py<pre><code>def update_phi(theta_1, theta_2, theta_3, theta_4, w, T, lamb, phi_1, phi_2, lr_phi,\n               vec_xi, vec_xi1, vec_ti, vec_ti1, rho_ti, rho_ti1):\n\n    grad_phi_1, grad_phi_2 = grad_phi(theta_1, theta_2, theta_3, theta_4, w, T, lamb, phi_1, phi_2, vec_xi, vec_xi1, vec_ti, vec_ti1, rho_ti, rho_ti1)\n\n    phi_1 = phi_1 - (lr_phi*grad_phi_1)\n    phi_2 = phi_2 - (lr_phi*grad_phi_2)\n\n    phi_2 = np.max([phi_2, 0.0000000001])\n\n    return phi_1, phi_2\n</code></pre>"},{"location":"blog/2024/10/16/discrete-time-exploratory-mv-algorithm/#4-discrete-time-exploratory-mv-algorithm","title":"4. Discrete-Time Exploratory-MV Algorithm","text":"<p>main.py<pre><code>def EMV(annualized_excess_return = 0.30, \n        volatility_annual = 0.20, \n        alpha = 0.05, \n        eta_theta = 0.0005, \n        eta_phi = 0.0005, \n        x0 = 1.0, \n        b = 1.1, \n        T = 3, \n        lambda_param = 2, \n        M = 20000, \n        N = 10,\n        annualized_rf = 0.02,\n        ):\n    '''\n    annualized_excess_return (float):\n        Mean returns of the market\n    volatility_annual (float):\n        Mean std of the market\n    alpha (float):\n        Learning rate of the Lagrangian\n    eta_theta (float):\n        Learning rate of theta\n    eta_phi (float):\n        Learning rate of phi\n    x0 (float):\n        Initial value of the portfolio\n    b (float):\n        Targeted value at time T\n    T (int):\n        Horizon.\n    lambda_param (float):\n        Initial value of lambda (exploring parameter). Here, it is constant.\n    M (int):\n        Number of iterations of algorithm.\n    N (int):\n        Number of observation for updating Lagrangian\n    annualized_rf (float):\n        risk-free\n    '''\n\n    # Simulation study parameter\n\n    # Distribution of market excess returns\n    # skewed t distribution\n    monthly_excess_return = (1 + annualized_excess_return)**(1/12) - 1\n    volatility_monthly = volatility_annual / np.sqrt(12)\n    degrees_of_freedom = 10                 \n    skewness = -1.5                \n\n    a = skewt.mean(skewness, degrees_of_freedom, monthly_excess_return, volatility_monthly)\n\n    rf = (annualized_rf + 1)**(1/12)    # monthly risk-free return\n\n    rho = []\n    for t in range(T+1):\n        rho.append(rf**(-(T-t)))\n\n    # Initialization of parameters\n    w = 3.0     # Lagrangian\n    theta_2 = 1\n    theta_3 = 0\n    theta_4 = -theta_2 * T**2 - theta_3 * T - (w-b)**2\n\n    phi_1 = 1\n    phi_2 = 1\n    theta_1 = np.exp(-2 * phi_2)\n\n    terminal_wealths = []\n    average_wealths = []\n    theta_1_param = []\n    theta_2_param = []\n    theta_3_param = []\n    theta_4_param = []\n    phi_1_param = []\n    phi_2_param = []\n    w_param = []\n\n    print('---------------Start---------------')\n    print(f'b = {b}, a = {annualized_excess_return}, sigma = {volatility_annual} start')\n\n    for k in range(M):\n        # Sampling in skewed t distribution\n        excess_returns = skewt.rvs(skewness, degrees_of_freedom, monthly_excess_return, volatility_monthly, T)\n\n        X_calculated = [x0]\n        t_calculated = [0]\n        rho_calculated = [rho[0]]\n\n        for i in range(T):\n            ti  = i\n            ti1 = i + 1\n            rho_ti = rho[ti]\n            rho_ti1 = rho[ti+1]\n            rt  = excess_returns[i]\n            xt = X_calculated[-1]\n\n            insider = (rf**2 - np.exp(-2*phi_2 )) / (lambda_param * np.pi )\n            mean_pi =  -np.sqrt(insider) * np.exp((2*phi_1 - 1) / 2) * (xt - rho[ti] * w)\n            var_pi = (1/(2 * np.pi)) * np.exp( 2 * phi_2 * (T-ti-1) + 2 * phi_1 - 1 )\n\n            if a &lt; 0 :\n                mean_pi = -mean_pi\n\n            ut = np.random.normal(mean_pi, np.sqrt(var_pi))\n\n\n            xt1 = rf * xt + ut * rt\n\n\n            t_calculated.append(ti1)\n            X_calculated.append(xt1) \n            rho_calculated.append(rho_ti1)\n\n            vec_xi = np.array(X_calculated[:-1])\n            vec_xi1 = np.array(X_calculated[1:])\n            vec_ti = np.array(t_calculated[:-1])\n            vec_ti1 = np.array(t_calculated[1:])\n            vec_rho_ti = np.array(rho_calculated[:-1])\n            vec_rho_ti1 = np.array(rho_calculated[1:])\n\n\n            theta_1, theta_2, theta_3, theta_4 = update_theta(theta_1, theta_2, theta_3, theta_4, w, T, lambda_param, phi_1, phi_2, eta_theta, b,\n                            vec_xi, vec_xi1, vec_ti, vec_ti1, vec_rho_ti, vec_rho_ti1)\n\n            phi_1, phi_2 = update_phi(theta_1, theta_2, theta_3, theta_4, w, T, lambda_param, phi_1, phi_2, eta_phi,\n                            vec_xi, vec_xi1, vec_ti, vec_ti1, vec_rho_ti, vec_rho_ti1)\n\n        terminal_wealths.append(X_calculated[-1])\n\n        # Update w\n        if k % N == 0:\n            w -= alpha * (np.mean(terminal_wealths[-N:]) - b)  # recent N terminal wealth values\n\n        # Calculate average terminal wealth every 50 iterations\n        if (k + 1) % 50 == 0:\n            average_wealth = np.mean(terminal_wealths[-50:]) \n            average_wealths.append(average_wealth)\n\n            theta_1_param.append(theta_1)\n            theta_2_param.append(theta_2)\n            theta_3_param.append(theta_3)\n            theta_4_param.append(theta_4)\n            phi_1_param.append(phi_1)\n            phi_2_param.append(phi_2)\n            w_param.append(w)\n\n    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 10))\n\n    # draw learning curves\n    ax1.plot(range(len(average_wealths)), average_wealths, label='Average Terminal Wealth (Every 50 Iterations)')\n    ax1.axhline(y=b, color='r', linestyle='--', label='Target Wealth')\n    ax1.set_title(f'Learning Curves of Sample Means of Terminal Wealth \\n(b = {b}, annualized_excess_return = {annualized_excess_return:.2f}, volatility_annual = {volatility_annual:.2f})')\n    ax1.set_xlabel('Aggregated epoisodes (50)')\n    ax1.set_ylabel('Average Terminal Wealth')\n    ax1.legend()\n    ax1.grid()\n\n    epochs = range(1, len(theta_1_param) + 1)\n    ax2.plot(epochs, theta_1_param, label='Theta 1')\n    ax2.plot(epochs, theta_2_param, label='Theta 2')\n    ax2.plot(epochs, theta_3_param, label='Theta 3')\n    ax2.plot(epochs, theta_4_param, label='Theta 4')\n    ax2.plot(epochs, phi_1_param, label='Phi 1')\n    ax2.plot(epochs, phi_2_param, label='Phi 2')\n    ax2.plot(epochs, w_param, label='w')\n    ax2.set_title(f'Parameter Learning Curves \\n(b = {b}, annualized_excess_return = {annualized_excess_return:.2f}, volatility_annual = {volatility_annual:.2f})' )\n    ax2.set_xlabel('Epochs')\n    ax2.set_ylabel('Parameter Value')\n    ax2.legend()\n    ax2.grid(True)\n    plt.tight_layout()\n    plt.savefig(f'Learning Curves_{b}_{annualized_excess_return}_{volatility_annual}_example.png', dpi=300, bbox_inches='tight')\n    plt.close()\n\n    print(f'b = {b}, a = {annualized_excess_return}, sigma = {volatility_annual} finish')\n    print('---------------END---------------')\n\nnp.random.seed(42)\nEMV(0.30, 0.20, b = 1.10, M = 25000)\n</code></pre> Now, the discrete-time EMV algorithm is complete. </p>"},{"location":"blog/2024/10/16/discrete-time-exploratory-mv-algorithm/#5-result","title":"5. Result","text":"<p>If your code is able to run, then you will see the result.</p>"},{"location":"blog/2024/10/16/discrete-time-exploratory-mv-algorithm/#apendixa","title":"Apendix.A","text":"<p>The Distribution of Market Monthly Excess Return </p> <p>a risky asset\u2019s monthly excess returns subjecting to skewed t distribution with annualized excess return \\(a = 30\\%\\), volatility \\(\\sigma = 20\\%\\) , degree of freedom being \\(10\\) and skewness parameter being \\(\u22121.5\\).</p> market_dist.py<pre><code>import matplotlib.pyplot as plt\nimport matplotlib.ticker as ticker\n\nimport numpy as np\nfrom skewt_scipy.skewt import skewt\n\n# set random seed\nnp.random.seed(42)\n\n# set market parameter\nannualized_excess_return = 0.30     # annualized_excess_return\nmonthly_excess_return = (1 + annualized_excess_return)**(1/12) - 1\nvolatility_annual = 0.20  # volatility\nvolatility_monthly = volatility_annual / np.sqrt(12)\ndegrees_of_freedom = 10  # degree of freedom\nskewness = -1.5  # skewness\nnum_samples = 15000  # Samples size\n\n# generate sample\nsamples = skewt.rvs(skewness, \n    degrees_of_freedom, monthly_excess_return, volatility_monthly, num_samples)\n# draw histogram\nplt.figure(figsize=(10, 6))\nplt.hist(samples, bins=10, color='blue', alpha=0.7, edgecolor='black')\nplt.title('Skewed T-Distribution (Monthly Excess Return)')\nplt.xlabel('Monthly Excess Return (%)')\nplt.ylabel('Frequency')\nplt.grid(False)\ndef percent_formatter(x, pos):\n    return f'{100*x:.0f}%'\nplt.gca().xaxis.set_major_formatter(ticker.FuncFormatter(percent_formatter))\n# save figure\nplt.savefig(f'The stationary market case_example.png', dpi=300, bbox_inches='tight')    \nplt.show()\n</code></pre>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/","title":"Discrete-Time Mean-Variance Strategy Based on Reinforcement Learning","text":"<p>\u200b\u6839\u636e\u200b\u8d1d\u5c14\u66fc\u200b\u6700\u4f18\u200b\u539f\u5219\u200b\u6c42\u89e3\u200b\u5e26\u200b\u71b5\u200b\u6b63\u5219\u200b\u7684\u200b\u6700\u4f18\u200b\u503c\u200b\u51fd\u6570\u200b\uff0c\u200b\u5e76\u200b\u7ed9\u51fa\u200b\u76f8\u5e94\u200b\u7684\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u5206\u5e03\u200b\u3002\u200b\u540e\u200b\u7ed9\u5b9a\u200b\u6700\u521d\u200b\u5bb9\u8bb8\u200b\u63a7\u5236\u200b\uff0c\u200b\u8bc1\u660e\u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\u540e\u200b\u7684\u200b\u7b56\u7565\u200b\u8fed\u4ee3\u200b\u8fc7\u7a0b\u200b\u80fd\u591f\u200b\u6700\u7ec8\u200b\u6536\u655b\u200b\u5230\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u5206\u5e03\u200b\uff0c\u200b\u5e76\u200b\u53c2\u6570\u200b\u5316\u503c\u200b\u51fd\u6570\u200b\u548c\u200b\u7b56\u7565\u200b\u5206\u5e03\u200b\uff0c\u200b\u8bbe\u8ba1\u200bRL\u200b\u7b97\u6cd5\u200b\uff0c\u200b\u6839\u636e\u200b\u5386\u53f2\u200b\u91d1\u878d\u200b\u6570\u636e\u200b\u8fdb\u884c\u200b\u5b66\u4e60\u200b\u5e76\u200b\u4f30\u8ba1\u200b\u53c2\u6570\u200b\u3002</p> <p>Autor\uff1a Xiangyu Cui, Xun Li, Yun Shi, Si Zhao</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#2","title":"2 \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u7684\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898","text":"<ul> <li>2.1 \u200b\u7ecf\u5178\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898\u200b</li> <li>2.2 \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u7684\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898\u200b</li> </ul>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#21","title":"2.1 \u200b\u7ecf\u5178\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898","text":"<p>\u200b\u9996\u5148\u200b\u8003\u8651\u200b\u7531\u200b\u4e24\u4e2a\u200b\u8d44\u4ea7\u200b\u7ec4\u6210\u200b\u7684\u200b\u5e02\u573a\u200b\uff1a</p> <ul> <li>\u200b\u65e0\u98ce\u9669\u200b\u8d44\u4ea7\u200b\uff0c\u200b\u56de\u62a5\u7387\u200b \\(r_f\\)</li> <li>\u200b\u98ce\u9669\u200b\u8d44\u4ea7\u200b\uff0ct\u200b\u5230\u200bt+1\u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u7387\u200b \\(r_t\\)\uff0c\u200b\u670d\u4ece\u200b\u5747\u503c\u200b\u4e3a\u200b \\(a\\)\uff0c\u200b\u65b9\u5dee\u200b\u4e3a\u200b \\(\\sigma^2\\) \u200b\u7684\u200b\u6b63\u6001\u5206\u5e03\u200b\u3002</li> </ul> <p>\u200b\u5047\u8bbe\u200b\uff1a \\(r_t,t=0,1,\\dots,T-1\\)  \u200b\u662f\u200b\u7edf\u8ba1\u200b\u4e0a\u200b\u72ec\u7acb\u200b\u7684\u200b</p> <ul> <li>\u200b\u6295\u8d44\u8005\u200b\u8fdb\u5165\u200b\u5e02\u573a\u200b\u7684\u200b\u521d\u59cb\u200b\u8d22\u5bcc\u200b\u4e3a\u200b \\(x_0\\)</li> <li>\u200b\u6295\u8d44\u8005\u200b\u5e0c\u671b\u200b\u5728\u200b\u7b56\u7565\u200b \\(\\mathbf{u} = \\{u_0, u_1,\\dots,u_{T-1} \\}\\) \u200b\u4e0b\u200b\u7684\u200b\u6700\u7ec8\u200b\u8d22\u5bcc\u200b\u671f\u671b\u503c\u200b\u4e3a\u200b \\(x_T = b\\)</li> </ul> <p>\u200b\u7b80\u5355\u200b\u8bf4\u200b\uff0c\u200b\u6295\u8d44\u8005\u200b\u5c06\u4f1a\u200b\u9762\u4e34\u200b\u4ee5\u4e0b\u200b\u7684\u200b\u4f18\u5316\u200b\u95ee\u9898\u200b\uff1a</p> \\[\\begin{align*}         \\min\\ &amp;\\operatorname{Var}(x_T^u), \\\\[2mm]         \\text{s.t. }&amp;\\mathbb{E}[x_T^u] = b,\\\\[2mm]         &amp;x_{t+1}= r_f x_t + r_t u_t,\\quad\\quad t = 0,1,\\dots,T-1 \\end{align*}\\] <p>\u200b\u5f15\u5165\u200b Lagrange multiplier \\(w\\)\uff0c\u200b\u5c06\u200b\u95ee\u9898\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u65e0\u200b\u7ea6\u675f\u6761\u4ef6\u200b\u95ee\u9898\u200b\u3002</p> \\[\\begin{equation}     \\min_u\\ \\mathbb{E}(x_T^u)^2-b^2-2w(\\mathbb{E}[x_T^u]-b) = \\min_u\\ \\mathbb{E}(x_T^u - w)^2 - (w-b)^2. \\end{equation}\\] <p>\u200b\u8be5\u200b\u95ee\u9898\u200b\u5b58\u5728\u200b\u89e3\u6790\u200b\u89e3\u200b \\(\\mathbf{u}^*=\\{u_0^*,u_1^*,\\dots,u_{T-1}^*\\}\\) \u200b\u4f9d\u8d56\u4e8e\u200b \\(w\\). \u200b\u8be6\u7ec6\u200b\u7684\u200b\u63a8\u5bfc\u200b\u53ef\u89c1\u200b (2000)Optimal dynamic portfolio selection: Multiperiod mean-variance formulation</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#22","title":"2.2 \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u7684\u200b\u5747\u503c\u200b\u65b9\u5dee\u200b\u95ee\u9898","text":"<p>\u200b\u5728\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u6846\u67b6\u200b\u4e2d\u200b\uff0c\u200b\u63a7\u5236\u200b\u8fc7\u7a0b\u200b \\(\\mathbf{u} = \\{u_t,0\\le t &lt;T\\}\\) \u200b\u662f\u200b\u968f\u673a\u5316\u200b\u7684\u200b\uff0c\u200b\u4ee3\u8868\u200b\u63a2\u7d22\u200b\u548c\u200b\u5b66\u4e60\u200b\uff0c\u200b\u4ece\u800c\u200b\u5f62\u6210\u200b\u4e86\u200b\u4ee5\u200b\u6d4b\u5ea6\u200b\u503c\u200b\u6216\u200b\u5206\u5e03\u200b\u63a7\u5236\u200b\u7684\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u5176\u200b\u5bc6\u5ea6\u200b\u51fd\u6570\u200b\u8868\u793a\u200b\u4e3a\u200b \\(\\boldsymbol{\\pi} = \\{\\pi_t,0\\le t &lt; T\\}\\). \u200b\u56e0\u6b64\u200b\uff0c\u200b\u8d22\u5bcc\u200b\u7684\u200b\u52a8\u6001\u200b\u8868\u793a\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     x_{t+1}^\\pi = r_f x_t^\\pi + r_t u_t^\\pi. \\end{equation}\\] <p>\u200b\u5047\u5b9a\u200b\uff1a</p> <ul> <li>\u200b\u8d85\u989d\u200b\u6536\u76ca\u200b \\(r_t\\) \u200b\u670d\u4ece\u200b\u4e00\u4e2a\u200b\u5747\u503c\u200b\u4e3a\u200b \\(a\\) \u200b\u548c\u200b\u65b9\u5dee\u200b \\(\\sigma^2\\) \u200b\u7684\u200b\u5206\u5e03\u200b\u3002</li> <li>\\(u_t^\\pi\\) \u200b\u662f\u200b\u4e00\u4e2a\u200b\u968f\u673a\u200b\u63a7\u5236\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u6982\u7387\u5bc6\u5ea6\u200b\u4e3a\u200b \\(\\pi_t\\)\u3002</li> <li>\\(r_t\\) \u200b\u4e0e\u200b \\(u_t^\\pi\\) \u200b\u662f\u200b\u72ec\u7acb\u200b\u7684\u200b\u3002</li> </ul> <p>\u200b\u90a3\u4e48\u200b\u5728\u200b\u5468\u671f\u200b \\(t\\) \u200b\u5904\u200b\uff0c\\(r_t u_t^\\pi\\) \u200b\u7684\u200b\u6761\u4ef6\u200b\u4e00\u9636\u77e9\u200b\u548c\u200b\u4e8c\u9636\u200b\u77e9\u200b\u53ef\u4ee5\u200b\u8868\u793a\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{align*}     &amp;\\mathbb{E}_t[r_tu_t^\\pi] = \\mathbb{E}_t[r_t]\\mathbb{E}_t[u_t^\\pi] = a\\int_{\\mathbb{R}}u\\pi_t(u)du,\\\\     &amp;\\mathbb{E}_t[(r_tu_t^\\pi)^2]=\\mathbb{E}_t[(r_t)^2]\\mathbb{E}_t[(u_t^\\pi)^2]=(a^2+\\sigma^2)\\int_{\\mathbb{R}}u^2\\pi_t(u)du. \\end{align*}\\] <p>\u200b\u968f\u673a\u200b\u5206\u5e03\u200b\u63a7\u5236\u200b\u8fc7\u7a0b\u200b \\(\\boldsymbol{\\pi} =\\{\\pi_t,0 \\le t &lt; T\\}\\) \u200b\u7528\u200b\u603b\u4f53\u200b\u7684\u200b\u7d2f\u79ef\u200b\u71b5\u200b\u53bb\u200b\u523b\u753b\u200b\u7684\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u7684\u200b\u63a2\u7d22\u200b\u8fc7\u7a0b\u200b\u3002</p> \\[\\begin{equation*}     \\mathcal{H}(\\boldsymbol{\\pi}) := -\\sum_{t=0}^{T-1}\\int_{\\mathbb{R}}\\pi_t(u)\\ln\\pi_t(u)du. \\end{equation*}\\] <p>\u200b\u5728\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u5e02\u573a\u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u63a2\u7d22\u6027\u200bMV\u200b\u95ee\u9898\u200b\u7684\u200b\u76ee\u6807\u200b\u51fd\u6570\u200b\u53d8\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     V^\\pi = \\min_\\pi \\mathbb{E}\\left[(x_T^\\pi - w)^2 + \\lambda \\sum_{t=0}^{T-1}\\int_{\\mathbb{R}}\\pi_t(u)\\ln\\pi_t(u)du\\right] - (w-b)^2. \\end{equation}\\] \u200b\u539f\u5148\u200b\u7684\u200b\u76ee\u6807\u200b\u51fd\u6570\u200b \\[\\begin{equation*}     \\min_u\\ \\mathbb{E}(x_T^u - w)^2 - (w-b)^2. \\end{equation*}\\] <ul> <li>\\(\\lambda :\\) temperature parameter measures the trade-off between exploitation and exploration in this MV problem.</li> </ul> <p>\u200b\u95ee\u9898\u200b(3)\u200b\u4e2d\u200b\u7406\u8bba\u200b\u7684\u200b\u6700\u4f18\u200b\u53cd\u9988\u200b\u63a7\u5236\u200b\u548c\u200b\u76f8\u5e94\u200b\u7684\u200b\u6700\u4f18\u200b\u503c\u200b\u51fd\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b\u5b9a\u4e49\u200b\u5728\u200b\u7b56\u7565\u200b \\(\\boldsymbol{\\pi}\\) \u200b\u4e0b\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b \\(J(t,x;w)\\):</p> \\[\\begin{equation*}     J(t,x;w) = \\mathbb{E}\\left[(x_T^\\pi - w)^2 + \\lambda \\sum_{s=t}^{T-1}\\int_{\\mathbb{R}}\\pi_s(u)\\ln\\pi_s(u)du \\mid x_t^\\pi = x \\right] - (w-b)^2 \\end{equation*}\\] <p>\\(J^*(t,x;w)\\) \u200b\u79f0\u4e3a\u200b\u95ee\u9898\u200b(3)\u200b\u7684\u200b\u6700\u4f18\u200b\u503c\u200b\u51fd\u6570\u200b\uff1a</p> \\[\\begin{align*}     &amp;J^*(t,x;w) = \\min_{\\pi_{t}, \\ldots, \\pi_{T-1}}\\mathbb{E}\\left[(x_T^\\pi - w)^2 + \\lambda \\sum_{s=t}^{T-1}\\int_{\\mathbb{R}}\\pi_s(u)\\ln\\pi_s(u)du \\mid x_t^\\pi = x \\right] - (w-b)^2,\\\\     &amp;J^*(T,x;w) = (x-w)^2 - (w-b)^2. \\end{align*}\\] <p>Theorem 1. At period t, the optimal value function is given by</p> \\[\\begin{equation}     \\begin{split}         &amp;J^*(t,x;w) \\\\         =&amp;\\left(\\frac{\\sigma^2 r_f^2}{a^2+\\sigma^2}\\right)^{T-t}(x-\\rho_t w)^2 + \\frac{\\lambda}{2}(T-t)\\ln\\left(\\frac{a^2 + \\sigma^2}{\\pi \\lambda}\\right) \\\\         &amp;+ \\frac{\\lambda}{2}\\sum_{i=t+1}^{T}(T-i)\\ln\\left(\\frac{\\sigma^2 r_f^2}{a^2 + \\sigma^2}\\right) - (w-b)^2.     \\end{split} \\end{equation}\\] <p>where \\(\\rho_t = (r_f^{-1})^{T-t}\\). Moreover, the optimal feedback control is Gaussian, with its density function given by</p> \\[\\begin{equation}     \\pi^*(u;t,x,w) = \\mathcal{N}\\left(u \\,\\Bigg| \\, - \\frac{ar_f(x-\\rho_t w)}{a^2 + \\sigma^2}, \\frac{\\lambda}{2(a^2 + \\sigma^2)}\\left( \\frac{a^2 + \\sigma^2}{\\sigma^2 r_f^2} \\right)^{T-t-1}\\right) . \\end{equation}\\] <p>[NOTE:\u200b\u8d85\u989d\u200b\u6536\u76ca\u200b \\(r_t\\) \u200b\u670d\u4ece\u200b\u4e00\u4e2a\u200b\u5747\u503c\u200b\u4e3a\u200b \\(a\\) \u200b\u548c\u200b\u65b9\u5dee\u200b \\(\\sigma^2\\) \u200b\u7684\u200b\u5206\u5e03\u200b\u3002]</p> \u200b\u5b9a\u7406\u200b1\u200b\u6709\u200b\u4e24\u70b9\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b <ol> <li>\u200b\u65b9\u5dee\u200b\u9879\u200b\u8861\u91cf\u200b\u6700\u4f18\u200b\u7684\u200b\u9ad8\u65af\u200b\u7b56\u7565\u200b\u5728\u200b \\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u7684\u200b\u63a2\u7d22\u200b\u7a0b\u5ea6\u200b\uff0c\u200b\u610f\u5473\u7740\u200b\u63a2\u7d22\u200b\u4f1a\u200b\u968f\u7740\u200b\u65f6\u95f4\u200b\u8870\u51cf\u200b\u3002agent \u200b\u521d\u59cb\u200b\u4f1a\u200b\u6700\u5927\u200b\u7a0b\u5ea6\u200b\u7684\u200b\u8fdb\u884c\u200b\u63a2\u7d22\u200b\uff0c\u200b\u7136\u540e\u200b\u63a2\u7d22\u200b\u7a0b\u5ea6\u200b\u4f1a\u200b\u968f\u200b\u65f6\u95f4\u200b\u9010\u6e10\u200b\u8870\u51cf\u200b\u3002 \u200b\u968f\u7740\u200b\u65f6\u95f4\u200b\u63a5\u8fd1\u200b\u5230\u671f\u65e5\u200b\uff0c\u200b\u5229\u7528\u200b\u4f1a\u200b\u4e3b\u5bfc\u200b\u63a2\u7d22\u200b\u5e76\u4e14\u200b\u4f1a\u200b\u53d8\u5f97\u200b\u8d8a\u6765\u8d8a\u200b\u91cd\u8981\u200b\uff0c\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b\u6709\u200b\u4e00\u4e2a\u200b\u5c06\u200b\u5bf9\u200b\u6295\u8d44\u8005\u200b\u7684\u200b\u884c\u52a8\u200b\u8fdb\u884c\u200b\u8bc4\u4f30\u200b\u7684\u200b deadline T\u3002</li> <li>\u200b\u6700\u4f18\u200b\u9ad8\u65af\u200b\u7b56\u7565\u200b\u7684\u200b\u5747\u503c\u200b\u4e0e\u200b\u63a2\u7d22\u200b\u6743\u91cd\u200b \\(\\lambda\\) \u200b\u65e0\u5173\u200b\uff0c\u200b\u65b9\u5dee\u200b\u4e0e\u200b\u72b6\u6001\u200b \\(x\\) \u200b\u65e0\u5173\u200b\u3002\u200b\u5b8c\u7f8e\u200b\u7684\u200b\u5c06\u200b\u5229\u7528\u200b\u548c\u200b\u63a2\u7d22\u200b\u8fdb\u884c\u200b\u4e86\u200b\u5206\u79bb\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u524d\u8005\u200b\u7531\u200b\u5747\u503c\u200b\u6355\u6349\u200b\uff0c\u200b\u540e\u8005\u200b\u7531\u200b\u65b9\u5dee\u200b\u6355\u6349\u200b\u3002</li> </ol>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#3","title":"3. \u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u7b97\u6cd5","text":"<p>\u200b\u4e0a\u8ff0\u200b\u5185\u5bb9\u200b\u8bc1\u660e\u200b\u5e76\u200b\u7ed9\u51fa\u200b\u4e86\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u5747\u503c\u200b-\u200b\u65b9\u5dee\u200b\u95ee\u9898\u200b\u7684\u200b\u6700\u4f18\u200b\u89e3\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u8bbe\u8ba1\u200b\u5bf9\u5e94\u200b\u7684\u200bRL\u200b\u7b97\u6cd5\u200b\u6765\u200b \u200b\u76f4\u63a5\u200b\u5b66\u4e60\u200b\u6c42\u89e3\u200b\u548c\u200b\u8f93\u51fa\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u5206\u914d\u200b\u7b56\u7565\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u8981\u200b\u505a\u200b\u7684\u200b\u5185\u5bb9\u200b\u6709\u200b\u4e24\u200b\u90e8\u5206\u200b\uff1a</p> <ul> <li>1.\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u548c\u200b\u7b56\u7565\u200b\u6536\u655b\u200b</li> <li>2.\u200b\u4e00\u4e2a\u200b\u81ea\u200b\u6821\u6b63\u200b\u65b9\u6848\u200b\u6765\u200b\u5b66\u4e60\u200b\u771f\u6b63\u200b\u7684\u200b\u62c9\u683c\u6717\u200b\u65e5\u200b\u4e58\u5b50\u200b \\(w\\) </li> </ul> \u200b\u6ce8\u610f\u200b <p>\u200b\u8be5\u200bRL\u200b\u7b97\u6cd5\u200b\u8df3\u8fc7\u200b\u4e86\u200b\u6a21\u578b\u200b\u53c2\u6570\u200b\u7684\u200b\u4f30\u8ba1\u200b\uff0c\u200b\u5982\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b \\(r_t\\) \u200b\u7684\u200b\u5747\u503c\u200b\u548c\u200b\u65b9\u5dee\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u53c2\u6570\u200b\u96be\u4ee5\u200b\u51c6\u786e\u200b\u4f30\u8ba1\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#31","title":"3.1 \u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u548c\u200b\u7b56\u7565\u200b\u6536\u655b","text":"\u4e3a\u4ec0\u4e48\u200b\u9700\u8981\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u548c\u200b\u7b56\u7565\u200b\u6536\u655b\u200b <p>\u200b\u7b56\u7565\u200b\u65b9\u6848\u200b\u53ef\u4ee5\u200b\u5411\u200b\u6b63\u786e\u200b\u7684\u200b\u65b9\u5411\u200b\u66f4\u65b0\u200b\u5f53\u524d\u200b\u7b56\u7565\u200b\uff0c\u200b\u4ee5\u200b\u6539\u8fdb\u200b value function \u3002 \u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u5b9a\u7406\u200b\u4f1a\u200b\u4fdd\u8bc1\u200b\u8fed\u4ee3\u200b\u540e\u200b\u7684\u200b value function \u200b\u662f\u975e\u200b\u589e\u7684\u200b\uff08\u200b\u5728\u200b\u6700\u5c0f\u5316\u200b\u7684\u200b\u95ee\u9898\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff09\u3002 \u200b\u7b56\u7565\u200b\u6536\u655b\u200b\u4fdd\u8bc1\u200b\u4f1a\u200b\u6700\u7ec8\u200b\u6536\u655b\u200b\u5230\u200b optimal value function \u3002</p> <p>\u200b\u4ee5\u4e0b\u200b\u7ed9\u51fa\u200b\u7684\u200b\u5b9a\u7406\u200b\u8bf4\u660e\u200b\u4e86\u200b\uff0c\u200b\u5728\u200b\u56fa\u5b9a\u200b \\(w\\) \u200b\u548c\u200b\u7ed9\u5b9a\u200b\u670d\u4ece\u200b\u4ee5\u4e0b\u200b\u5206\u5e03\u200b\u7684\u200b\u6700\u521d\u200b\u7684\u200b\u5bb9\u8bb8\u200b\u63a7\u5236\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u6700\u7ec8\u200b\u7b56\u7565\u200b\u4f1a\u200b\u6536\u655b\u200b\u5230\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b</p> <p>Theorem 2. Suppose \\(w\\in \\mathbb{R}\\) is fixed and \\(\\boldsymbol{\\pi}^0\\) is an arbitrarily given admissible feedback control policy, subjecting to</p> \\[  \\pi_t^0(u;x,w) = \\mathcal{N}\\left( u \\mid K(x-\\rho_t w), \\lambda BC^{T-t-1} \\right) \\] <p>Then we can calculate \\(J^{\\pi^0}(t,x;w)\\)</p> \\[\\begin{align*}     \\text{where} &amp;\\\\     &amp; \\rho_t  = r_f^{-(T-t)} \\\\     &amp; A = r_f^2 + (a^2 + \\sigma^2)K^2 + 2r_f a K \\\\     &amp; f(t) = \\frac{\\lambda B (a^2 + \\sigma^2)[1-(CA)^{T-t}]}{1-CA} - \\frac{\\lambda}{2}\\ln (2\\pi \\lambda B)(T-t) - \\frac{\\lambda}{2}(T-t)-\\frac{\\lambda}{2}\\ln C\\sum_{i=0}^{T-t-1}i-(w-b)^2  \\end{align*}\\] <p>\\(f(t)\\) is a smooth function that only depends on \\(t\\)</p> \\[\\begin{equation*}     \\begin{split}         &amp;J^{\\pi^0}(t,x;w) \\\\         = &amp; A^{T-t}(x-\\rho_t w)^2 + \\frac{\\lambda B (a^2 + \\sigma^2)[1-(CA)^{T-t}]}{1-CA} - \\frac{\\lambda}{2}\\ln (2\\pi \\lambda B)(T-t)\\\\         &amp; - \\frac{\\lambda}{2}(T-t)-\\frac{\\lambda}{2}\\ln C\\sum_{i=0}^{T-t-1}i-(w-b)^2 \\\\         = &amp; A^{T-t}(x-\\rho_t w)^2 + f(t)     \\end{split} \\end{equation*}\\] <p>Using the condition  \\(\\pi_{t}^{k+1}(u ; x, w)=\\arg \\min _{\\pi_{t}^{k}(u)} J^{\\pi^{k}}(t, x ; w)\\) to update the feedback policy and making this iteration for k times, we can get  \\(\\pi_{t}^{k}(u ; x, w)\\)  and the corresponding value function \\(J^{\\pi^{k}}(t, x ; w):\\)</p> \\[\\begin{equation}     \\pi_{t}^{k}(u ; x, w)=\\mathcal{N}\\left(u \\left\\lvert\\,-\\frac{a r_{f}\\left(x-\\rho_{t} w\\right)}{a^{2}+\\sigma^{2}}\\right., \\frac{\\lambda}{2\\left(a^{2}+\\sigma^{2}\\right) A^{T-t-k}}\\left(\\frac{a^{2}+\\sigma^{2}}{\\sigma^{2} r_{f}^{2}}\\right)^{k-1} \\right), \\end{equation}\\] \\[\\begin{equation}     \\begin{split}         &amp; J^{\\pi^k}(t,x;w) \\\\         = &amp; A^{T-t-k}\\left(\\frac{\\sigma^{2} r_{f}^{2}}{a^{2}+\\sigma^{2}}\\right)^{k}\\left(x-\\rho_{t} w\\right)^{2}+\\frac{\\lambda}{2} k \\ln \\left(\\frac{a^{2}+\\sigma^{2}}{\\pi \\lambda}\\right) \\\\         &amp; + \\frac{\\lambda}{2} \\sum_{i=0}^{k-1} i \\ln \\left(\\frac{\\sigma^{2} r_{f}^{2}}{a^{2}+\\sigma^{2}}\\right) + \\frac{\\lambda \\ln A}{2} k(T-t-k)+f(t+k).     \\end{split} \\end{equation}\\] Note <p>\u200b\u4e0a\u8ff0\u200b\u5b9a\u7406\u200b\u63cf\u8ff0\u200b\u4e86\u200b\u4ee5\u4e0b\u200b\u8fed\u4ee3\u200b\u8fc7\u7a0b\u200b\u662f\u200b\u5408\u7406\u200b\u7684\u200b\u3002\u200b\u5373\u200b\uff1a</p> <p> \u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\uff1a\u200b\u7ed9\u5b9a\u200b\u5f53\u524d\u200b\u7b56\u7565\u200b \\(\\pi^k\\) \u200b\u8ba1\u7b97\u200b\u5176\u200b\u5bf9\u5e94\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b \\(J^{\\pi^k}\\)</p> <p> \u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\uff1a\u200b\u9009\u62e9\u200b\u8ba9\u200b \\(J^{\\pi^k}\\) \u200b\u6700\u5c0f\u5316\u200b\u7684\u200b\u7b56\u7565\u200b\u5206\u5e03\u200b\uff1a</p> \\[\\pi_{t}^{k+1}(u ; x, w)=\\arg \\min _{\\pi_{t}^{k}(u)} J^{\\pi^{k}}(t, x ; w) \\] <p>\u200b\u8be5\u200b\u5b9a\u7406\u200b\u8bc1\u660e\u200b\u4e86\u200b\uff0c\u200b\u8be5\u200b\u8fed\u4ee3\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u80fd\u591f\u200b\u4f7f\u200b\u66f4\u65b0\u200b\u540e\u200b\u7684\u200b\u7b56\u7565\u200b\u80fd\u591f\u200b\u6536\u655b\u200b\u5230\u200b\u7406\u8bba\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#32","title":"3.2 \u200b\u7b97\u6cd5\u200b\u8bbe\u8ba1","text":"<p>\u200b\u8bbe\u8ba1\u200bRL\u200b\u7b97\u6cd5\u200b\u53bb\u200b\u6c42\u89e3\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u63a2\u7d22\u6027\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u9009\u62e9\u200b\u95ee\u9898\u200b\u3002\u200b\u7b97\u6cd5\u200b\u5305\u542b\u200b\u4e09\u4e2a\u200b\u6b65\u9aa4\u200b\uff1a\u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\uff0c\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u548c\u200b\u5b66\u4e60\u200b Lagrange multiplier \\(w\\) \u200b\u7684\u200b\u81ea\u200b\u6821\u6b63\u200b\u65b9\u6848\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#policy-evaluation","title":"Policy Evaluation","text":"<p>\u200b\u901a\u8fc7\u200b Bellman equation \u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b</p> \\[ J^{\\pi}(t, x ; w)=\\mathbb{E}\\left[J^{\\pi}\\left(t+1, x_{t+1} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}(u) \\ln \\pi_{t}(u) d u \\Bigg| x_{t}=x\\right] \\] <p>\u200b\u5c06\u200b\u65b9\u7a0b\u200b\u8fdb\u884c\u200b\u91cd\u6392\u200b\uff0c\u200b\u5f97\u5230\u200b</p> \\[\\mathbb{E}\\left[J^{\\pi}\\left(t+1, x_{t+1} ; w\\right)-J^{\\pi}\\left(t, x_{t} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}(u) \\ln \\pi_{t}(u) d u \\Bigg| x_{t}=x\\right]=0 \\] <p>\u200b\u5b9a\u4e49\u200b Bellman's error</p> \\[\\delta_{t}=\\hat{J}_{t}^{\\pi}+\\lambda \\int_{\\mathbb{R}} \\pi_{t}(u) \\ln \\pi_{t}(u) d u \\] <p>\u200b\u5176\u4e2d\u200b \\(\\hat{J}_{t}^{\\pi}=J^{\\pi}\\left(t+1, x_{t+1} ; w\\right)-J^{\\pi}\\left(t, x_{t} ; w\\right)\\).</p> <p>\u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\u7684\u200b\u76ee\u6807\u200b\u662f\u200b\u8981\u200b\u6700\u5c0f\u5316\u200b\u8d1d\u5c14\u66fc\u200b\u8bef\u5dee\u200b \\(\\delta_t\\). </p> <ul> <li>\\(J^\\theta\\) \u200b\u53c2\u6570\u200b\u5316\u200b\u7684\u200b value function\uff0c\\(\\theta\\) \u200b\u9700\u8981\u200b\u5b66\u4e60\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u5411\u91cf\u200b</li> <li>\\(\\pi^\\phi\\) \u200b\u53c2\u6570\u200b\u5316\u200b\u7684\u200b policy\uff0c\\(\\phi\\) \u200b\u9700\u8981\u200b\u5b66\u4e60\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u5411\u91cf\u200b</li> </ul> <p>\u200b\u7136\u540e\u200b\u6700\u5c0f\u5316\u200b </p> \\[\\begin{align*}     C(\\theta, \\phi) &amp; =\\frac{1}{2} \\mathbb{E}\\left[\\sum_{i=0}^{T-1}\\left|\\delta_{i}\\right|^{2}\\right] \\\\     &amp; =\\frac{1}{2} \\mathbb{E}\\left[\\sum_{i=0}^{T-1}\\left|J^{\\theta}\\left(i+1, x_{i+1} ; w\\right)-J^{\\theta}\\left(i, x_{i} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{i}^{\\phi}(u) \\ln \\pi_{i}^{\\phi}(u) d u\\right|^{2}\\right] \\\\     &amp; =\\frac{1}{2} \\mathbb{E}\\left[\\sum_{i=0}^{T-1}\\left|\\hat{J}_{i}^{\\theta}+\\lambda \\int_{\\mathbb{R}} \\pi_{i}^{\\phi}(u) \\ln \\pi_{i}^{\\phi}(u) d u\\right|^{2}\\right] \\end{align*}\\] <p>\u200b\u5176\u4e2d\u200b \\(\\pi^{\\phi}=\\left\\{\\pi_{t}^{\\phi}, t=0,1, \\ldots, T-1\\right\\}\\). </p> <p>\u200b\u7528\u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u6536\u96c6\u200b\u6837\u672c\u200b \\(D=\\{(t,x_t),t=0,1,\\dots,T \\}\\)</p> <p>\\(t=0\\)\uff0c\u200b\u521d\u59cb\u200b\u6837\u672c\u200b \\((0,x_0)\\)</p> <p>\\(t=0,1,\\dots,T-1\\)\uff0c\u200b\u91c7\u6837\u200b \\(\\pi_t^\\phi\\) \u200b\u83b7\u5f97\u200b\u5728\u200b\u98ce\u9669\u200b\u8d44\u4ea7\u200b\u7684\u200b\u5206\u914d\u200b \\(u_t\\)\uff0c \u200b\u5e76\u4e14\u200b\u89c2\u5bdf\u200b \\(t+1\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u8d22\u5bcc\u200b\u503c\u200b \\(x_{t+1}\\)</p> <p>\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u53bb\u200b\u8fd1\u4f3c\u200b \\(C(\\theta,\\phi)\\)</p> \\[\\begin{align*}     C(\\theta, \\phi) &amp; =\\frac{1}{2} \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[J^{\\theta}\\left(t+1, x_{t+1} ; w\\right)-J^{\\theta}\\left(t, x_{t} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}^{\\phi}(u) \\ln \\pi_{t}^{\\phi}(u) d u\\right]^{2} \\\\     &amp; =\\frac{1}{2} \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)+\\lambda \\int_{\\mathbb{R}} \\pi_{t}^{\\phi}(u) \\ln \\pi_{t}^{\\phi}(u) d u\\right]^{2} \\end{align*}\\] <p>\u200b\u6839\u636e\u200b\u5148\u524d\u200b\u6c42\u51fa\u200b\u7684\u200b\u6700\u4f18\u200b\u503c\u200b\u51fd\u6570\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u8003\u8651\u200b\u5c06\u503c\u200b\u51fd\u6570\u53c2\u6570\u200b\u5316\u4e3a\u200b\uff1a</p> \\[J^{\\theta}(t, x ; w)=\\theta_{1}^{T-t}\\left(x-\\rho_{t} w\\right)^{2}+\\theta_{2} t^{2}+\\theta_{3} t+\\theta_{4}, \\] Recall \\[\\begin{align*}         &amp;J^*(t,x;w) \\\\         =&amp;\\left(\\frac{\\sigma^2 r_f^2}{a^2+\\sigma^2}\\right)^{T-t}(x-\\rho_t w)^2 + \\frac{\\lambda}{2}(T-t)\\ln\\left(\\frac{a^2 + \\sigma^2}{\\pi \\lambda}\\right) \\\\         &amp;+ \\frac{\\lambda}{2}\\sum_{i=t+1}^{T}(T-i)\\ln\\left(\\frac{\\sigma^2 r_f^2}{a^2 + \\sigma^2}\\right) - (w-b)^2. \\end{align*}\\] <p>\u200b\u5176\u4e2d\u200b \\(\\rho_t = r_f^{-(T-t)}\\) \u200b\u548c\u200b \\(r_f\\) \u200b\u90fd\u200b\u662f\u200b\u5df2\u77e5\u200b\u7684\u200b\u3002</p>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#policy-improvement","title":"Policy Improvement","text":"<p>\u200b\u4ece\u200b\u7b56\u7565\u200b\u63d0\u5347\u200b\u66f4\u65b0\u200b\u65b9\u6848\u200b\u4e2d\u200b\uff0c\u200b\u7b56\u7565\u200b \\(\\pi_t^{\\phi}(u)\\) \u200b\u7684\u200b\u5747\u503c\u200b\u548c\u200b\u65b9\u5dee\u200b\u5206\u522b\u200b\u662f\u200b\uff0c\\(-\\frac{a r_{f}\\left(x-\\rho_{t} w\\right)}{a^{2}+\\sigma^{2}}\\) \u200b\u548c\u200b \\(\\frac{\\lambda}{2\\left(a^{2}+\\sigma^{2}\\right) \\theta_{1}^{T-t-1}}\\) \u200b\u7531\u6b64\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b\u71b5\u200b</p> \\[\\begin{align*}     H\\left(\\pi_{t}^{\\phi}\\right) &amp; =-\\int_{\\mathbb{R}} \\pi_{t}^{\\phi}(u) \\ln \\pi_{t}^{\\phi}(u) d u \\\\     &amp; =\\frac{1}{2} \\ln \\left(\\frac{\\pi e \\lambda}{a^{2}+\\sigma^{2}}\\right)-\\frac{\\ln \\theta_{1}}{2}(T-t-1) \\end{align*}\\] <p>\u200b\u5c06\u200b\u5176\u200b\u8fdb\u884c\u200b\u53c2\u6570\u200b\u5316\u200b\uff0c\u200b\u8868\u793a\u200b\u4e3a\u200b \\(H\\left(\\pi_{t}^{\\phi}\\right)=\\phi_{1}+\\phi_{2}(T-t-1)\\) \uff0c\u200b\u53ef\u4ee5\u200b\u5bfc\u51fa\u200b\uff1a</p> \\[ \\left\\{\\begin{array}{l}     \\phi_{1}=\\frac{1}{2} \\ln \\left(\\frac{\\pi e \\lambda}{a^{2}+\\sigma^{2}}\\right) \\\\     \\phi_{2}=-\\frac{\\ln \\theta_{1}}{2} \\\\     \\theta_{1}=\\frac{\\sigma^{2} r_{f}^{2}}{a^{2}+\\sigma^{2}}     \\end{array}\\right. \\] <p>\u200b\u7528\u200b \\(\\phi_1\\) \u200b\u548c\u200b \\(\\phi_2\\) \u200b\u91cd\u65b0\u200b\u8868\u793a\u200b\u7b56\u7565\u200b</p> \\[\\begin{align*}     &amp; \\pi_{t}^{\\phi}(u ; x, w) \\\\     = &amp; \\mathcal{N}\\left(u \\left\\lvert\\,-\\frac{a r_{f}\\left(x-\\rho_{t} w\\right)}{a^{2}+\\sigma^{2}}\\right., \\frac{\\lambda}{2\\left(a^{2}+\\sigma^{2}\\right) \\theta_{1}^{T-t-1}}\\right) \\\\     = &amp; \\mathcal{N}\\left(u \\left\\lvert\\,-\\sqrt{\\frac{r_{f}^{2}-e^{-2 \\phi_{2}}}{\\lambda \\pi}} e^{\\frac{2 \\phi_{1}-1}{2}}\\left(x-\\rho_{t} w\\right)\\right., \\frac{1}{2 \\pi} e^{2 \\phi_{2}(T-t-1)+2 \\phi_{1}-1}\\right) \\end{align*}\\] <p>\u200b\u5229\u7528\u200b\u4e0a\u8ff0\u200b\u5f97\u5230\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u5f62\u5f0f\u200b\u7684\u200b \\(H\\left(\\pi_{t}^{\\phi}\\right)=\\phi_{1}+\\phi_{2}(T-t-1)\\)\uff0c\u200b\u91cd\u5199\u200b \\(C(\\theta,\\phi)\\) \u200b\u5f97\u5230\u200b</p> \\[C(\\theta, \\phi)=\\frac{1}{2} \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right]^{2} \\] <p>\u200b\u8be5\u200b\u8bba\u6587\u200b\u91c7\u7528\u200b\u968f\u673a\u200b\u68af\u5ea6\u200b\u4e0b\u964d\u200b\uff08SGD\uff09\u200b\u7684\u200b\u65b9\u5f0f\u200b\u53bb\u200b\u66f4\u65b0\u200b\u53c2\u6570\u200b \\((\\phi_1,\\phi_2)'\\) \u200b\u548c\u200b \\((\\theta_2,\\theta_3)'\\)</p> \\[\\begin{align*}     \\textbf{Note that:} &amp; \\\\     &amp; \\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)=J^{\\theta}\\left(t+1, x_{t+1} ; w\\right)-J^{\\theta}\\left(t, x_{t} ; w\\right) \\\\     &amp; J^{\\theta}\\left(t, x_{t} ; w\\right)\\ \u200b\u4e2d\u200b\u7684\u200b\u53c2\u6570\u200b\\ \\theta_{1}=e^{-2 \\phi_{2}}  &amp; \\end{align*}\\] \\[\\begin{equation}     \\frac{\\partial C}{\\partial \\theta_{2}}=\\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right]\\left((t+1)^{2}-t^{2}\\right), \\end{equation}\\] \\[\\begin{equation}     \\frac{\\partial C}{\\partial \\theta_{3}}=\\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right], \\end{equation}\\] \\[\\begin{equation}     \\frac{\\partial C}{\\partial \\phi_{1}}=-\\lambda \\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right], \\end{equation}\\] \\[\\begin{equation}     \\begin{split}         \\frac{\\partial C}{\\partial \\phi_{2}}= &amp;\\sum_{\\left(t, x_{t}\\right) \\in D}\\left[\\hat{J}^{\\theta}\\left(t, x_{t} ; w\\right)-\\lambda\\left(\\phi_{1}+\\phi_{2}(T-t-1)\\right)\\right] \\times \\\\         &amp; \\left[2(T-t) e^{-2 \\phi_{2}(T-t)}\\left(x_{t}-\\rho_{t} w\\right)^{2}\\right. \\\\         &amp; \\left.-2(T-t-1) e^{-2 \\phi_{2}(T-t-1)}\\left(x_{t+1}-\\rho_{t+1} w\\right)^{2}-\\lambda(T-t-1)\\right].     \\end{split} \\end{equation}\\] <p>\\(\\theta_1\\) \u200b\u6839\u636e\u200b \\(\\theta_1 = e^{-2\\phi_2}\\)\uff0c\\(\\theta_4\\) \u200b\u5219\u200b\u6839\u636e\u200b\u7ec8\u503c\u200b\u6761\u4ef6\u200b\u8fdb\u884c\u200b\u66f4\u65b0\u200b</p> \\[\\begin{align*}     J^{\\theta}(T, x ; w) &amp;=\\left(x- w\\right)^{2}+\\theta_{2} T^{2}+\\theta_{3} T+\\theta_{4} \\\\     &amp; =(x-w)^{2}-(w-b)^{2} \\end{align*}\\] <p>\u200b\u6362\u53e5\u8bdd\u8bf4\u200b \\((\\theta_1,\\theta_4)\\) \u200b\u7684\u200b\u66f4\u65b0\u200b\u65b9\u6848\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>\\(\\theta_1 = e^{-2\\phi_2}\\) </li> <li>\\(\\theta_{4}=-\\theta_{2} T^{2}-\\theta_{3} T-(w-b)^{2}\\) </li> </ul>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#self-correcting-scheme","title":"Self-correcting Scheme","text":"\\[w_{n+1}=w_{n}-\\alpha\\left(x_{T}-b\\right)\\] <p>\u200b\u5176\u4e2d\u200b \\(\\alpha\\) \u200b\u662f\u200b\u62c9\u683c\u6717\u200b\u65e5\u200b\u4e58\u5b50\u200b\u81ea\u200b\u6821\u6b63\u200b\u7684\u200b\u5b66\u4e60\u200b\u7387\u200b\u3002</p> <p>\u200b\u5728\u200b\u5b9e\u73b0\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u5c06\u200b \\(x_T\\) \u200b\u66ff\u6362\u200b\u4e3a\u200b\u6837\u672c\u5747\u503c\u200b \\(\\frac{1}{N} \\sum_{j} x_{T}^{j}\\)</p> <ul> <li>\\(N\\) \u200b\u662f\u200b\u6837\u672c\u200b\u5927\u5c0f\u200b</li> <li>\\(\\left\\{x_{T}^{j}\\right\\}\\) \u200b\u662f\u200b \\(w\\) \u200b\u66f4\u65b0\u200b\u540e\u200b\u83b7\u5f97\u200b\u7684\u200b\u6700\u8fd1\u200b \\(N\\) \u200b\u4e2a\u200b\u7684\u200b\u7ec8\u503c\u200b\u8d22\u5bcc\u200b\u503c\u200b</li> </ul>"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#4","title":"4.\u200b\u4f2a\u200b\u4ee3\u7801","text":"Tip <p>\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u7684\u200b\u76ee\u6807\u200b\u662f\u200b\u901a\u8fc7\u200b\u627e\u5230\u200b\u4e00\u4e2a\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\uff0c\u200b\u6700\u5927\u5316\u200b\u7d2f\u79ef\u200b\u5956\u52b1\u200b\u3002\u200b\u901a\u5e38\u200b\u6709\u200b\u4e24\u7c7b\u200b\u65b9\u6cd5\u200b\uff1a</p> <ol> <li>\u200b\u57fa\u4e8e\u200b\u503c\u200b\u51fd\u6570\u200b\u7684\u200b\u65b9\u6cd5\u200b\uff08\u200b\u4ef7\u503c\u200b\u8fed\u4ee3\u200b\u3001\u200b\u7b56\u7565\u200b\u8fed\u4ee3\u200b\uff09\uff1a\u200b\u901a\u8fc7\u200b\u5b66\u4e60\u200b\u72b6\u6001\u503c\u200b\u51fd\u6570\u200b \\(V^\\pi(s)\\)\uff0c\u200b\u53cd\u8fc7\u6765\u200b\u4ece\u503c\u200b\u51fd\u6570\u200b\u63a8\u5bfc\u200b\u51fa\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u3002</li> <li>\u200b\u57fa\u4e8e\u200b\u7b56\u7565\u200b\u7684\u200b\u65b9\u6cd5\u200b\uff08\u200b\u7b56\u7565\u200b\u68af\u5ea6\u200b\uff09\uff1a\u200b\u76f4\u63a5\u200b\u4f18\u5316\u200b\u7b56\u7565\u200b\uff0c\u200b\u4e0d\u200b\u4f9d\u8d56\u200b\u663e\u793a\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b\u3002</li> </ol> 1.\u200b\u7b56\u7565\u200b\u8fed\u4ee3\u200b\u7684\u200b\u8fdb\u672c\u200b\u6846\u67b6\u200b <p>\u200b\u7b56\u7565\u200b\u8bc4\u4f30\u200b\uff1a\u200b\u7ed9\u5b9a\u200b\u5f53\u524d\u200b\u7b56\u7565\u200b \\(\\pi^k\\)\uff0c\u200b\u8ba1\u7b97\u200b\u5176\u200b\u5bf9\u5e94\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b \\(V^{\\pi^k}(s)\\)</p> <p>\u200b\u7b56\u7565\u200b\u6539\u8fdb\u200b\uff1a\u200b\u6839\u636e\u200b\u503c\u200b\u51fd\u6570\u200b\uff0c\u200b\u66f4\u65b0\u200b\u7b56\u7565\u200b \\(\\pi^{k+1}\\)\uff0c\u200b\u4f8b\u5982\u200b\u9009\u62e9\u200b\u8ba9\u200b \\(V^{\\pi^k}(s)\\) \u200b\u6700\u5927\u5316\u200b\u7684\u200b\u7b56\u7565\u200b\u5206\u5e03\u200b\uff1a</p> \\[\\pi^{k+1}(s) = \\arg\\max_{\\pi^k} V^{\\pi^k}(s) \\] \u200b\u8fed\u4ee3\u200b\uff1a\u200b\u91cd\u590d\u200b\u4ee5\u4e0a\u200b\u6b65\u9aa4\u200b\uff0c\u200b\u76f4\u5230\u200b\u7b56\u7565\u200b\u6536\u655b"},{"location":"blog/2024/09/16/%E5%9F%BA%E4%BA%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%A6%BB%E6%95%A3%E6%97%B6%E9%97%B4%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E7%AD%96%E7%95%A5/#5result","title":"5.Result","text":"<p>\u200b\u8bba\u6587\u200b\u590d\u73b0\u200b\u4ee3\u7801\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u67e5\u9605\u200b\u6b64\u5904\u200b</p> <p>\u200b\u8bba\u6587\u200b\u590d\u73b0\u200b\u5b9e\u9a8c\u200b\u7ed3\u679c\u200b\u5982\u4e0b\u200b\uff1a</p> <p>b = 1.1, a = 0.3, sigma = 0.3 \u200b\u6536\u76ca\u200b: 0.1033, \u200b\u6807\u51c6\u5dee\u200b: 0.1201, \u200b\u590f\u666e\u200b\u6bd4\u7387\u200b: 0.8604</p> <p>b = 1.07, a = 0.3, sigma = 0.3 \u200b\u6536\u76ca\u200b: 0.0710, \u200b\u6807\u51c6\u5dee\u200b: 0.0921, \u200b\u590f\u666e\u200b\u6bd4\u7387\u200b: 0.7707</p> <p>b = 1.05, a = 0.3, sigma = 0.3 \u200b\u6536\u76ca\u200b: 0.0502, \u200b\u6807\u51c6\u5dee\u200b: 0.0665, \u200b\u590f\u666e\u200b\u6bd4\u7387\u200b: 0.7546</p> <p>b = 1.1, a = 0.3, sigma = 0.2 \u200b\u6536\u76ca\u200b: 0.1078, \u200b\u6807\u51c6\u5dee\u200b: 0.1661, \u200b\u590f\u666e\u200b\u6bd4\u7387\u200b: 0.6488</p> <p>b = 1.07, a = 0.3, sigma = 0.2 \u200b\u6536\u76ca\u200b: 0.0717, \u200b\u6807\u51c6\u5dee\u200b: 0.1144, \u200b\u590f\u666e\u200b\u6bd4\u7387\u200b: 0.6263</p> <p>b = 1.05, a = 0.3, sigma = 0.2 \u200b\u6536\u76ca\u200b: 0.0522, \u200b\u6807\u51c6\u5dee\u200b: 0.0764, \u200b\u590f\u666e\u200b\u6bd4\u7387\u200b: 0.6833</p>"},{"location":"blog/2024/09/30/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/","title":"Recent advances in reinforcement learning in finance (2)","text":"<p>Autor\uff1a Ben Hambly, Renyuan Xu, Huining Yang</p>"},{"location":"blog/2024/09/30/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#3","title":"3.\u200b\u6df1\u5ea6\u200b\u5f3a\u5316\u200b\u5b66\u4e60","text":"<p>\u2003\u2003\u200b\u5f53\u200b\u72b6\u6001\u200b\u7a7a\u95f4\u200b\u548c\u200b\u52a8\u4f5c\u200b\u7a7a\u95f4\u200b\u975e\u5e38\u200b\u5927\u200b\uff0c\u200b\u6216\u200b\u9ad8\u7ef4\u200b\u7684\u200b\uff0c\u200b\u6216\u200b\u4ed6\u4eec\u200b\u662f\u200b\u8fde\u7eed\u200b\u7684\u200b\uff0c\u200b\u5c31\u200b\u5f88\u200b\u96be\u200b\u53bb\u200b\u5e94\u7528\u200b\u7ecf\u5178\u200b\u7684\u200b value-based \u200b\u548c\u200b policy-based methods\u3002 \u200b\u5728\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u53c2\u6570\u200b\u5316\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b (\\(Q(s,a;\\theta)\\) \u200b\u548c\u200b \\(V(s,a;\\theta)\\)) \u200b\u6216\u200b\u7b56\u7565\u200b (\\(\\pi(s,a;\\theta)\\)) \u200b\u8981\u200b\u66f4\u4e3a\u200b\u5b9e\u7528\u200b\u3002 \u200b\u6b64\u5904\u200b\u4e3b\u8981\u200b\u8ba8\u8bba\u200b\u57fa\u4e8e\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u548c\u200b\u51fd\u6570\u200b\u903c\u8fd1\u200b\uff0c\u200b\u4ed6\u4eec\u200b\u6709\u200b\u4ee5\u4e0b\u200b\u4f18\u52bf\u200b\uff1a  </p> <ul> <li>\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u975e\u5e38\u9002\u5408\u200b\u5904\u7406\u200b\u9ad8\u7ef4\u200b\u8f93\u5165\u200b\uff0c\u200b\u5982\u200b\u65f6\u95f4\u200b\u5e8f\u5217\u200b\u6570\u636e\u200b\uff0c \u200b\u5e76\u4e14\u200b\uff0c\u200b\u5728\u5b9e\u8df5\u4e2d\u200b\uff0c\u200b\u5f53\u5411\u200b\u72b6\u6001\u200b\u6216\u200b\u52a8\u4f5c\u200b\u7a7a\u95f4\u200b\u6dfb\u52a0\u200b\u989d\u5916\u200b\u7684\u200b\u7ef4\u5ea6\u200b\u65f6\u200b\uff0c\u200b\u5b83\u4eec\u200b\u4e0d\u200b\u9700\u8981\u200b\u6570\u636e\u200b\u7684\u200b\u6307\u6570\u200b\u7ea7\u200b\u589e\u957f\u200b</li> <li>\u200b\u6b64\u5916\u200b\uff0c\u200b\u5b83\u4eec\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u8fdb\u884c\u200b\u589e\u91cf\u200b\u8bad\u7ec3\u200b\uff0c\u200b\u5e76\u4e14\u200b\u80fd\u591f\u200b\u5145\u5206\u5229\u7528\u200b\u5728\u200b\u5b66\u4e60\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u83b7\u5f97\u200b\u7684\u200b\u989d\u5916\u200b\u6837\u672c\u200b\u3002</li> </ul> \u200b\u4e4b\u540e\u200b\u5f15\u5165\u200b\u7684\u200bdeep RL \u200b\u65b9\u6cd5\u200b\u90fd\u200b\u57fa\u4e8e\u200b\u4ee5\u4e0b\u200b\u8bbe\u7f6e\u200b Settings: infinite time horizon with discounting, finite state and action spaces(\\(|\\mathcal{A}|&lt;\\infty\\) and \\(|\\mathcal{S}|&lt;\\infty\\)) and stationary policies."},{"location":"blog/2024/09/30/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#31-neural-networks","title":"3.1 Neural networks","text":""},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/","title":"Recent advances in reinforcement learning in finance (1)","text":"<p>\u200b\u8fd9\u662f\u200b\u4e00\u7bc7\u200b\u91d1\u878d\u200b\u9886\u57df\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u7684\u200b\u7efc\u8ff0\u200b\uff082021\uff09\u3002\u200b\u7ecf\u5178\u200b\u7684\u200b\u968f\u673a\u200b\u63a7\u5236\u200b\u7406\u8bba\u200b\u548c\u200b\u5176\u4ed6\u200b\u5206\u6790\u65b9\u6cd5\u200b\u89e3\u51b3\u200b\u91d1\u878d\u200b\u51b3\u7b56\u95ee\u9898\u200b\uff0c\u200b\u4e25\u91cd\u200b\u4f9d\u8d56\u200b\u6a21\u578b\u200b\u5047\u8bbe\u200b\u3002\u200b\u800c\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\uff08RL\uff09\u200b\u7684\u200b\u65b0\u200b\u53d1\u5c55\u200b\u80fd\u591f\u200b\u7528\u200b\u8f83\u200b\u5c11\u200b\u7684\u200b\u6a21\u578b\u200b\u5047\u8bbe\u200b\uff0c\u200b\u5145\u5206\u5229\u7528\u200b\u5927\u91cf\u200b\u7684\u200b\u91d1\u878d\u200b\u6570\u636e\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u590d\u6742\u200b\u7684\u200b\u91d1\u878d\u200b\u73af\u5883\u200b\u4e2d\u200b\u6539\u8fdb\u200b\u51b3\u7b56\u200b\u3002</p> <p>Autor\uff1a Ben Hambly, Renyuan Xu, Huining Yang</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#2","title":"2.\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u57fa\u7840","text":""},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#21-setupmarkov-decision-processes","title":"2.1 Setup:Markov decision processes","text":"<p>\u200b\u9a6c\u5c14\u79d1\u592b\u200b\u51b3\u7b56\u200b\u8fc7\u7a0b\u200b(MDPs, Markov decision processes)\u200b\u662f\u200b\u5177\u6709\u200b\u9a6c\u5c14\u79d1\u592b\u200b\u6027\u8d28\u200b\u7684\u200b\u968f\u673a\u200b\u8fc7\u7a0b\u200b\u3002</p> <p>\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u4f18\u5316\u200b\u95ee\u9898\u200b\uff0c\u200b\u901a\u5e38\u200b\u6709\u200b\u4e24\u7c7b\u200b\u95ee\u9898\u200b\uff0c\u200b\u4e00\u7c7b\u200b\u662f\u200b\u7684\u200b Infinite time horizon \u200b\u7684\u200b MDPs\uff0c \u200b\u53e6\u4e00\u7c7b\u200b\u5219\u200b\u662f\u200b finite time horizon \u200b\u7684\u200bMDPs\u3002 \u200b\u524d\u8005\u200b\u4e3b\u8981\u200b\u7814\u7a76\u200b\u957f\u671f\u200b\u7684\u200b\u6295\u8d44\u200b\u7b56\u7565\u200b\uff0c\u200b\u5982\u200b\u517b\u8001\u91d1\u200b\u95ee\u9898\u200b\u3002 \u200b\u800c\u200b\u540e\u8005\u200b\u4e3b\u8981\u200b\u7814\u7a76\u200b\u77ed\u671f\u5185\u200b\u7684\u200b\u4ea4\u6613\u200b\uff0c\u200b\u5982\u200b\u8d44\u4ea7\u200b\u8d2d\u4e70\u200b\u6216\u200b\u6e05\u7b97\u200b\u7684\u200b\u6700\u4f18\u200b\u6267\u884c\u200b\u95ee\u9898\u200b\uff0c \u200b\u82e5\u200b\u76ee\u6807\u200b\u91d1\u989d\u200b\u6ca1\u6709\u200b\u88ab\u200b\u5b8c\u5168\u200b\u6267\u884c\u200b\uff0c\u200b\u5219\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5728\u200b\u7ec8\u6b62\u200b\u65f6\u95f4\u200b\u53d7\u5230\u200b\u5904\u7f5a\u200b\u3002</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#infinite-time-horizon-and-discounted-reward","title":"Infinite time horizon and discounted reward.","text":"<p>\u200b\u9996\u5148\u200b\u8003\u8651\u200b\u65e0\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u548c\u200b\u6298\u6263\u200b\u5956\u52b1\u200b\u7684\u200b\u7684\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200bMDP\u3002</p> <ul> <li>\u200b\u72b6\u6001\u200b\u7a7a\u95f4\u200b \\(\\mathcal{S}\\)\uff0cMarkov process\u200b\u53d6\u503c\u200b\u7684\u200b\u7a7a\u95f4\u200b</li> <li>\u200b\u52a8\u4f5c\u200b\u96c6\u5408\u200b \\(\\mathcal{A}\\)\uff0c\u200b\u901a\u8fc7\u200b\u5728\u200b\u96c6\u5408\u200b\u4e2d\u200b\u91c7\u53d6\u200b\u52a8\u4f5c\u200b\u5f71\u54cd\u200b\u6f14\u5316\u200b</li> <li>\u200b\u76ee\u7684\u200b\u662f\u200b\u901a\u8fc7\u200b\u9009\u62e9\u200b\u4e00\u4e2a\u200b\u7b56\u7565\u200b\uff08\u200b\u6cbf\u7740\u200b\u65f6\u95f4\u200b\u987a\u5e8f\u200b\u884c\u52a8\u200b\uff09\u200b\u6765\u200b\u4f18\u5316\u200b\u7cfb\u7edf\u200b\u7684\u200b\u9884\u671f\u200b\u56de\u62a5\u200b\u3002</li> </ul> <p>\u200b\u901a\u8fc7\u200b\u5b9a\u4e49\u200b\u503c\u200b\u51fd\u6570\u200b\u6765\u200b\u6570\u5b66\u200b\u7684\u200b\u8868\u793a\u200b\u8fd9\u200b\u4e00\u70b9\u200b</p> <p>Define value function \\(V^*\\) for each \\(s \\in \\mathcal{S}\\) to be</p> \\[\\begin{equation}     V^{*}(s)=\\sup _{\\Pi} V^{\\Pi}(s):=\\sup _{\\Pi} \\mathbb{E}^{\\Pi}\\left[\\sum_{t=0}^{\\infty} \\gamma^{t} r\\left(s_{t}, a_{t}\\right) \\mid s_{0}=s\\right], \\end{equation}\\] <p>subject to</p> \\[\\begin{equation}     s_{t+1} \\sim P\\left(s_{t}, a_{t}\\right), \\quad a_{t} \\sim \\pi_{t}\\left(s_{t}\\right) . \\end{equation}\\] <p>\u200b\u4ee5\u4e0b\u200b\u505a\u200b\u4e00\u4e9b\u200b\u8bb0\u53f7\u200b\u4e0a\u200b\u7684\u200b\u7ea6\u5b9a\u200b\uff1a</p> <ul> <li>\\(\\mathbb{E}^{\\Pi}\\) \u200b\u8868\u793a\u200b\u5728\u200b\u7b56\u7565\u200b \\({\\Pi}\\) \u200b\u4e0b\u200b\u7684\u200b\u671f\u671b\u200b\uff0c\u200b\u5176\u4e2d\u200b\u6982\u7387\u200b\u6d4b\u5ea6\u200b \\(\\mathcal{P}\\) \u200b\u63cf\u8ff0\u200bMDP\u200b\u4e2d\u200b\u7684\u200b\u52a8\u6001\u200b\u548c\u200b\u5956\u52b1\u200b\u3002</li> <li>\u200b\u4e00\u4e2a\u200b\u7a7a\u95f4\u200b \\(\\mathcal{X}\\) \u200b\u7684\u200b\u6982\u7387\u200b\u6d4b\u5ea6\u200b\u5199\u4e3a\u200b \\(\\mathcal{P}(\\mathcal{X})\\) </li> <li>\u200b\u72b6\u6001\u200b\u7a7a\u95f4\u200b \\((\\mathcal{S},d_\\mathcal{S})\\) \u200b\u548c\u200b\u52a8\u4f5c\u200b\u7a7a\u95f4\u200b \\((\\mathcal{A},d_\\mathcal{A})\\) \u200b\u90fd\u200b\u662f\u200b\u5b8c\u5168\u200b\u53ef\u5206\u200b\u7684\u200b\u5ea6\u91cf\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u5305\u62ec\u200b \\(\\mathcal{S}\\) \u200b\u548c\u200b \\(\\mathcal{A}\\) \u200b\u90fd\u200b\u662f\u200b\u6709\u9650\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u8fd9\u200b\u5728\u200bRL\u200b\u6587\u732e\u200b\u4e2d\u200b\u5e38\u89c1\u200b\u3002</li> <li>\\(\\gamma \\in (0,1)\\) \u200b\u662f\u200b\u4e00\u4e2a\u200b\u6298\u73b0\u200b\u56e0\u5b50\u200b</li> <li>\\(s_t \\in \\mathcal{S}\\)\uff1a\\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u72b6\u6001\u200b</li> <li>\\(a_t \\in \\mathcal{A}\\)\uff1a\\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u52a8\u4f5c\u200b</li> <li>\\(P: \\mathcal{S} \\times \\mathcal{A} \\rightarrow \\mathcal{P}(S)\\) \u200b\u9a6c\u5c14\u53ef\u592b\u200b\u8fc7\u7a0b\u200b\u4e0b\u200b\u7684\u200b\u8f6c\u79fb\u200b\u51fd\u6570\u200b</li> <li>\u200b\u8bb0\u53f7\u200b \\(s_{t+1} \\sim P\\left(s_{t}, a_{t}\\right)\\) \u200b\u8868\u793a\u200b \\(s_{t+1}\\) \u200b\u4ece\u200b\u5206\u5e03\u200b \\(P(s_t,a_t)\\in \\mathcal{P}(\\mathcal{S})\\) \u200b\u4e2d\u200b\u8fdb\u884c\u200b\u91c7\u6837\u200b\u3002</li> <li>\u200b\u5956\u52b1\u200b \\(r(s,a)\\) \u200b\u662f\u200b\u6bcf\u200b\u5bf9\u200b\\((s,a)\\in \\mathcal{S}\\times \\mathcal{A}\\) \u200b\u7684\u200b \\(\\mathbb{R}\\) \u200b\u4e2d\u200b\u7684\u200b\u4e00\u4e2a\u200b\u968f\u673a\u53d8\u91cf\u200b</li> <li> \u200b\u7b56\u7565\u200b \\(\\Pi=\\left\\{\\pi_{t}\\right\\}_{t=0}^{\\infty}\\) \u200b\u662f\u200b\u9a6c\u5c14\u53ef\u592b\u200b\u7684\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u53ea\u200b\u4f9d\u8d56\u4e8e\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b\uff0c\u200b\u5e76\u4e14\u200b\u53ef\u4ee5\u200b\u786e\u5b9a\u6027\u200b\u7684\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u662f\u200b\u968f\u673a\u200b\u7684\u200b\u3002 <ul> <li>\u200b\u5bf9\u4e8e\u200b\u786e\u5b9a\u6027\u200b\u7684\u200b\u7b56\u7565\u200b\uff0c\\(\\pi_{t}: \\mathcal{S} \\rightarrow \\mathcal{A}\\) \u200b\u5c06\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b \\(s_t\\) \u200b\u6620\u5c04\u200b\u5230\u200b\u4e00\u4e2a\u200b\u786e\u5b9a\u6027\u200b\u7684\u200b\u52a8\u4f5c\u200b</li> </ul> <ul> <li>\u200b\u5bf9\u4e8e\u200b\u968f\u673a\u200b\u7b56\u7565\u200b\uff0c\\(\\pi_{t}: \\mathcal{S} \\rightarrow \\mathcal{P}(\\mathcal{A})\\) \u200b\u5c06\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b \\(s_t\\) \u200b\u6620\u5c04\u200b\u5230\u200b\u4e00\u4e2a\u200b\u52a8\u4f5c\u200b\u7a7a\u95f4\u200b\u4e0a\u200b\u7684\u200b\u5206\u5e03\u200b\u3002</li> </ul> <p> \\(\\pi_t(s)\\in\\mathcal{P}(\\mathcal{A})\\) \u200b\u8868\u793a\u200b\u7ed9\u5b9a\u200b\u72b6\u6001\u200b \\(s\\) \u200b\u5728\u200b\u884c\u52a8\u200b\u7a7a\u95f4\u200b\u4e0a\u200b\u7684\u200b\u5206\u5e03\u200b</p> <p> \\(\\pi_t(s,a)\\) \u200b\u8868\u793a\u200b\u5728\u200b\u72b6\u6001\u200b \\(s\\) \u200b\u91c7\u53d6\u200b\u52a8\u4f5c\u200b \\(a\\) \u200b\u7684\u200b\u6982\u7387\u200b</p> </li> </ul> <p>MDPs With infinite-time horizon\uff0c\u200b\u5047\u8bbe\u200b\u5956\u52b1\u200b \\(r\\) \u200b\u548c\u200b\u8f6c\u79fb\u200b\u52a8\u6001\u200b \\(P\\) \u200b\u662f\u200b\u65f6\u95f4\u200b\u9f50\u6b21\u200b(time homogeneous)\u200b\u7684\u200b\uff0c \u200b\u8fd9\u200b\u5728\u200b\u9a6c\u5c14\u53ef\u592b\u200b\u51b3\u7b56\u200b\u8fc7\u7a0b\u200b\u6587\u732e\u200b\u4e2d\u662f\u200b\u4e00\u4e2a\u200b\u6807\u51c6\u200b\u5047\u8bbe\u200b\u3002 \u200b\u6b64\u5916\u200b\uff0c\u200b\u5982\u679c\u200b\u8003\u8651\u200b\u6700\u5c0f\u5316\u200b\u6210\u672c\u200b\u800c\u200b\u4e0d\u662f\u200b\u6700\u5927\u5316\u200b\u5956\u52b1\u200b\uff0c\u200b\u95ee\u9898\u200b\u7684\u200b\u8bbe\u7f6e\u200b\u672c\u8d28\u200b\u4e0a\u200b\u662f\u200b\u76f8\u540c\u200b\u7684\u200b\u3002</p> <p>\u200b\u52a8\u6001\u200b\u89c4\u5212\u200b\u539f\u5219\u200b(dynamic programming principle, DPP)\u200b\u6307\u200b\u7684\u200b\u662f\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u6700\u5927\u5316\u200b \u200b\u5355\u6b65\u200b\u7684\u200b\u5956\u52b1\u200b\uff0c\u200b\u7136\u540e\u200b\u4ece\u200b\u65b0\u200b\u7684\u200b\u72b6\u6001\u200b\u8fdb\u884c\u200b\u6700\u4f18\u5316\u200b\u5904\u7406\u200b\u3002 \u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u7528\u200b\u5b83\u200b\u6765\u200b\u63a8\u5bfc\u200b\u503c\u200b\u51fd\u6570\u200b(1)\u200b\u7684\u200b\u8d1d\u5c14\u66fc\u200b\u65b9\u7a0b\u200b</p> \\[\\begin{equation}     V^{*}(s)=\\sup _{a \\in \\mathcal{A}}\\left\\{\\mathbb{E}[r(s, a)]+\\gamma \\mathbb{E}_{s^{\\prime} \\sim P(s, a)}\\left[V^{*}\\left(s^{\\prime}\\right)\\right]\\right\\} . \\end{equation}\\] <p>\u200b\u5f15\u5165\u200b Q-function \uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5c06\u503c\u200b\u51fd\u6570\u200b\u6539\u5199\u200b\u6210\u200b</p> \\[V^{*}(s)=\\sup _{a \\in \\mathcal{A}} Q^{*}(s, a) ,\\] <p>Q-function \u200b\u662f\u200bRL\u200b\u4e2d\u200b\u7684\u200b\u5176\u4e2d\u200b\u4e00\u4e2a\u200b\u57fa\u672c\u200b\u91cf\u200b\uff0c\u200b\u5b9a\u4e49\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     Q^{*}(s, a)=\\mathbb{E}[r(s, a)]+\\gamma \\mathbb{E}_{s^{\\prime} \\sim P(s, a)}\\left[V^{*}\\left(s^{\\prime}\\right)\\right], \\end{equation}\\] <p>\u200b\u5728\u200b\u72b6\u6001\u200b \\(s\\) \u200b\u4e0b\u200b\u91c7\u53d6\u200b\u52a8\u4f5c\u200b \\(a\\) \u200b\u7684\u200b\u9884\u671f\u200b\u5956\u52b1\u200b\uff0c\u200b\u540e\u200b\u518d\u200b\u91c7\u53d6\u200b\u6700\u4f18\u5316\u200b\u7b56\u7565\u200b\u3002 \u200b\u5bf9\u4e8e\u200b Q-function\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5199\u51fa\u200b\u4ed6\u200b\u7684\u200b\u8d1d\u5c14\u66fc\u200b\u65b9\u7a0b\u200b\uff0c\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     Q^{*}(s, a)=\\mathbb{E}[r(s, a)]+\\gamma \\mathbb{E}_{s^{\\prime} \\sim P(s, a)} \\sup _{a^{\\prime} \\in \\mathcal{A}} Q^{*}\\left(s^{\\prime}, a^{\\prime}\\right) . \\end{equation}\\] <p>\u200b\u8fd9\u4f7f\u200b\u6211\u4eec\u200b\u80fd\u591f\u200b\u4ece\u200b \\(Q(s,a)\\) \u200b\u4e2d\u200b\u63d0\u53d6\u200b\u6700\u4f18\u200b\uff08\u200b\u5e73\u7a33\u200b\uff09\u200b\u7b56\u7565\u200b \\(\\pi^*(s,a)\\)\uff08\u200b\u5982\u679c\u200b\u5b58\u5728\u200b\u7684\u8bdd\u200b\uff09\uff0c\u200b\u5177\u4f53\u200b\u4e3a\u200b</p> \\[\\pi^{*}(s, a) \\in \\arg \\max _{a \\in \\mathcal{A}} Q(s, a) .\\] <p>\u200b\u6b64\u5904\u200b\u7684\u200b\u65e0\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u91c7\u53d6\u200b\u7684\u200b\u6298\u73b0\u200b\u5956\u52b1\u200b\u7684\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u8fd8\u6709\u200b\u53e6\u200b\u4e00\u79cd\u200b\u8bbe\u7f6e\u200b\u662f\u200b\u5e73\u5747\u200b\u5956\u52b1\u200b\uff0c\u200b\u4e5f\u200b\u88ab\u200b\u79f0\u4e3a\u200b\u904d\u5386\u200b\u5f0f\u200b\u5956\u52b1\u200b\uff0c\u200b\u8fd9\u79cd\u200b\u904d\u5386\u200b\u5f0f\u200b\u7684\u200b\u8bbe\u7f6e\u200b\u901a\u5e38\u200b\u4e0e\u200b\u91d1\u878d\u200b\u5e94\u7528\u200b\u4e0d\u200b\u76f8\u5173\u200b\u3002</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#finite-time-horizon","title":"Finite time horizon.","text":"<p>\u200b\u6709\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b \\(T&lt;\\infty\\) \uff0c\u200b\u4e0d\u518d\u200b\u8d34\u73b0\u200b\u672a\u6765\u200b\u7684\u200b\u4ef7\u503c\u200b\u5e76\u4e14\u200b\u6709\u200b\u4e00\u4e2a\u200b\u7ec8\u6b62\u200b\u5956\u52b1\u200b\u3002\u200b\u6709\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u7684\u200bMDP\u200b\u95ee\u9898\u200b\u53ef\u4ee5\u200b\u8868\u793a\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     V_{t}^{*}(s)=\\sup _{\\Pi} V_{t}^{\\Pi}(s):=\\sup _{\\Pi} \\mathbb{E}^{\\Pi}\\left[\\sum_{u=t}^{T-1} r_{u}\\left(s_{u}, a_{u}\\right)+r_{T}\\left(s_{T}\\right) \\Bigg| s_{t}=s\\right], \\forall s \\in \\mathcal{S}, \\end{equation}\\] <p>subject to</p> \\[\\begin{equation}     s_{u+1} \\sim P_{u}\\left(s_{u}, a_{u}\\right), \\quad a_{u} \\sim \\pi_{u}\\left(s_{u}\\right), \\quad t \\leq u \\leq T-1. \\end{equation}\\] <p>\u200b\u5728\u200b\u65e0\u9650\u200b\u65f6\u95f4\u200b\u60c5\u51b5\u200b\u7684\u200b\u4f8b\u5b50\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u7528\u200b \\(s_u\\in \\mathcal{S}\\) \u200b\u548c\u200b \\(a_u\\in \\mathcal{A}\\) \u200b\u8868\u793a\u200b agent \u200b\u5728\u200b\u65f6\u95f4\u200b \\(u\\) \u200b\u7684\u200b\u72b6\u6001\u200b\u548c\u200b\u52a8\u4f5c\u200b\u3002 \u200b\u7136\u800c\u200b\uff0c\u200b\u6709\u9650\u200b\u65f6\u95f4\u200b\u4e0e\u200b\u65e0\u9650\u200b\u65f6\u95f4\u200b\u6709\u200b\u4e00\u70b9\u200b\u4e0d\u540c\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u6211\u4eec\u200b\u5141\u8bb8\u200b\u65f6\u95f4\u200b\u4f9d\u8d56\u6027\u200b\u7684\u200b\u8f6c\u79fb\u200b\u548c\u200b\u5956\u52b1\u200b\u51fd\u6570\u200b\u3002</p> <ul> <li>\\(P_{u}: \\mathcal{S} \\times \\mathcal{A} \\rightarrow \\mathcal{P}(S)\\) \u200b\u8868\u793a\u200b\u8f6c\u79fb\u200b\u51fd\u6570\u200b</li> <li>\\(r_u(s,a)\\) \u200b\u5bf9\u200b\u6bcf\u200b\u4e00\u5bf9\u200b\\((s,a)\\in \\mathcal{S}\\times \\mathcal{A}\\) \u200b\u662f\u200b\u4e00\u4e2a\u200b\u5b9e\u503c\u200b\u7684\u200b\u968f\u673a\u53d8\u91cf\u200b\uff0c\\(t\\leq u \\leq T-1\\)</li> <li>\\(r_T(s)\\) \u200b\u7ec8\u7aef\u200b\u5956\u52b1\u200b\uff0c\u200b\u5bf9\u200b\u6240\u6709\u200b\u7684\u200b \\(s\\in\\mathcal{S}\\) \u200b\u662f\u200b\u4e00\u4e2a\u200b\u5b9e\u503c\u200b\u968f\u673a\u53d8\u91cf\u200b</li> <li>\\(\\Pi=\\left\\{\\pi_{u}\\right\\}_{t=0}^{T}\\) \u200b\u9a6c\u5c14\u53ef\u592b\u200b\u7b56\u7565\u200b\u53ef\u4ee5\u200b\u662f\u200b\u786e\u5b9a\u6027\u200b\u7684\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u662f\u200b\u968f\u673a\u200b\u7684\u200b</li> </ul> <p>\u200b\u503c\u200b\u51fd\u6570\u200b(6)\u200b\u5bf9\u5e94\u200b\u7684\u200b\u8d1d\u5c14\u66fc\u200b\u65b9\u7a0b\u200b\u5b9a\u4e49\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         V_{t}^{*}(s) &amp;=\\sup _{a \\in \\mathcal{A}}\\left\\{\\mathbb{E}\\left[r_{t}(s, a)\\right]+\\mathbb{E}_{s^{\\prime} \\sim P_{t}(s, a)}\\left[V_{t+1}^{*}\\left(s^{\\prime}\\right)\\right]\\right\\}, \\\\         V_{T}^{*}(s) &amp;=\\mathbb{E}\\left[r_{T}(s)\\right]\\ \\ \\ \\ \\text{(terminal condition)}     \\end{split} \\end{equation}\\] <p>\u200b\u53ef\u4ee5\u200b\u5c06\u503c\u200b\u51fd\u6570\u200b\u5199\u6210\u200b</p> \\[V_{t}^{*}(s)=\\sup _{a \\in \\mathcal{A}} Q_{t}^{*}(s, a),\\] <p>\u200b\u5176\u4e2d\u200b \\(Q_t^*\\) \u200b\u51fd\u6570\u200b\u5b9a\u4e49\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     Q_{t}^{*}(s, a)=\\mathbb{E}\\left[r_{t}(s, a)\\right]+\\mathbb{E}_{s^{\\prime} \\sim P_{t}(s, a)}\\left[V_{t}^{*}\\left(s^{\\prime}\\right)\\right]. \\end{equation}\\] <p>\\(Q\\)-function \u200b\u7684\u200b\u8d1d\u5c14\u66fc\u200b\u65b9\u7a0b\u200b\u7531\u4e0b\u5f0f\u200b\u7ed9\u51fa\u200b</p> \\[\\begin{equation}     \\begin{split}         Q_{t}^{*}(s, a) &amp;=\\mathbb{E}\\left[r_{t}(s, a)\\right]+\\mathbb{E}_{s^{\\prime} \\sim P_{t}(s, a)}\\left[\\sup _{a^{\\prime} \\in \\mathcal{A}} Q_{t+1}^{*}\\left(s^{\\prime}, a^{\\prime}\\right)\\right],\\\\         Q_{T}^{*}(s, a) &amp;=\\mathbb{E}\\left[r_{T}(s)\\right]\\ \\ \\ \\ \\text{for all } a \\in \\mathcal{A}     \\end{split} \\end{equation}\\] Note <p>\u200b\u91d1\u878d\u200b\u65f6\u95f4\u200b\u5e8f\u5217\u200b\u6570\u636e\u200b\u901a\u5e38\u200b\u662f\u975e\u200b\u5e73\u7a33\u200b\u7684\u200b\uff0c\u200b\u56e0\u6b64\u200b(6)\u200b\u548c\u200b(7)\u200b\u5f0f\u200b\u4e2d\u200b\u7684\u200b\u65f6\u95f4\u200b\u53d8\u5316\u200b\u8f6c\u79fb\u200b\u6838\u200b\u548c\u200b\u4ef7\u683c\u200b\u51fd\u6570\u200b\u5bf9\u4e8e\u200b\u91d1\u878d\u200b\u5e94\u7528\u200b\u5c24\u4e3a\u91cd\u8981\u200b\u3002</p> <p>\u200b\u5bf9\u4e8e\u200b\u4e00\u4e2a\u200b\u5177\u6709\u200b\u6709\u9650\u200b\u72b6\u6001\u200b\u548c\u200b\u52a8\u4f5c\u200b\u7a7a\u95f4\u200b\u4ee5\u53ca\u200b\u6709\u9650\u200b\u5956\u52b1\u200b \\(r\\) \u200b\u7684\u200b\u65e0\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u7684\u200b\u9a6c\u5c14\u53ef\u592b\u200b\u51b3\u7b56\u200b\u8fc7\u7a0b\u200b\uff08MDP\uff09\uff0c \u200b\u4e00\u4e2a\u200b\u8fdb\u4e00\u6b65\u200b\u6709\u7528\u200b\u7684\u200b\u89c2\u5bdf\u200b\u662f\u200b\uff0c\u200b\u53ea\u8981\u200b\u5b58\u5728\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\uff0c\u200b\u8be5\u200bMDP\u200b\u603b\u662f\u200b\u5177\u6709\u200b\u4e00\u4e2a\u200b\u5e73\u7a33\u200b\u7684\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u3002</p> <p>Theorem 2.1 Theorem 6.2.7 in Puterman (2014). Assume \\(|\\mathcal{A}|&lt;\\infty\\),  \\(|\\mathcal{S}|&lt;\\infty\\), and \\(|r|&lt;\\infty\\) with probability one. For any infinite horizon discounted MDP,  there always exists a deterministic stationary policy that is optimal.</p> <p>\u200b\u5b9a\u7406\u200b 2.1 \u200b\u610f\u5473\u7740\u200b\u603b\u662f\u200b\u5b58\u5728\u200b\u4e00\u4e2a\u200b\u56fa\u5b9a\u200b\u7684\u200b\u7b56\u7565\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5728\u200b\u6bcf\u4e2a\u200b\u65f6\u95f4\u200b\u6b65\u957f\u200b\u6267\u884c\u200b\u8be5\u200b\u7b56\u7565\u200b\u6307\u5b9a\u200b\u7684\u200b\u64cd\u4f5c\u200b\u6700\u5927\u5316\u200b\u6298\u6263\u200b\u5956\u52b1\u200b\u3002 agent \u200b\u4e0d\u200b\u9700\u8981\u200b\u968f\u200b\u65f6\u95f4\u200b\u6539\u53d8\u200b\u7b56\u7565\u200b\u3002\u200b\u5e73\u5747\u200b\u5956\u52b1\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e5f\u200b\u6709\u200b\u4e00\u4e2a\u200b\u7c7b\u4f3c\u200b\u7684\u200b\u7ed3\u679c\u200b\uff0c\u200b\u89c1\u200b Theorem 8.1.2 in Puterman (2014).</p> <p>\u200b\u8fd9\u200b\u5c06\u200b\u5bfb\u627e\u200b\u6700\u4f18\u200b\u987a\u5e8f\u200b\u51b3\u7b56\u200b\u7b56\u7565\u200b\u95ee\u9898\u200b\u51cf\u5c11\u200b\u5230\u200b\u5bfb\u627e\u200b\u6700\u4f18\u200b\u5e73\u7a33\u200b\u7b56\u7565\u200b\u7684\u200b\u95ee\u9898\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u8bb0\u200b \\(\\pi: \\mathcal{S} \\rightarrow \\mathcal{P}(\\mathcal{A})\\) (\u200b\u6ca1\u6709\u200b\u65f6\u95f4\u200b\u6307\u6570\u200b) \u200b\u4e3a\u200b\u4e00\u4e2a\u200b\u5e73\u7a33\u200b\u7b56\u7565\u200b\u3002</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#linear-mdps-and-linear-functional-approximation","title":"Linear MDPs and linear functional approximation.","text":"<p>Note</p> <p>\u200b\u5728\u200b\u7ebf\u6027\u200b\u9a6c\u5c14\u53ef\u592b\u200b\u51b3\u7b56\u200b\u8fc7\u7a0b\u200b\uff08MDP\uff09\u200b\u4e2d\u200b\uff0c\u200b\u8f6c\u79fb\u200b\u6838\u200b\uff08transition kernels\uff09\u200b\u548c\u200b\u5956\u52b1\u200b\u51fd\u6570\u200b\uff08reward function\uff09\u200b\u88ab\u200b\u5047\u8bbe\u200b\u4e3a\u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u67d0\u4e9b\u200b\u7279\u5f81\u200b\u6620\u5c04\u200b\u662f\u200b\u7ebf\u6027\u200b\u7684\u200b\uff08Bradtke &amp; Barto, 1996\uff1bMelo &amp; Ribeiro, 2007\uff09\u3002</p> <p>\u200b\u5728\u200b\u65e0\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u7684\u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u82e5\u200b\u5b58\u5728\u200b \\(d\\) \u200b\u4e2a\u200b\u5728\u200b \\(\\mathcal{S}\\) \u200b\u4e0a\u200b\u672a\u77e5\u200b(\u200b\u7b26\u53f7\u200b)\u200b\u6d4b\u5ea6\u200b \\(\\mu=\\left(\\mu^{(1)}, \\ldots, \\mu^{(d)}\\right)\\) \uff0c\u200b\u4ee5\u53ca\u200b\u4e00\u4e2a\u200b\u672a\u77e5\u200b\u7684\u200b\u5411\u91cf\u200b \\(\\theta\\in\\mathbb{R}^d\\)\uff0c\u200b\u6ee1\u8db3\u200b\u5bf9\u200b\u4efb\u610f\u200b\u7684\u200b \\((s,a)\\in \\mathcal{S}\\times\\mathcal{A}\\)\uff0c\u200b\u6709\u200b</p> \\[\\begin{equation}     P(\\cdot \\mid s, a)=\\langle\\phi(s, a), \\mu(\\cdot)\\rangle, \\quad r(s, a)=\\langle\\phi(s, a), \\theta\\rangle . \\end{equation}\\] <p>\u200b\u5219\u200b\u79f0\u200b\u8be5\u200bMDP\u200b\u4e3a\u200b\u5177\u6709\u7279\u5f81\u200b\u6620\u5c04\u200b\u7684\u200b\u7279\u5f81\u200b\u6620\u5c04\u200b \\(\\phi:\\mathcal{S}  \\times \\mathcal{A} \\rightarrow \\mathbb{R}^{d}\\) \u200b\u7684\u200b\u7ebf\u6027\u200bMDP\u3002</p> <p>\u200b\u4e0e\u200b\u4e4b\u200b\u76f8\u4f3c\u200b\uff0c\u200b\u5728\u200b\u6709\u9650\u200b\u65f6\u95f4\u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u82e5\u200b\u5bf9\u4e8e\u200b\u4efb\u610f\u200b\u7684\u200b \\(0\\leq t \\leq T\\)\uff0c\u200b\u5b58\u5728\u200b \\(d\\) \u200b\u4e2a\u200b\u5728\u200b \\(\\mathcal{S}\\)\u200b\u4e0a\u200b\u7684\u200b \u200b\u672a\u77e5\u200b(\u200b\u7b26\u53f7\u200b)\u200b\u6d4b\u5ea6\u200b \\(\\mu_{t}=\\left(\\mu_{t}^{(1)}, \\ldots, \\mu_{t}^{(d)}\\right)\\) \u200b\u4ee5\u53ca\u200b\u4e00\u4e2a\u200b\u672a\u77e5\u200b\u7684\u200b\u5411\u91cf\u200b \\(\\theta_t \\in\\mathbb{R}^d\\)\uff0c \u200b\u6ee1\u8db3\u200b\u5bf9\u200b\u4efb\u610f\u200b\u7684\u200b \\((s,a)\\in \\mathcal{S}\\times\\mathcal{A}\\)\uff0c\u200b\u6709\u200b</p> \\[\\begin{equation}     P_{t}(\\cdot \\mid s, a)=\\left\\langle\\phi(s, a), \\mu_{t}(\\cdot)\\right\\rangle, \\quad r_{t}(s, a)=\\left\\langle\\phi(s, a), \\theta_{t}\\right\\rangle \\end{equation}\\] <p>\u200b\u5219\u200b\u79f0\u200b\u8be5\u200bMDP\u200b\u4e3a\u200b\u5177\u6709\u7279\u5f81\u200b\u6620\u5c04\u200b\u7684\u200b\u7279\u5f81\u200b\u6620\u5c04\u200b \\(\\phi:\\mathcal{S}  \\times \\mathcal{A} \\rightarrow \\mathbb{R}^{d}\\) \u200b\u7684\u200b\u7ebf\u6027\u200bMDP\u3002</p> <p>\u200b\u901a\u5e38\u200b\u5047\u8bbe\u200b\u8fd9\u4e9b\u200b\u7279\u5f81\u200b(features)\u200b\u662f\u200b agent \u200b\u5df2\u77e5\u200b\u4e14\u200b\u6709\u754c\u200b\u7684\u200b\uff0c\u200b\u4e5f\u5c31\u662f\u8bf4\u200b \\(\\|\\phi(s, a)\\| \\leq 1\\) \u200b\u5bf9\u200b\u6240\u6709\u200b\u7684\u200b \\((s,a)\\in\\mathcal{S}\\times\\mathcal{A}\\)\u3002</p> <p>\u200b\u7ebf\u6027\u200bMDP\u200b\u6846\u67b6\u200b\u4e0e\u200b\u5177\u6709\u200b\u7ebf\u6027\u200b\u51fd\u6570\u200b\u903c\u8fd1\u200b\u7684\u200bRL\u200b\u7684\u200b\u6587\u732e\u200b\u5bc6\u5207\u76f8\u5173\u200b\uff0c\u200b\u5176\u4e2d\u200b\u7684\u200b\u503c\u200b\u51fd\u6570\u200b\u5047\u8bbe\u200b\u4e3a\u200b\u5f62\u5f0f\u200b</p> <p>For the infinite horizon case,</p> \\[\\begin{equation}     Q(s, a)=\\langle\\psi(s, a), \\omega\\rangle, \\quad V(s)=\\langle\\xi(s), \\eta\\rangle \\end{equation}\\] <p>For the finite horizon case,</p> \\[\\begin{equation}     Q_{t}(s, a)=\\left\\langle\\psi(s, a), \\omega_{t}\\right\\rangle, \\quad V_{t}(s)=\\left\\langle\\xi(s), \\eta_{t}\\right\\rangle, \\forall 0 \\leq t \\leq T \\end{equation}\\] <ul> <li>\\(\\psi: \\mathcal{S} \\times \\mathcal{A} \\rightarrow \\mathbb{R}^{d}\\) \u200b\u548c\u200b \\(\\xi: \\mathcal{S} \\rightarrow \\mathbb{R}^{d}\\) \u200b\u662f\u200b\u5df2\u77e5\u200b\u7684\u200b\u7279\u5f81\u200b\u6620\u5c04\u200b</li> <li>\\(\\omega, \\omega_t,\\eta\\) \u200b\u548c\u200b \\(\\eta_t\\) \u200b\u662f\u200b\u672a\u77e5\u200b\u5411\u91cf\u200b</li> </ul> <p>\u200b\u5728\u200b\u6e29\u548c\u200b\u6761\u4ef6\u200b\u4e0b\u200b\uff0c\u200b\u7ebf\u6027\u200b\u9a6c\u5c14\u53ef\u592b\u200b\u51b3\u7b56\u200b\u8fc7\u7a0b\u200b(\u200b\u5373\u200b(11)\u200b\u6216\u200b(12))\u200b\u4e0e\u200b \u200b\u7ebf\u6027\u200b\u51fd\u6570\u200b\u903c\u8fd1\u200b\u5f62\u5f0f\u200b(\u200b\u5373\u200b(13)\u200b\u6216\u200b(14))\u200b\u662f\u200b\u7b49\u4ef7\u200b\u7684\u200b\uff08Jin et al., 2020\uff1bYang &amp; Wang, 2019\uff09\u3002</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#nonlinear-functional-approximation","title":"Nonlinear functional approximation.","text":"<p>\u200b\u4e0e\u200b\u7ebf\u6027\u200b\u51fd\u6570\u200b\u903c\u8fd1\u200b\u76f8\u6bd4\u200b\uff0c\u200b\u975e\u7ebf\u6027\u200b\u51fd\u6570\u200b\u903c\u8fd1\u200b\u4e0d\u200b\u9700\u8981\u200b\u5148\u9a8c\u200b\u7684\u200b kernel functions \u200b\u77e5\u8bc6\u200b\u3002 \u200b\u975e\u7ebf\u6027\u200b\u51fd\u6570\u200b\u6709\u200b\u53ef\u80fd\u200b\u89e3\u51b3\u200b\u5f53\u200b agent \u200b\u5bf9\u200bMDP\u200b\u6240\u5904\u200b\u7684\u200b\u51fd\u6570\u200b\u7a7a\u95f4\u200b\u7406\u89e3\u200b\u4e0d\u200b\u6b63\u786e\u200b\uff0c\u200b\u5f15\u8d77\u200b\u7684\u200b\u6a21\u578b\u200b\u8bef\u8bbe\u200b\u95ee\u9898\u200b\u3002 \u200b\u6700\u200b\u6d41\u884c\u200b\u7684\u200b\u7684\u200b\u975e\u7ebf\u6027\u200b\u51fd\u6570\u200b\u903c\u8fd1\u200b\u65b9\u6cd5\u200b\u662f\u200b\u4f7f\u7528\u200b\u795e\u7ecf\u7f51\u7edc\u200b\uff0c\u200b\u4ece\u800c\u200b\u5f62\u6210\u200b\u6df1\u5ea6\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b(deep RL)\u3002 \u200b\u5f97\u76ca\u4e8e\u200b<code>Universal approximation theorem</code>\u200b\u5b9a\u7406\u200b\uff0c\u200b\u8fd9\u662f\u200b\u4e00\u79cd\u200b\u7406\u8bba\u200b\u4e0a\u200b\u5408\u7406\u200b\u7684\u200b\u65b9\u6cd5\u200b\uff0c \u200b\u4e14\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u5728\u200b\u5e7f\u6cdb\u200b\u7684\u200b\u5e94\u7528\u200b\u4e2d\u200b\u8868\u73b0\u200b\u51fa\u200b\u826f\u597d\u200b\u7684\u200b\u6027\u80fd\u200b\u3002 \u200b\u540c\u65f6\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u67d0\u4e9b\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u67b6\u6784\u200b\uff0c\u200b\u57fa\u4e8e\u200b\u68af\u5ea6\u200b\u7684\u200b\u7b97\u6cd5\u200b\u5177\u6709\u200b\u53ef\u200b\u8bc1\u660e\u200b\u7684\u200b\u6536\u655b\u6027\u200b\u4fdd\u8bc1\u200b\u3002</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#22-from-mdp-to-learning","title":"2.2 From MDP to learning","text":"<p>\u200b\u5f53\u200b\u8f6c\u79fb\u200b\u52a8\u6001\u200b \\(P\\) \u200b\u548c\u200b\u5956\u52b1\u200b\u51fd\u6570\u200b \\(r\\) \u200b\u5bf9\u4e8e\u200b\u65e0\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u7684\u200b MDP \u200b\u95ee\u9898\u200b\u662f\u200b\u672a\u77e5\u200b\u7684\u200b\uff0c\u200b\u8be5\u200b MDP \u200b\u95ee\u9898\u200b\u5c31\u200b\u4f1a\u200b\u53d8\u4e3a\u200b RL \u200b\u95ee\u9898\u200b \uff08\u200b\u5373\u200b\u5bfb\u627e\u200b\u4e00\u4e2a\u200b\u6700\u4f18\u200b\u7684\u200b\u5e73\u7a33\u200b\u7b56\u7565\u200b \\(\\pi\\) \uff08\u200b\u5982\u679c\u200b\u5b58\u5728\u200b\uff09\uff0c\u200b\u540c\u65f6\u200b\u5b66\u4e60\u200b\u672a\u77e5\u200b\u7684\u200b \\(P\\) \u200b\u548c\u200b \\(r\\) \uff09\u3002 \\(P\\) \u200b\u548c\u200b \\(r\\) \u200b\u7684\u200b\u5b66\u4e60\u200b\u53ef\u4ee5\u200b\u662f\u200b\u663e\u793a\u200b\u7684\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u662f\u200b\u9690\u5f0f\u200b\u7684\u200b\uff0c\u200b\u8fd9\u200b\u5206\u522b\u200b\u5f62\u6210\u200b\u4e86\u200b model-based \u200b\u548c\u200b model-free RL. \u200b\u7c7b\u4f3c\u200b\u7684\u200b\u601d\u60f3\u200b\u4e5f\u200b\u9002\u7528\u200b\u4e8e\u200b\u6709\u9650\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u5f15\u5165\u200b\u4e00\u4e9b\u200b\u6807\u51c6\u200b\u7684\u200b RL \u200b\u672f\u8bed\u200b\u3002</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#agent-environment-interface","title":"Agent-environment interface.","text":"\u5728\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\uff08RL\uff09\u200b\u73af\u5883\u200b\u4e2d\u200b\uff0c\u200b\u5b66\u4e60\u8005\u200b\u6216\u200b\u51b3\u7b56\u8005\u200b\u79f0\u4e3a\u200b\u667a\u80fd\u200b\u4f53\u200b\uff08agent\uff09\u3002agent \u200b\u6240\u200b\u64cd\u4f5c\u200b\u548c\u200b\u4e92\u52a8\u200b\u7684\u200b\u7269\u7406\u200b\u4e16\u754c\u200b\uff0c\u200b\u5305\u62ec\u200b agent \u200b\u4e4b\u5916\u200b\u7684\u200b\u6240\u6709\u200b\u4e8b\u7269\u200b\uff0c\u200b\u79f0\u4e3a\u200b\u73af\u5883\u200b\uff08environment\uff09\u3002 agent \u200b\u548c\u200b environment \u200b\u5728\u200b\u4e00\u7cfb\u5217\u200b\u79bb\u6563\u200b\u65f6\u95f4\u200b\u6b65\u9aa4\u200b \\(t=0,1,2,\\dots,\\) \u200b\u4e2d\u4ee5\u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u8fdb\u884c\u200b\u4e92\u52a8\u200b\u3002 <ul> <li>At the beginning of each time step \\(t\\), agent \u200b\u63a5\u53d7\u200b environment \u200b\u72b6\u6001\u200b\u7684\u200b\u67d0\u79cd\u200b\u8868\u793a\u200b \\(s_t\\in\\mathcal{S}\\)\uff0c\u200b\u5e76\u200b\u9009\u62e9\u200b\u4e00\u4e2a\u200b\u52a8\u4f5c\u200b \\(a_t\\in\\mathcal{A}\\)\u3002</li> <li>At the end of this time step, \u200b\u4f5c\u4e3a\u200b\u5176\u200b\u52a8\u4f5c\u200b\u4ea7\u751f\u200b\u7684\u200b\u90e8\u5206\u200b\u7ed3\u679c\u200b\uff0cagent \u200b\u4ece\u200b environment \u200b\u63a5\u6536\u200b\u5230\u200b\u4e00\u4e2a\u200b\u6570\u503c\u200b\u5956\u52b1\u200b \\(r_t\\)\uff08\u200b\u53ef\u80fd\u200b\u662f\u200b\u968f\u673a\u200b\u7684\u200b\uff09\u200b\u548c\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u72b6\u6001\u200b \\(s_{t+1}\\)\u3002</li> </ul> \\((s_t,a_t,r_t,s_{t+1})\\) \u200b\u79f0\u4e3a\u200b\u65f6\u95f4\u200b \\(t\\) \u200b\u7684\u200b\u4e00\u4e2a\u200b\u6837\u672c\u200b\uff0c\u200b\u800c\u200b \\(h_{t}:=\\left\\{\\left(s_{u}, a_{u}, r_{u}, s_{u+1}\\right)\\right\\}_{u=0}^{t}\\) \u200b\u88ab\u200b\u79f0\u4e3a\u200b\u622a\u81f3\u200b\u65f6\u95f4\u200b \\(t\\) \u200b\u7684\u200b\u5386\u53f2\u200b\u6216\u200b\u7ecf\u9a8c\u200b\u3002\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u7b97\u6cd5\u200b\u662f\u200b agent \u200b\u4e0e\u200b environment \u200b\u4e92\u52a8\u200b\u7684\u200b\u826f\u5b9a\u200b\u7b56\u7565\u200b\u7684\u200b\u6709\u9650\u200b\u5e8f\u5217\u200b\u3002"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#exploration-versus-exploitation","title":"Exploration versus exploitation.","text":"\u4e3a\u4e86\u200b\u6700\u5927\u5316\u200b\u65f6\u95f4\u200b\u79ef\u7d2f\u200b\u7684\u200b\u5956\u52b1\u200b\uff0cagent \u200b\u57fa\u4e8e\u200b\u8fc7\u53bb\u200b\u7684\u200b\u7ecf\u9a8c\u200b\u8fdb\u884c\u200b\u5b66\u4e60\u200b\u5e76\u200b\u9009\u62e9\u200b\u884c\u52a8\u200b(exploitation)\u200b\u548c\u200b/\u200b\u6216\u200b\u5c1d\u8bd5\u200b\u65b0\u200b\u7684\u200b\u9009\u62e9\u200b(Exploration) \u200b\u63a2\u7d22\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u80fd\u200b\u5c06\u200b\u5f53\u524d\u200b\u6b21\u4f18\u200b\u89e3\u200b\u6539\u8fdb\u200b\u4e3a\u200b\u6700\u7ec8\u200b\u5168\u5c40\u200b\u6700\u4f18\u200b\u89e3\u200b\u7684\u200b\u673a\u4f1a\u200b\uff0c \u200b\u4f46\u200b\u8fd9\u200b\u9700\u8981\u200b\u8017\u8d39\u200b\u65f6\u95f4\u200b\u548c\u200b\u8ba1\u7b97\u8d44\u6e90\u200b\uff0c\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b\u8fc7\u5ea6\u200b\u63a2\u7d22\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u524a\u5f31\u200b\u7b97\u6cd5\u200b\u6536\u655b\u200b\u5230\u200b\u6700\u4f18\u200b\u89e3\u200b\u7684\u200b\u901f\u5ea6\u200b\u3002 \u200b\u4e0e\u200b\u4e4b\u200b\u76f8\u6bd4\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u7eaf\u200b\u5229\u7528\u200b\uff0c\u200b\u5373\u4ec5\u200b\u57fa\u4e8e\u200b\u8fc7\u53bb\u200b\u7ecf\u9a8c\u200b\u77ed\u89c6\u200b\u5730\u200b\u9009\u62e9\u200b\u5f53\u524d\u200b\u89e3\u200b\uff0c \u200b\u867d\u7136\u200b\u6613\u4e8e\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u5374\u200b\u5f80\u5f80\u200b\u5bfc\u81f4\u200b\u6b21\u4f18\u200b\u7684\u200b\u5168\u5c40\u200b\u89e3\u200b\u3002 \u200b\u56e0\u6b64\u200b\uff0c\u200b\u5728\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u7b97\u6cd5\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u4e2d\u200b\uff0c\u200b\u4e3a\u200b\u63d0\u5347\u200b\u5b66\u4e60\u200b\u548c\u200b\u4f18\u5316\u200b\u8868\u73b0\u200b\uff0c\u200b\u9002\u5f53\u200b\u5e73\u8861\u200b\u63a2\u7d22\u200b\u4e0e\u200b\u5229\u7528\u200b\u81f3\u5173\u91cd\u8981\u200b\u3002"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#simulator","title":"Simulator.","text":"\u4e0a\u8ff0\u200b\u63cf\u8ff0\u200b\u7684\u200b agent \u200b\u4e0e\u200b environment \u200b\u7684\u200b\u4ea4\u4e92\u200b\u8fc7\u7a0b\u200b\uff0cagent \u200b\u662f\u200b\u4ee5\u200b\u5728\u7ebf\u200b\u65b9\u5f0f\u200b\u4e0e\u200b nvironment \u200b\u8fdb\u884c\u200b\u4ea4\u4e92\u200b\u7684\u200b\u3002 \u200b\u5373\u200b\uff0c\u200b\u5728\u200b\u65f6\u95f4\u200b\u6b65\u9aa4\u200b \\(t+1\\) \u200b\u65f6\u200b\u7684\u200b\u521d\u59cb\u72b6\u6001\u200b \\(s_{t+1}\\) \u200b\u662f\u200b agent \u200b\u4ece\u200b\u72b6\u6001\u200b \\(s_t\\) \u200b\u91c7\u53d6\u200b\u52a8\u4f5c\u200b \\(a_t\\) \u200b\u540e\u200b\u79fb\u52a8\u200b\u5230\u200b\u7684\u200b\u72b6\u6001\u200b\u3002 \u200b\u8fd9\u662f\u200b\u4e00\u4e2a\u200b\u5177\u6709\u200b\u6311\u6218\u6027\u200b\u7684\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u9700\u8981\u200b\u6709\u6548\u200b\u7684\u200b\u63a2\u7d22\u200b\u65b9\u6848\u200b\u3002\u200b\u4f8b\u5982\u200b\uff0c\u200b\u4f7f\u7528\u200b \\(\\epsilon\\)-greedy  \u200b\u7b56\u7565\u200b\u7684\u200b \\(Q\\)-learning \u200b\u53ef\u80fd\u200b\u9700\u8981\u200b\u7ecf\u5386\u200b\u6307\u6570\u200b\u7ea7\u200b\u7684\u200b\u65f6\u95f4\u200b\u624d\u80fd\u200b\u5b66\u4e60\u200b\u5230\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u3002 \u200b\u4e00\u4e9b\u200b\u7814\u7a76\u200b\u5047\u8bbe\u200b\u53ef\u4ee5\u200b\u8bbf\u95ee\u200b\u6a21\u62df\u5668\u200b\uff0c\u200b\u5141\u8bb8\u200b\u7b97\u6cd5\u200b\u67e5\u8be2\u200b\u4efb\u610f\u200b\u7684\u200b\u72b6\u6001\u200b-\u200b\u52a8\u4f5c\u200b\u5bf9\u200b\u5e76\u200b\u8fd4\u56de\u200b\u5956\u52b1\u200b\u548c\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u72b6\u6001\u200b\u3002 \u200b\u8fd9\u200b\u610f\u5473\u7740\u200b\u667a\u80fd\u200b\u4f53\u200b\u53ef\u4ee5\u200b\u5728\u200b\u4efb\u4f55\u200b\u65f6\u5019\u200b\u201c\u200b\u91cd\u542f\u200b\u201d\u200b\u7cfb\u7edf\u200b\u3002\u200b\u4e5f\u5c31\u662f\u8bf4\u200b\uff0c\u200b\u5728\u200b\u65f6\u95f4\u200b\u6b65\u9aa4\u200b \\(t+1\\) \u200b\u65f6\u200b\u7684\u200b\u521d\u59cb\u72b6\u6001\u200b \u200b\u4e0d\u200b\u9700\u8981\u200b\u662f\u200b\u667a\u80fd\u200b\u4f53\u4ece\u200b\u72b6\u6001\u200b \\(s_t\\) \u200b\u91c7\u53d6\u200b\u52a8\u4f5c\u200b \\(a_t\\) \u200b\u540e\u200b\u79fb\u52a8\u200b\u5230\u200b\u7684\u200b\u72b6\u6001\u200b\u3002 \u200b\u8fd9\u4e2a\u200b\u201cSimulator\u201d\u200b\u663e\u8457\u200b\u51cf\u8f7b\u200b\u4e86\u200b\u63a2\u7d22\u200b\u7684\u200b\u96be\u5ea6\u200b\uff0c \u200b\u56e0\u4e3a\u200b\u4e00\u79cd\u200b\u7b80\u5355\u200b\u7684\u200b\u63a2\u7d22\u200b\u7b56\u7565\u200b\uff0c\u200b\u5747\u5300\u200b\u968f\u673a\u200b\u67e5\u8be2\u200b\u6240\u6709\u200b\u72b6\u6001\u200b-\u200b\u52a8\u4f5c\u200b\u5bf9\u200b\uff0c \u200b\u5df2\u7ecf\u200b\u80fd\u200b\u6210\u4e3a\u200b\u5bfb\u627e\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u7684\u200b\u6700\u200b\u6709\u6548\u200b\u7b97\u6cd5\u200b\u3002"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#randomized-policy-versus-deterministic-policy","title":"Randomized policy versus deterministic policy.","text":"\u968f\u673a\u200b\u7b56\u7565\u200b \\(\\pi_{t}: \\mathcal{S}  \\rightarrow \\mathcal{P}(\\mathcal{A})\\) \u200b\u5728\u200b\u63a7\u5236\u200b\u6587\u732e\u200b\u4e2d\u200b\u4e5f\u200b\u88ab\u200b\u79f0\u4e3a\u200b\u677e\u5f1b\u200b\u63a7\u5236\u200b\uff0c \u200b\u5728\u200b\u535a\u5f08\u8bba\u200b\u4e2d\u200b\u4e5f\u200b\u88ab\u200b\u79f0\u4e3a\u200b\u6df7\u5408\u7b56\u7565\u200b\u3002 \u200b\u5c3d\u7ba1\u200b\u5728\u200b\u5b9a\u7406\u200b2.1\u200b\u4e2d\u200b\u5b58\u5728\u200b\u4e00\u4e2a\u200b\u786e\u5b9a\u6027\u200b\u7684\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\uff0c \u200b\u4f46\u200b\u5f53\u200b RL agents \u200b\u5bf9\u200b\u73af\u5883\u200b\u4e0d\u200b\u786e\u5b9a\u200b\u65f6\u200b\uff0c\u200b\u5927\u591a\u6570\u200bRL\u200b\u7b97\u6cd5\u200b\u90fd\u200b\u91c7\u7528\u200b\u968f\u673a\u200b\u7b56\u7565\u200b\u6765\u200b\u9f13\u52b1\u200b\u63a2\u7d22\u200b\u3002"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#an-example-multi-armed-bandits","title":"An example: multi-armed bandits.","text":"\u591a\u81c2\u200b\u8001\u864e\u673a\u200b\u6a21\u578b"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#221-performance-evaluation","title":"2.2.1 Performance evaluation","text":"<p>\u200b\u4e00\u822c\u200b\u662f\u200b\u4e0d\u200b\u53ef\u80fd\u200b\u89e3\u6790\u200b\u6c42\u89e3\u200bMDPs\u200b\u7684\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u5c06\u200b\u8ba8\u8bba\u200b\u6570\u503c\u200b\u7b97\u6cd5\u200b\u6765\u200b\u786e\u5b9a\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\u3002 \u200b\u4e3a\u4e86\u200b\u8bc4\u4f30\u200b\u4e0d\u540c\u200b\u7684\u200b\u7b97\u6cd5\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4e00\u4e2a\u200b\u8861\u91cf\u200b\u5b83\u4eec\u200b\u7684\u200b\u6027\u80fd\u200b\u3002\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u5c06\u200b\u8003\u8651\u200b\u51e0\u79cd\u200b\u7c7b\u578b\u200b\u7684\u200b\u6027\u80fd\u200b\u5ea6\u91cf\u200b\uff1a \u200b\u6837\u672c\u200b\u590d\u6742\u5ea6\u200b\u3001\u200b\u6536\u655b\u200b\u901f\u5ea6\u200b\u3001regret\u200b\u5206\u6790\u200b\u548c\u200b\u6e10\u8fd1\u6536\u655b\u200b\u6027\u200b\u3002</p> <p>[TODO]</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#222-classification-of-rl-algorithms","title":"2.2.2 Classification of RL algorithms","text":"<p>\u200b\u4e00\u4e2a\u200b RL \u200b\u7b97\u6cd5\u200b\u5305\u542b\u200b\u4ee5\u4e0b\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b\u90e8\u4ef6\u200b\uff1a</p> <ul> <li>\u200b\u503c\u200b\u51fd\u6570\u200b\u7684\u200b\u8868\u793a\u200b\uff0c\u200b\u63d0\u4f9b\u200b\u6bcf\u4e2a\u200b\u72b6\u6001\u200b\u6216\u200b\u6bcf\u4e2a\u200b\u72b6\u6001\u200b/\u200b\u52a8\u4f5c\u200b\u5bf9\u200b\u6709\u200b\u591a\u200b\u597d\u200b\u7684\u200b\u9884\u6d4b\u200b\u3002</li> <li>\u200b\u7b56\u7565\u200b \\(\\pi(s)\\) \u200b\u6216\u200b \\(\\pi(s,a)\\) \u200b\u7684\u200b\u76f4\u63a5\u200b\u8868\u793a\u200b</li> <li>\u200b\u4e00\u79cd\u200b\u73af\u5883\u200b\u6a21\u578b\u200b\uff08\u200b\u4f30\u8ba1\u200b\u7684\u200b\u8f6c\u79fb\u200b\u51fd\u6570\u200b\u548c\u200b\u4f30\u8ba1\u200b\u7684\u200b\u5956\u52b1\u200b\u51fd\u6570\u200b\uff09\uff0c\u200b\u5e76\u200b\u7ed3\u5408\u200b\u4e00\u79cd\u200b\u89c4\u5212\u200b\u7b97\u6cd5\u200b \uff08\u200b\u4f7f\u7528\u200b\u6a21\u578b\u200b\u6765\u200b\u521b\u5efa\u200b\u6216\u200b\u6539\u8fdb\u200b\u7b56\u7565\u200b\u7684\u200b\u4efb\u4f55\u200b\u8ba1\u7b97\u200b\u8fc7\u7a0b\u200b\uff09\u3002</li> </ul> <p>\u200b\u524d\u200b\u4e24\u4e2a\u200b\u7ec4\u6210\u90e8\u5206\u200b\u4e0e\u200b\u6240\u8c13\u200b\u7684\u200b\u65e0\u200b\u6a21\u578b\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\uff08model-free RL\uff09\u200b\u76f8\u5173\u200b\u3002 \u200b\u5f53\u200b\u4f7f\u7528\u200b\u540e\u8005\u200b\u7ec4\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u7b97\u6cd5\u200b\u88ab\u200b\u79f0\u4e3a\u200b\u57fa\u4e8e\u200b\u6a21\u578b\u200b\u7684\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\uff08model-based RL\uff09\u3002</p> <p>\u200b\u5728\u200b\u9a6c\u5c14\u53ef\u592b\u200b\u51b3\u7b56\u200b\u8fc7\u7a0b\u200b\uff08MDP\uff09\u200b\u8bbe\u7f6e\u200b\u4e2d\u200b\uff0c model-based \u200b\u7b97\u6cd5\u200b\u901a\u8fc7\u200b\u4f30\u8ba1\u200b\u8f6c\u79fb\u200b\u6982\u7387\u200b\u548c\u200b\u5956\u52b1\u200b\u51fd\u6570\u200b\u6765\u200b\u7ef4\u6301\u200b\u4e00\u4e2a\u200b\u8fd1\u4f3c\u200b\u7684\u200b MDP \u200b\u6a21\u578b\u200b\uff0c\u200b\u5e76\u200b \u200b\u4ece\u200b\u8fd1\u4f3c\u200b\u7684\u200b MDP \u200b\u4e2d\u200b\u63a8\u5bfc\u200b\u51fa\u200b\u4ef7\u503c\u200b\u51fd\u6570\u200b\u3002\u200b\u7136\u540e\u200b\uff0c\u200b\u4ece\u200b\u4ef7\u503c\u200b\u51fd\u6570\u200b\u4e2d\u200b\u5bfc\u51fa\u200b\u7b56\u7565\u200b\u3002\u200b\u53e6\u4e00\u7c7b\u200b\u57fa\u4e8e\u200b\u6a21\u578b\u200b\u7684\u200b\u7b97\u6cd5\u200b\u5219\u200b\u662f\u200b \u200b\u5bf9\u6a21\u578b\u200b\u8fdb\u884c\u200b\u7ed3\u6784\u200b\u5047\u8bbe\u200b\uff0c\u200b\u4f7f\u7528\u200b\u4e00\u4e9b\u200b\u5148\u9a8c\u200b\u77e5\u8bc6\u200b\uff0c\u200b\u5e76\u200b\u5229\u7528\u200b\u7ed3\u6784\u200b\u4fe1\u606f\u200b\u8fdb\u884c\u200b\u7b97\u6cd5\u200b\u8bbe\u8ba1\u200b\u3002</p> \u200b\u4e0e\u200b model-based \u200b\u7684\u200b\u65b9\u6cd5\u200b\u4e0d\u540c\u200b\uff0cmodel-free \u200b\u7b97\u6cd5\u200b\u76f4\u63a5\u200b\u5b66\u4e60\u200b\u4ef7\u503c\u200b\uff08\u200b\u6216\u200b\u72b6\u6001\u200b-\u200b\u4ef7\u503c\u200b\uff09\u200b\u51fd\u6570\u200b\u6216\u200b\u6700\u4f18\u200b\u7b56\u7565\u200b\uff0c \u200b\u800c\u200b\u65e0\u9700\u200b\u63a8\u65ad\u200b\u6a21\u578b\u200b\u3002model-free \u200b\u7b97\u6cd5\u200b\u53ef\u4ee5\u200b\u8fdb\u4e00\u6b65\u200b\u5206\u4e3a\u200b\u4e24\u7c7b\u200b\uff1avalue-based \u200b\u548c\u200b policy-based \u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002 <p>policy-based \u200b\u65b9\u6cd5\u200b\u663e\u5f0f\u200b\u6784\u5efa\u200b\u7b56\u7565\u200b\u7684\u200b\u8868\u793a\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u5b66\u4e60\u200b\u8fc7\u7a0b\u4e2d\u5c06\u200b\u5176\u200b\u4fdd\u5b58\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u200b\u3002 \u200b\u4f8b\u5b50\u200b\u5305\u62ec\u200b\u7b56\u7565\u200b\u68af\u5ea6\u200b\u65b9\u6cd5\u200b\u548c\u200b\u4fe1\u4efb\u200b\u533a\u57df\u200b\u7b56\u7565\u200b\u4f18\u5316\u200b(trust region policy optimization, TRPO)\u200b\u65b9\u6cd5\u200b\u3002</p> <p>value-based \u200b\u4f5c\u4e3a\u200b\u4e00\u79cd\u200b\u66ff\u4ee3\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u5728\u200b\u5b66\u4e60\u200b\u8fc7\u7a0b\u200b\u4e2d\u4ec5\u200b\u5b58\u50a8\u200b\u4e00\u4e2a\u200b\u4ef7\u503c\u200b\u51fd\u6570\u200b\uff0c \u200b\u800c\u200b\u4e0d\u200b\u663e\u5f0f\u200b\u5b58\u50a8\u200b\u7b56\u7565\u200b\u3002\u200b\u5728\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u7b56\u7565\u200b\u662f\u200b\u9690\u5f0f\u200b\u7684\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u4ece\u200b\u4ef7\u503c\u200b\u51fd\u6570\u200b\u4e2d\u200b\u63a8\u5bfc\u200b\uff08\u200b\u901a\u8fc7\u200b\u9009\u62e9\u200b\u5177\u6709\u200b\u6700\u4f73\u200b\u4ef7\u503c\u200b\u7684\u200b\u52a8\u4f5c\u200b\uff09\u3002</p>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#23-value-based-methods","title":"2.3 Value-based methods","text":"Setting: Infinite time horizon with discounting, finite state and action space \\(|\\mathcal{A}|&lt;\\infty\\) and \\(|\\mathcal{S}|&lt;\\infty\\), and stationary policies."},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#231-temporal-difference-learning","title":"2.3.1 Temporal-difference learning","text":"<p>\u200b\u901a\u8fc7\u200b\u7b56\u7565\u200b \\(\\pi\\) \u200b\u83b7\u5f97\u200b\u4e00\u4e9b\u200b\u6837\u672c\u200b \\((s,a,r,s')\\)\uff0cagent \u200b\u53ef\u4ee5\u200b\u5728\u200b \\((n+1)th\\) \u200b\u8fed\u4ee3\u200b\u65f6\u200b\u66f4\u65b0\u200b\u5bf9\u503c\u200b\u51fd\u6570\u200b \\(V^\\pi\\) (defined in Equation(1)) \u200b\u7684\u200b\u4f30\u8ba1\u200b\u3002</p> \\[\\begin{equation}     V^{\\pi,(n+1)}(s) \\leftarrow\\left(1-\\beta_{n}(s, a)\\right) \\underbrace{V^{\\pi,(n)}(s)}_{\\text {current estimate }}+\\beta_{n}(s, a)[\\underbrace{r+\\gamma V^{\\pi,(n)}\\left(s^{\\prime}\\right)]}_{\\text {new estimate }}, \\end{equation}\\] <ul> <li>\\(V^{\\pi,(0)}\\) \u200b\u503c\u200b\u51fd\u6570\u200b\u7684\u200b\u521d\u59cb\u5316\u200b</li> <li> <p>\\(\\beta_n(s,a)\\) (1) \u200b\u662f\u200b\u7b2c\u200b \\(n+1\\) \u200b\u8fed\u4ee3\u200b\u65f6\u200b\u7684\u200b\u5b66\u4e60\u200b\u901f\u7387\u200b\uff0c\u200b\u5e73\u8861\u200b\u4e86\u200b\u5f53\u524d\u200b\u4f30\u8ba1\u200b\u548c\u200b\u65b0\u200b\u4f30\u8ba1\u200b\u4e4b\u95f4\u200b\u7684\u200b\u6743\u91cd\u200b\u3002</p> <ol> <li>\\(\\beta_n\\) \u200b\u53ef\u4ee5\u200b\u662f\u200b\u4e00\u4e2a\u200b\u5e38\u6570\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f9d\u8d56\u4e8e\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b \\(s\\)\uff0c\u200b\u751a\u81f3\u200b\u53ef\u4ee5\u200b\u4f9d\u8d56\u4e8e\u200b\u8fed\u4ee3\u200b\u81f3\u200b \\(n+1\\) \u200b\u6b21\u65f6\u200b\uff0c\u200b\u5df2\u200b\u89c2\u6d4b\u200b\u5230\u200b\u7684\u200b\u6837\u672c\u200b\u3002</li> </ol> </li> </ul> <p>\u200b\u4ee5\u4e0b\u200b\u662f\u200b\u8be5\u200b\u7b97\u6cd5\u200b\u7684\u200b\u4f2a\u200b\u4ee3\u7801\u200b\uff0c\u200b\u8be5\u200b\u516c\u5f0f\u200b\u4e5f\u200b\u88ab\u200b\u79f0\u4e3a\u200b TD(0) method\uff0c\u200b\u6216\u8005\u200b one-step TD method\u3002</p> <p>Algorithm 1 TD(0) Method for estimating \\(V^\\pi\\) </p> <p>Input: total number of iterations \\(N\\); the policy \\(\\pi\\) used to sample observations; rule to set learning rate \\(\\beta_n \\in (0,1](0\\leq n \\leq N-1)\\) Initialize \\(V^{\\pi,(0)}(s)\\) for all \\(s\\in \\mathcal{S}\\) Initialize \\(s\\) for \\(n=0,\\dots,N-1\\) do \u2003Sample action \\(a\\) according to \\(\\pi(s)\\) \u2003Observe \\(r\\) and \\(s'\\) after taking action \\(a\\) \u2003Update \\(V^{\\pi,(n+1)}\\) according to (2.21) with \\((s,a,r,s')\\) \\(s\\gets s'\\) end for</p> Note <p>TD(\\(\\lambda\\)) method \u200b\u7ed3\u5408\u200b\u4e86\u200b\u4e24\u79cd\u200b\u5e38\u89c1\u200b\u7684\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u65b9\u6cd5\u200b\uff1a\u200b\u65f6\u5e8f\u200b\u5dee\u5206\u200b\u5b66\u4e60\u200b (TD learning)(\u200b\u6743\u91cd\u200b \\(\\lambda\\) ) \u200b\u548c\u200bMonte Carlo method (\u200b\u6743\u91cd\u200b \\(1-\\lambda\\))\u3002  </p> <ol> <li>TD learning\uff1a\u200b\u9010\u6b65\u200b\u66f4\u65b0\u200b\u7684\u200b\u5f3a\u5316\u200b\u5b66\u4e60\u200b\u65b9\u6cd5\u200b\u3002\u200b\u5b83\u200b\u901a\u8fc7\u200b\u5bf9\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b\u548c\u200b\u672a\u6765\u200b\u72b6\u6001\u200b\u7684\u200b\u4f30\u8ba1\u200b\u5dee\u200b\uff08\u200b\u65f6\u95f4\u200b\u5dee\u5206\u200b\uff09\u200b\u8fdb\u884c\u200b\u66f4\u65b0\u200b\u3002TD \u200b\u5b66\u4e60\u200b\u9002\u5408\u200b\u5728\u200b\u6ca1\u6709\u200b\u5b8c\u6574\u200b\u8f68\u8ff9\u200b\u4fe1\u606f\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u8fdb\u884c\u200b\u5b66\u4e60\u200b\u3002  </li> <li>\u200b\u8499\u7279\u5361\u6d1b\u200b\u65b9\u6cd5\u200b\uff1a\u200b\u57fa\u4e8e\u200b\u6574\u4e2a\u200b\u8f68\u8ff9\u200b\u7684\u200b\u66f4\u65b0\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u5fc5\u987b\u200b\u7b49\u5230\u200b\u4e00\u4e2a\u200b\u5b8c\u6574\u200b\u7684\u200b\u8f68\u8ff9\u200b\u7ed3\u675f\u200b\u4e4b\u540e\u200b\uff0c\u200b\u624d\u80fd\u200b\u6839\u636e\u200b\u5b9e\u9645\u200b\u7684\u200b\u56de\u62a5\u200b\u6765\u200b\u66f4\u65b0\u200b\u4f30\u8ba1\u200b\u3002\u200b\u5b83\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u66f4\u200b\u591a\u200b\u5386\u53f2\u200b\u4fe1\u606f\u200b\u8fdb\u884c\u200b\u66f4\u65b0\u200b\u3002  </li> </ol> <p>TD(\\(\\lambda\\)) \u200b\u4f7f\u7528\u6743\u200b\u91cd\u200b\u53c2\u6570\u200b \\(\\lambda\\) \u200b\u6765\u200b\u5e73\u8861\u200b\u4e24\u79cd\u200b\u65b9\u6cd5\u200b:</p> <ul> <li>\u200b\u5f53\u200b \\(\\lambda = 1\\) \u200b\u65f6\u200b\uff0cTD\\((\\lambda)\\) \u200b\u53d8\u4e3a\u200b\u8499\u7279\u5361\u6d1b\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u5b8c\u5168\u200b\u4f9d\u8d56\u4e8e\u200b\u5b8c\u6574\u200b\u7684\u200b\u8f68\u8ff9\u200b\u3002  </li> <li>\u200b\u5f53\u200b \\(\\lambda = 0\\) \u200b\u65f6\u200b\uff0cTD(\ud835\udf06) \u200b\u53d8\u4e3a\u200b\u666e\u901a\u200b\u7684\u200b TD learning\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u53ea\u200b\u4f7f\u7528\u200b\u5355\u6b65\u200b\u66f4\u65b0\u200b\u3002  </li> <li>\\(\\lambda\\) \u200b\u4ecb\u4e8e\u200b 0 \u200b\u548c\u200b 1 \u200b\u4e4b\u95f4\u200b\u65f6\u200b\uff0c\u200b\u5b83\u200b\u662f\u200b\u4e24\u79cd\u200b\u65b9\u6cd5\u200b\u7684\u200b\u7ec4\u5408\u200b\uff0c\u200b\u65e2\u200b\u5229\u7528\u200b\u4e86\u200b\u65f6\u95f4\u200b\u5dee\u5206\u200b\u5b66\u4e60\u200b\u7684\u200b\u5feb\u901f\u200b\u66f4\u65b0\u200b\uff0c\u200b\u53c8\u200b\u5229\u7528\u200b\u4e86\u200b\u8499\u7279\u5361\u6d1b\u200b\u65b9\u6cd5\u200b\u5bf9\u200b\u957f\u671f\u200b\u56de\u62a5\u200b\u7684\u200b\u8003\u8651\u200b\u3002  </li> </ul> <p>\u200b\u7b80\u5355\u200b\u6765\u8bf4\u200b\uff0cTD\\((\\lambda)\\)\u200b\u662f\u200b\u4e00\u4e2a\u200b\u6743\u8861\u200b\u77ed\u671f\u200b\u66f4\u65b0\u200b\u548c\u200b\u957f\u671f\u200b\u66f4\u65b0\u200b\u7684\u200b\u6df7\u5408\u200b\u65b9\u6cd5\u200b\u3002</p> <p>TD \u200b\u66f4\u65b0\u200b\u65b9\u7a0b\u200b\u53ef\u4ee5\u200b\u91cd\u5199\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     V^{\\pi,(n+1)}(s) \\leftarrow V^{\\pi,(n)}(s)+\\beta_{n}(s, a) \\left[\\underbrace{\\overbrace{r+\\gamma V^{\\pi,(n)}\\left(s^{\\prime}\\right)}^{\\mathrm{TD} \\text { target }}-V^{\\pi,(n)}(s)}_{\\text {TD error } \\delta_{n}}\\right] . \\end{equation}\\] <ul> <li>\\(\\delta_n\\): TD error \uff0c\u200b\u6d4b\u91cf\u200b\u5728\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b \\(s\\) \u200b\u7684\u200b\u4f30\u8ba1\u503c\u200b\u597d\u200b\u66f4\u597d\u200b\u7684\u200b\u4f30\u8ba1\u200b(TD target) \\(r+\\gamma V^{\\pi,(n)}(s')\\) \u200b\u4e4b\u95f4\u200b\u7684\u200b\u5dee\u503c\u200b\u3002</li> <li>TD error \u200b\u548c\u200bTD target \u200b\u662f\u200b\u5206\u6790\u200b\u8fd1\u4f3c\u503c\u200b\u51fd\u6570\u200b\u6536\u655b\u6027\u200b\u7684\u200b\u4e24\u4e2a\u200b\u91cd\u8981\u200b\u7ec4\u6210\u90e8\u5206\u200b</li> </ul>"},{"location":"blog/2024/09/27/%E9%87%91%E8%9E%8D%E9%A2%86%E5%9F%9F%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%9C%80%E6%96%B0%E8%BF%9B%E5%B1%95/#232-q-learning-algorithm","title":"2.3.2 Q-learning algorithm","text":"<p>[TODO]</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/","title":"Deep Learning in Characteristics-Sorted Factor Models","text":"<p>Key Words: Cross-sectional Returns, Deep Learning, Latent Factors, Nonlinearity, Security Sorting.</p> <p>Autor\uff1a Guanhao Feng, Jingyu He, Nicholas G. Polson, Jianeng Xu*</p> <p>Forthcoming, Journal of Financial and Quantitative Analysis</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#ii","title":"II \u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u548c\u200b\u5b9e\u8bc1\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7","text":"<ul> <li>II.A \u200b\u5df2\u200b\u5b9e\u73b0\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b\u7684\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u4f18\u5316\u200b</li> <li>II.B \u200b\u7279\u5f81\u200b\u6392\u5e8f\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u91cd\u6784\u200b</li> <li>II.C \u200b\u5b9e\u73b0\u200bFama-French\u200b\u6a21\u578b\u200b\u4f5c\u4e3a\u200b\u7279\u4f8b\u200b</li> </ul>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iia","title":"II.A  \u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u4f18\u5316","text":"<p>\u200b\u6807\u51c6\u200b\u7684\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u7ebf\u6027\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u57fa\u4e8e\u200b\u56e0\u5b50\u200b\u98ce\u9669\u200b\u6ea2\u4ef7\u200b(factor risk premia)\u200b\u5206\u89e3\u200b\u5982\u4e0b\u200b:</p> \\[\\begin{equation}     E_{t-1}(r_{i,t}) = \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\boldsymbol{\\lambda_f} \\end{equation}\\] <ul> <li>\\(r_{i,t}:\\) \u200b\u8d44\u4ea7\u200b \\(i\\) \u200b\u5728\u200b\u65f6\u95f4\u200b \\(t\\) \u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b</li> <li>\\(\\boldsymbol{\\beta}_{i,t-1}:\\) \u200b\u56e0\u5b50\u200b\u5728\u200b\u65f6\u95f4\u200b \\(t-1\\) \u200b\u66f4\u65b0\u200b\u7684\u200b\u8f7d\u8377\u200b</li> <li>\\(\\boldsymbol{\\lambda_f}:\\) \\(K \\times 1\\) \u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_t\\) \u200b\u7684\u200b\u98ce\u9669\u200b\u6ea2\u4ef7\u200b</li> </ul> <p>\u200b\u4efb\u4f55\u200b\u6f5c\u5728\u200b\u7684\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b \\(\\alpha_i\\) \u200b\u90fd\u200b\u4f1a\u200b\u88ab\u200b\u6dfb\u52a0\u200b\u5728\u200b\u53f3\u4fa7\u200b</p> \\[\\begin{equation}     E_{t-1}(r_{i,t}) = \\alpha_i + \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\boldsymbol{\\lambda_f} \\end{equation}\\] \u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b <p>\u200b\u7b2c\u4e00\u79cd\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u53ef\u200b\u88ab\u200b\u516c\u5f0f\u200b\u63cf\u8ff0\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     \\tilde{r}_{i t}=a_{i}+b_{i}^{\\prime} \\tilde{f}_{t}+\\tilde{e}_{i t}     \\tag{1} \\end{equation}\\] <ul> <li>\\(i=1,2,\\dots, N\\) \u200b\u4ee3\u8868\u200b\u4e0d\u540c\u200b\u7684\u200b\u80a1\u7968\u200b</li> <li>\\(t = 1,2,\\dots, T\\) \u200b\u4ee3\u8868\u200b\u4e0d\u540c\u200b\u7684\u200b\u65f6\u6bb5\u200b</li> <li>\\(\\tilde{r}_{i t}\\) \u200b\u4ee3\u8868\u200b\u80a1\u7968\u200b \\(i\\) \u200b\u5728\u200b \\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u6536\u76ca\u7387\u200b</li> </ul> <p>\u200b\u8be5\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u542b\u4e49\u200b\u662f\u200b\uff0c\u200b\u80a1\u7968\u200b\u5728\u200b\u6bcf\u200b\u4e00\u200b\u65f6\u523b\u200b\u7684\u200b\u6536\u76ca\u7387\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b\u4e09\u4e2a\u200b\u90e8\u5206\u200b\uff1a</p> <ol> <li>\u200b\u4e0d\u968f\u200b\u65f6\u95f4\u200b\u6539\u53d8\u200b\u7684\u200b\u5e38\u6570\u200b\u9879\u200b \\(a_i\\)\u3002</li> <li>\u200b\u7531\u200b\u67d0\u4e2a\u200b\u53d8\u91cf\u200b \\(\\tilde{f}\\) \u200b\u9a71\u52a8\u200b\u7684\u200b\u90e8\u5206\u200b\u3002</li> <li>\u200b\u6a21\u578b\u200b\u672a\u80fd\u200b\u89e3\u91ca\u200b\u3001\u200b\u4f46\u200b\u4e0e\u200b \\(\\tilde{f}\\) \u200b\u65e0\u5173\u200b\u7684\u200b\u90e8\u5206\u200b\u3002</li> </ol> <p>\u200b\u6309\u7167\u200bBack(2010)\u200b\u4e66\u4e0a\u200b\u7684\u200b\u53eb\u6cd5\u200b\uff0c\u200b\u4e0d\u59a8\u200b\u5c06\u200b\u516c\u5f0f\u200b(1)\u200b\u79f0\u4e3a\u200b\u7edf\u8ba1\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b(statistical factor model)\uff0c \\(\\tilde{f}_t\\) \u200b\u79f0\u4e3a\u200b\u56e0\u5b50\u200b</p> <p>\u200b\u7b2c\u4e8c\u79cd\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u53ef\u4ee5\u200b\u88ab\u200b\u516c\u5f0f\u200b\u63cf\u8ff0\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     E[\\tilde{r}_{it}] = r_{ft} + b_i^\\prime \\lambda_t     \\tag{2} \\end{equation}\\] <ul> <li>\\(r_{ft}\\) \u200b\u662f\u200b \\(t\\) \u200b\u65f6\u523b\u200b\u7684\u200b\u65e0\u98ce\u9669\u200b\u5229\u7387\u200b</li> </ul> <p>\u200b\u8be5\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u542b\u4e49\u200b\u662f\u200b\uff0c\u200b\u80a1\u7968\u200b\u5728\u200b\u6bcf\u200b\u4e00\u200b\u65f6\u523b\u200b\u7684\u200b\u6536\u76ca\u7387\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b\u4e24\u4e2a\u200b\u90e8\u5206\u200b\uff1a</p> <ol> <li>\u200b\u65e0\u98ce\u9669\u200b\u5229\u7387\u200b</li> <li>\u200b\u7531\u200b \\(\\lambda_t\\) \u200b\u8d21\u732e\u200b\u7684\u200b\u90e8\u5206\u200b(\u200b\u4e5f\u200b\u79f0\u4f5c\u200b\u98ce\u9669\u200b\u6ea2\u4ef7\u200b)</li> </ol> <p>GRS\u200b\u68c0\u9a8c\u200b\u3002\u200b\u5982\u679c\u200b\u5b58\u5728\u200b\u5145\u5206\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b\u7684\u200b\u4e8c\u6b21\u200b\u9879\u200b\u5e94\u8be5\u200b\u5728\u200b\u7edf\u8ba1\u200b\u4e0a\u200b\u548c\u200b\u7ecf\u6d4e\u200b\u4e0a\u200b\u90fd\u200b\u662f\u200b\u4e0d\u200b\u663e\u8457\u200b\u7684\u200b\u3002\u200b\u4f46\u662f\u200b\uff0c\u200b\u5728\u200b\u5b66\u672f\u200b\u6587\u732e\u200b\u4e2d\u200b\u5e76\u200b\u4e0d\u200b\u5b58\u5728\u200b\u8fd9\u6837\u200b\u7684\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u3002</p> <p>\u200b\u8fd9\u200b\u7bc7\u6587\u7ae0\u200b\u8bad\u7ec3\u200b\u4e86\u200b\u57fa\u4e8e\u200b\u6ede\u540e\u200b\u7279\u5f81\u200b\u7684\u200bbetas\u200b\u975e\u7ebf\u6027\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u65b9\u7a0b\u200b(2)\u200b\u4e2d\u200b\u603b\u4f53\u200b\u6a21\u578b\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         r_{i,t} &amp;= \\alpha_i + \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\mathbf{f}_t + \\epsilon_{i,t}, \\\\         \\boldsymbol{\\beta}_{i,t-1}^\\intercal &amp; = G(\\mathbf{z}_{i,t-1})     \\end{split} \\end{equation}\\] <p>\u200b\u5176\u4e2d\u200b betas \u200b\u7684\u200b\u5e73\u884c\u200b\u795e\u7ecf\u7f51\u7edc\u200b\\(G(\\cdot )\\) \u200b\u662f\u200b\u4e0e\u200b\u6f5c\u5728\u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_t\\) \u200b\u5171\u540c\u200b\u5b66\u4e60\u200b\u7684\u200b\u3002III.C\u200b\u4e2d\u6709\u200b\u8be6\u7ec6\u200b\u7684\u200b\u51fd\u6570\u200b\u5f62\u5f0f\u200b\u3002</p> <p>\u200b\u8ba9\u200b \\(\\widehat{r}_{i, t}\\) \u200b\u4ee3\u8868\u200b\u7531\u200b\u4ea4\u6613\u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_t\\) \u200b\u6784\u9020\u200b\u7684\u200b\u7ebf\u6027\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u53bb\u200b\u6a21\u62df\u200b\u8d44\u4ea7\u200b\u56de\u62a5\u200b \\(r_{i,t}\\)\u3002 \\(\\widehat{r}_{i, t} = \\boldsymbol{\\beta}_{i,t-1}^\\intercal \\mathbf{f}_t\\)\u3002\u200b\u82e5\u200b\u6b8b\u5dee\u200b\u9879\u200b \\(\\epsilon_{i,t}\\) \u200b\u7684\u200b\u5e73\u5747\u503c\u200b\u4e3a\u200b0\uff0c\u200b\u5219\u200b\u622a\u8ddd\u200b\u9879\u200b\\(\\alpha_{i}\\) \u200b\u7b49\u4e8e\u200b\u5e73\u5747\u200b\u62df\u5408\u200b\u8bef\u5dee\u200b \\(\\frac{1}{T}\\sum_{t=1}^{T}\\alpha_{i,t}\\)\uff0c\u200b\u5176\u4e2d\u200b \\(\\alpha_{i,t} = r_{i,t} - \\widehat{r}_{i,t}\\)</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iib","title":"II.B  \u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u4e2d\u200b\u7684\u200b\u7279\u5f81\u200b\u6392\u5e8f\u200b\u56e0\u5b50","text":"<p>\u200b\u4e3a\u4e86\u200b\u5bf9\u200b\u98ce\u9669\u200b\u8c03\u6574\u200b\u540e\u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b\u8fdb\u884c\u200b\u5efa\u6a21\u200b\uff0c \u200b\u589e\u5f3a\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u9664\u4e86\u200b\\(P_b\\)-factor \u200b\u57fa\u51c6\u200b\u6a21\u578b\u200b \\(\\mathbf{f}_{b,t}\\)  \uff08CAPM\u200b\u6216\u200bFama-French 5\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\uff09\u200b\u4e4b\u5916\u200b\uff0c \u200b\u8fd8\u200b\u751f\u6210\u200b\u4e86\u200b \\(P_d\\) \u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b \\(\\mathbf{f}_{d,t}\\)\uff0c \u200b\u5171\u540c\u200b\u5b9a\u4ef7\u200b\u4e2a\u80a1\u200b\u56de\u62a5\u200b\u3002 \u200b\u8fd9\u91cc\u200b\u4f7f\u7528\u200b \\(\\mathbf{f}_t = [\\mathbf{f}_{d,t}^\\intercal,\\mathbf{f}_{b,t}^\\intercal]^\\intercal\\)  \u200b\u8868\u793a\u200b\u4e24\u7ec4\u200b\u56e0\u5b50\u200b\uff0c\u200b\u5373\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u548c\u200b\u57fa\u51c6\u200b\u56e0\u5b50\u200b\u3002 \u200b\u5c06\u200b\u5df2\u200b\u5b9e\u73b0\u200b\u56de\u62a5\u200b\u9884\u6d4b\u200b \\(\\widehat{r}_{i,t}\\) \u200b\u6784\u9020\u200b\u4e3a\u200b \\(\\mathbf{f}_{d,t}\\) \u200b\u548c\u200b \\(\\mathbb{f}_{b,f}\\) \u200b\u7684\u200b\u65e0\u200b\u622a\u8ddd\u200b\u9879\u200b\u7684\u200b\u7ebf\u6027\u7ec4\u5408\u200b\u3002 \u200b\u56e0\u6b64\u200b\uff0c\u200b\u62df\u5408\u200b\u8bef\u5dee\u200b \\(\\alpha_{i,t}\\)\uff0c\u200b\u8861\u91cf\u200b\u4e86\u200b\u6a2a\u622a\u9762\u200b\u548c\u200b\u65f6\u95f4\u200b\u5e8f\u5217\u200b\u7684\u200b\u53d8\u5316\u200b\u3002\u200b\u5b8c\u6574\u200b\u7684\u200b\u6a21\u578b\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         \\widehat{r}_{i,t} &amp; = \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_t \\\\             &amp; = \\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{d,t} + \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{b,t}, \\\\         \\alpha_{i,t} &amp; = r_{i,t} - \\widehat{r}_{i,t}, \\\\         \\mathbf{f}_{d,t} &amp; = \\mathbf{W}_{t-1} \\mathbf{r}_t, \\\\         \\mathbf{W}_{t-1} &amp; = H(\\mathbf{Z}_{t-1}), \\\\         \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1}) &amp; = G(\\mathbf{z}_{i,t-1}),     \\end{split} \\end{equation}\\] <ul> <li>\\(\\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal = [\\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal, \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal]\\)  \u200b\u662f\u200b\u5206\u522b\u200b\u5bf9\u5e94\u200b\u4e8e\u200b\u6f5c\u5728\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u548c\u200b\u57fa\u51c6\u200b\u56e0\u5b50\u200b\u7684\u200b\u52a8\u6001\u200b betas \u3002</li> <li>\\(\\mathbf{r}_t = (r_{1,t},\\dots,r_{N,t})\\) \u200b\u8868\u793a\u200b\u6708\u4efd\u200b \\(t\\) \u200b\u65f6\u200b \\(N\\) \u200b\u4e2a\u80a1\u200b\u7684\u200b\u56de\u62a5\u200b\u5411\u91cf\u200b</li> <li>\\(\\mathbf{W}_{t-1}\\) \u200b\u662f\u200b\u7531\u200b\u6708\u4efd\u200b \\(t\u22121\\) \u200b\u786e\u5b9a\u200b\u7684\u200b \\(P_d \\times N\\) \u200b\u77e9\u9635\u200b\uff0c \u200b\u7528\u4e8e\u200b long-short \u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b\u3002</li> <li>\\(\\mathbf{Z}_{t-1} = (\\mathbf{z}_{1,t-1},\\dots,\\mathbf{z}_{N,t-1})\\)  \u200b\u662f\u200b\u6ede\u540e\u200b\u516c\u53f8\u200b\u7279\u5f81\u200b\u7684\u200b \\(K_0 \\times N\\) \u200b\u7ef4\u200b\u77e9\u9635\u200b\u3002</li> </ul> <p>\u200b\u76ee\u6807\u200b\u662f\u200b\u6700\u5c0f\u5316\u200b\u5728\u200b\u6240\u6709\u200b\u5468\u671f\u200b\u548c\u200b\u8d44\u4ea7\u200b\u7684\u200b\u5df2\u200b\u5b9e\u73b0\u200b\u5b9a\u4ef7\u200b\u8bef\u5dee\u200b\u7684\u200b\u4e8c\u6b21\u200b\u548c\u200b\uff1a</p> \\[\\begin{equation}     \\mathcal{L}_\\lambda = \\sum_{i=1}^{N}\\sum_{t=1}^{T_i}(r_{i,t} - \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_t)^2 + \\lambda \\times \\text{penalty(DL)},  \\end{equation}\\]"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iic-fama-french-5","title":"II.C  \u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u4e2d\u200b\u7684\u200bFama-French 5 \u200b\u56e0\u5b50\u200b\u6a21\u578b","text":"Deep Learning Network Architecture"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iii","title":"III \u200b\u6df1\u5ea6\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7684\u200b\u7ed3\u6784","text":"Deep Learning Network Architecture <ul> <li>III.A \u200b\u63ed\u793a\u200b\u5982\u4f55\u200b\u5728\u200b\u524d\u9988\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u5bf9\u200b [inputs] \u200b\u516c\u53f8\u200b\u7279\u5f81\u200b\u8fdb\u884c\u200b\u964d\u7ef4\u200b</li> <li>III.B \u200b\u8ba1\u7b97\u200b\u591a\u7a7a\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b(long-short portfolio)\u200b\u7684\u200b\u6743\u91cd\u200b</li> <li>III.C \u200b\u8ba1\u7b97\u200b [intermediate features] \u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b</li> <li>III.D \u200b\u63cf\u8ff0\u200b\u4f18\u5316\u200b\u76ee\u6807\u200b\uff0c\u200b\u603b\u7ed3\u200b\u5b8c\u6574\u200b\u7684\u200b\u589e\u5f3a\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b</li> </ul> <p>\u200b\u4ee5\u200b\u65f6\u95f4\u200b \\(t\\) \u200b\u4e3a\u200b\u7d22\u5f15\u200b\u7684\u200b\u5178\u578b\u200b\u8bad\u7ec3\u200b\u89c2\u5bdf\u200b\u5305\u62ec\u200b\u4ee5\u4e0b\u200b\u6570\u636e\u7c7b\u578b\u200b\uff1a</p> <ul> <li>\\(\\{r_{i,t}\\}_{i=1}^N\\)\uff0c\\(N\\) \u200b\u53ea\u200b\u4e2a\u80a1\u200b\u7684\u200b\u8d85\u989d\u200b\u56de\u62a5\u200b</li> <li>\\(\\{z_{k,i,t-1}:1\\leq k \\leq K_0\\}_{i=1}^N\\)\uff0c\\(N\\) \u200b\u53ea\u200b\u4e2a\u80a1\u200b\u7684\u200b \\(K_0\\) \u200b\u4e2a\u200b\u6ede\u540e\u200b\u7279\u5f81\u200b</li> <li>\\(\\{f_{d,t}\\}_{d=1}^{P_b}\\)\uff0c\\(P_b\\) \u200b\u4e2a\u200b\u57fa\u51c6\u200b\u56e0\u5b50\u200b</li> </ul>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiia","title":"III.A  \u200b\u6df1\u5ea6\u200b\u7279\u5f81","text":"<p>\u200b\u5bf9\u200b\u539f\u59cb\u6570\u636e\u200b\u7684\u200b\u7279\u5f81\u200b\u8fdb\u884c\u200b\u964d\u7ef4\u200b\uff0c\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7684\u200b asset \\(i = 1,2,\\dots,N\\)  \u200b\u548c\u200b \\(l\\)-th \u200b\u5c42\u200b\u7684\u200b\u7ed3\u6784\u200b\u5982\u4e0b\u200b\uff08\u200b\u539f\u59cb\u200b\u8f93\u5165\u200b [inputs] \u200b\u4e3a\u200b \\(l = 0\\) \u200b\u5c42\u200b\uff09\uff1a</p> \\[\\begin{equation*}     \\begin{split}         \\mathbf{z}_{i,t-1}^{[l]} &amp; = F^{[l]}(A^{[l]}\\mathbf{z}_{i,t-1}^{[l-1]} + b^{[l]}),\\quad for \\quad l = 1,2,\\dots,L \\\\         \\mathbf{z}_{i,t-1}^{[0]} &amp; := [z_{1,i,t-1},\\dots,z_{K_0,i,t-1}]^\\intercal,       \\end{split} \\end{equation*}\\] <ul> <li>\\(\\mathbf{z}_{i,t-1}^{[l]}\\)\uff0c\\(K_l \\times N\\) \u200b\u77e9\u9635\u200b \\(\\mathbf{Z}_{t-1}^{[l]}\\) \u200b\u7684\u200b \\(i\\)-th \u200b\u5217\u200b</li> <li>\u200b\u5355\u200b\u53d8\u91cf\u200b\u6fc0\u6d3b\u200b\u51fd\u6570\u200b \\(F(\\cdot) = tanh(\\cdot)\\) \u200b\u4f5c\u7528\u200b\u5230\u200b\u77e9\u9635\u200b\u7684\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u5143\u7d20\u200b\u4e0a\u200b</li> <li>\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7684\u200b\u6743\u91cd\u200b \\(A\\) \u200b\u548c\u200b\u504f\u5dee\u200b \\(b\\) \u200b\u662f\u200b\u8fd9\u90e8\u5206\u200b\u9700\u8981\u200b\u88ab\u200b\u8bad\u7ec3\u200b\u7684\u200b\u53c2\u6570\u200b</li> </ul> \\[\\{(A^{[l]}, b^{[l]}):A^{l}\\in \\mathbb{R}^{K_l \\times K_{l-1}},b^{[l]}\\in \\mathbb{R}^{K_l}    \\}_{l=1}^L \\] <p>\u200b\u4e0e\u200b\u6807\u51c6\u200b\u7684\u200b\u6df1\u5ea6\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7ed3\u6784\u200b\u4e0d\u540c\u200b\uff0c \u200b\u6bcf\u4e2a\u200b\u795e\u7ecf\u5143\u200b\u90fd\u200b\u4e0e\u200b\u524d\u200b\u4e00\u5c42\u200b\u7684\u200b\u6240\u6709\u200b\u795e\u7ecf\u5143\u200b\u5b8c\u5168\u200b\u8fde\u63a5\u200b\uff0c \u200b\u8fd9\u4e9b\u200b\u53d8\u6362\u200b\u662f\u200b\u6309\u5217\u200b\u6267\u884c\u200b\u7684\u200b\uff0c\u200b\u6ca1\u6709\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200b\u80a1\u7968\u200b\u4e4b\u95f4\u200b\u8fdb\u884c\u200b\u901a\u4fe1\u200b\u3002 \u200b\u6b64\u200b\u90e8\u5206\u200b\u4e2d\u200b\u6267\u884c\u200b\u7684\u200b\u6240\u6709\u200b\u53d8\u6362\u200b\u90fd\u200b\u5728\u200b\u5355\u200b\u53ea\u200b\u80a1\u7968\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u3002 \u200b\u4e24\u4e2a\u200b\u4e0d\u540c\u200b\u7684\u200b\u80a1\u7968\u200b\u7684\u200b\u6570\u636e\u200b\uff08\u200b\u548c\u200b\u4e2d\u95f4\u200b\u7ed3\u679c\u200b\uff09\u200b\u662f\u200b\u5206\u5f00\u200b\u7684\u200b\uff0c \u200b\u5e76\u4e14\u200b\u4e0d\u200b\u76f8\u4e92\u200b\u5e72\u6270\u200b\u3002 \u200b\u8fd9\u79cd\u200b\u8bbe\u7f6e\u200b\u5141\u8bb8\u200b\u7279\u5b9a\u200b\u4e2a\u4f53\u200b\u80a1\u7968\u200b\u7684\u200b\u6df1\u5c42\u200b\u7279\u5f81\u200b\u7531\u200b\u5176\u200b\u81ea\u8eab\u200b\u51b3\u5b9a\u200b\uff0c \u200b\u800c\u200b\u4e0d\u662f\u200b\u7531\u200b\u5176\u4ed6\u200b\u80a1\u7968\u200b\u51b3\u5b9a\u200b\u3002 \u200b\u7136\u540e\u200b\uff0c\u200b\u6839\u636e\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u5bf9\u200b\u6240\u6709\u200b\u80a1\u7968\u200b\u8fdb\u884c\u200b\u5206\u7c7b\u200b\uff0c \u200b\u6536\u96c6\u200b\u4e0d\u540c\u200b\u80a1\u7968\u200b\u7684\u200b\u4fe1\u606f\u200b\u3002 \u200b\u5b9e\u8bc1\u200b\u7814\u7a76\u200b\u53d1\u73b0\u200b\uff0c\u200b\u7814\u7a76\u200b\u7ed3\u679c\u200b\u5bf9\u200b\u6fc0\u6d3b\u200b\u51fd\u6570\u200b\u7684\u200b\u9009\u62e9\u200b\u4e0d\u200b\u654f\u611f\u200b\uff0c \u200b\u800c\u200b\u7279\u5f81\u200b\u7684\u200b\u7ec4\u5408\u200b\u548c\u200b\u8f6c\u5316\u200b\u53d1\u6325\u200b\u7740\u200b\u66f4\u200b\u91cd\u8981\u200b\u7684\u200b\u4f5c\u7528\u200b\u3002 \u200b\u8fd9\u79cd\u200b\u591a\u5c42\u200b\u7ed3\u6784\u200b\u603b\u7ed3\u200b\u4e86\u200b\u4ece\u200b\u539f\u59cb\u200b\u7279\u5f81\u200b\u5230\u200b\u4f4e\u7ef4\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u7684\u200b\u4fe1\u606f\u200b\u3002</p> \\[\\begin{align}     \\mathbf{Y}_{t-1} &amp;:= \\mathbf{Z}_{t-1}^{[L]}, \\\\     \\mathbf{Z}_{t-1}^{[l]} &amp;:= F^{[l]}(A^{[l]}\\mathbf{Z}_{t-1}^{[l-1]} + b^{[l]}),\\quad for \\quad l = 1,2,\\dots,L\\\\     \\mathbf{Z}_{t-1}^{[0]} &amp;:= \\mathbf{Z}_{t-1}. \\end{align}\\] Deep Deep Neural Network of Characteristics"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiib","title":"III.B  \u200b\u6392\u5e8f\u200b\u548c\u200b\u975e\u7ebf\u6027\u200b\u6743\u91cd","text":"<p>\u200b\u7ed9\u5b9a\u200b\u7531\u200b\u516c\u5f0f\u200b\uff086\uff09\u200b\u7ed9\u51fa\u200b\u7684\u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u7ed3\u6784\u200b\u5f97\u5230\u200b\u7684\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b \\(\\mathbf{Y}_{t-1}\\)\uff0c\u200b\u53ef\u4ee5\u200b\u6309\u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u6784\u9020\u200b\u7684\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b \\(\\mathbf{W}_{t-1}\\)\u3002</p> <p>\u200b\u5b9a\u4e49\u200b \\(h^{[0]} : \\mathbb{R}^N \\rightarrow [-1,1]^N\\) \u200b\u6839\u636e\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u7684\u200b\u6392\u540d\u200b\u6765\u200b\u8ba1\u7b97\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u7684\u200b\u6743\u91cd\u200b\u3002\u200b\u5f53\u200b\u53d8\u91cf\u200b\u4e3a\u200b\u77e9\u9635\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u5b83\u200b\u4f5c\u7528\u200b\u5230\u200b\u6240\u6709\u200b\u884c\u4e0a\u200b\u3002 \u200b\u8ba9\u200b \\(\\mathbb{y}_{t-1} = (y_1,\\dots,y_N)\\) \u200b\u4e3a\u200b \\(N\\times 1\\)\u200b\u5411\u91cf\u200b\uff0c\u200b\u4ee3\u8868\u200b1\u200b\u4e2a\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b(\\(\\mathbf{Y}_{t-1}\u200b\u7684\u200b\u4e00\u884c\u200b\\)) \u200b\u6743\u91cd\u200b\u4e3a\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         \\mathbf{W}_{t-1} = h^{[0]}(\\mathbf{y}_{t-1}) &amp;=              \\begin{matrix}                 \\text{long portfolio} \\\\                 \\overbrace{\\begin{bmatrix}                     \\text{softmax}(y_1^+)\\\\                     \\text{softmax}(y_2^+)\\\\                     \\vdots \\\\                     \\text{softmax}(y_N^+)                 \\end{bmatrix}}             \\end{matrix}              -               \\begin{matrix}                 \\text{short portfolio} \\\\                 \\overbrace{\\begin{bmatrix}                     \\text{softmax}(y_1^-)\\\\                     \\text{softmax}(y_2^-)\\\\                     \\vdots \\\\                     \\text{softmax}(y_N^-)                 \\end{bmatrix}}             \\end{matrix},\\\\             \\text{where} y^+ :&amp;= -50e^{-5y},\\quad y^- := -50e^{5y},\\\\             \\text{softmax}(y_i) &amp;=\\frac{e^{y_i}}{\\sum_{i=1}^{N}e^{y_i}}.     \\end{split} \\end{equation}\\] Comparison: Weight vs. Rank  <p>III.A\u200b\u548c\u200bIII.B\u200b\u5171\u540c\u200b\u8bf4\u660e\u200b\u4e86\u200b\u4ece\u200b\u6ede\u540e\u200b\u7279\u5f81\u200b \\(\\mathbf{Z}_{t\u22121}\\) \u200b\u5230\u200b\u4e2a\u4f53\u200b\u8d44\u4ea7\u200b\u6743\u91cd\u200b\\(\\mathbf{W}_{t-1}\\)\u200b\u7684\u200b\u6df1\u5ea6\u200b\u5b66\u4e60\u200b\u53d8\u6362\u200b\u3002\u200b\u4e3a\u4e86\u200b\u7b80\u5355\u200b\u8d77\u200b\u89c1\u200b\uff0c\u200b\u5c06\u200b\u8be5\u200b\u53d8\u6362\u200b\u8bb0\u200b\u4e3a\u200b</p> \\[\\begin{equation}     \\mathbf{W}_{t-1} = H(\\mathbf{Z}_{t-1}) \\end{equation}\\]"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiic-betas","title":"III.C  \u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u548c\u200b\u975e\u7ebf\u6027\u200b\u52a8\u6001\u200bbetas","text":"<p>\u200b\u672c\u200b\u5c0f\u8282\u200b\u7ee7\u7eed\u200b\u6784\u5efa\u200b\u57fa\u4e8e\u200blong-short\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b \\(\\mathbf{W}_{t-1}\\)\u200b\u7684\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\uff0c \u200b\u7136\u540e\u200b\u6784\u5efa\u200b\u4e00\u4e2a\u200b\u7528\u4e8e\u200b\u8d44\u4ea7\u200b\u5b9a\u4ef7\u200b\u7684\u200b\u589e\u5f3a\u200b\u7684\u200b\u6df1\u5ea6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u3002 \u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4e2a\u80a1\u200b\u56de\u62a5\u200b\u548c\u200b\u76f8\u5e94\u200b\u7684\u200b\u6743\u91cd\u200b\u6765\u200b\u521b\u5efa\u200blong-short\u200b\u56e0\u5b50\u200b\u3002 \u200b\u8be5\u200b\u6a21\u578b\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b \\(L\\) \u200b\u5c42\u200b\u751f\u6210\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u3002 \u200b\u518d\u63a5\u200b1\u200b\u5c42\u53bb\u200b\u751f\u6210\u200b\u6295\u8d44\u200b\u7ec4\u5408\u200b\u6743\u91cd\u200b\\(\\mathbf{W}_{t-1}\\)\uff0c\u200b\u5982\u4e0b\u200b\uff1a</p> \\[\\begin{equation}     \\begin{split}         \\mathbf{W}_{t-1} &amp; := \\text{Input frome Equation(9)} \\\\         \\mathbf{f}_{b,t} &amp; := \\mathbf{W}_{t-1} \\mathbf{r}_t \\\\         \\widehat{r}_{i,t} &amp; := \\boldsymbol{\\beta}(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_t = \\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{d,t} + \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{b,t}     \\end{split} \\end{equation}\\] <p>\u200b\u76ee\u524d\u200b\u5173\u4e8e\u200b\u6761\u4ef6\u200b\u56e0\u5b50\u200b\u6a21\u578b\u200b\u7684\u200b\u6587\u732e\u200b\u4e3b\u8981\u200b\u91c7\u7528\u200b\u4e86\u200b\u7ebf\u6027\u200b\u51fd\u6570\u200b\u5f62\u5f0f\u200b\u6765\u200b\u8868\u793a\u200b\u516c\u53f8\u200b\u7279\u5f81\u200b\u4e0a\u200b\u7684\u200b\u8d1d\u5854\u200b\u7cfb\u6570\u200b\u3002 \u200b\u672c\u200b\u6846\u67b6\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u79cd\u200b\u5185\u90e8\u200b\u4e00\u81f4\u200b\u7684\u200bbeta\u200b\u5efa\u6a21\u200b\u3002 \u200b\u5177\u4f53\u6765\u8bf4\u200b\uff0c\u200b\u5047\u8bbe\u200bbeta\u200b\u9075\u5faa\u200b\u4e00\u4e2a\u200b\u5728\u200b\u540c\u200b\u4e00\u7ec4\u200b\u9ad8\u7ef4\u200b\u7279\u5f81\u200b\u4e0a\u200b\u7684\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u7ed3\u6784\u200b \u200b\u6765\u200b\u8bad\u7ec3\u200b\u6df1\u5ea6\u200b\u7279\u5f81\u200b\u3002</p> \\[\\begin{equation}     [\\boldsymbol{\\beta}_d(\\mathbf{z}_{i,t-1})^\\intercal, \\boldsymbol{\\beta}_b(\\mathbf{z}_{i,t-1})^\\intercal]^\\intercal = G(\\mathbf{z}_{i,t-1}) \\end{equation}\\] <p>\u200b\u5c06\u200bbeta\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u4e0e\u200b\u56e0\u5b50\u200b\u795e\u7ecf\u7f51\u7edc\u200b\u8054\u5408\u200b\u8bad\u7ec3\u200b\uff0c \u200b\u6700\u5c0f\u5316\u200b\u635f\u5931\u200b\u51fd\u6570\u200b\u3002</p>"},{"location":"blog/2024/09/13/%E7%89%B9%E5%BE%81%E6%8E%92%E5%BA%8F%E5%9B%A0%E5%AD%90%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#iiid","title":"III.D  \u200b\u6700\u5c0f\u5316\u200b\u635f\u5931\u200b\u51fd\u6570","text":"\\[\\begin{equation}     \\mathcal{L}_\\lambda(\\widehat{\\Theta }) := \\frac{1}{NT}\\sum_{t=1}^{T}\\sum_{i=1}^{N}(r_{i,t}-\\widehat{r}_{i,t})^2 + \\lambda\\sum_{l=1}^{L-1}\\sum_{i\\neq j}|A_{i,j}^{[l]}|, \\end{equation}\\] <ul> <li>\\(\\widehat{\\Theta }\\) \u200b\u795e\u7ecf\u7f51\u7edc\u200b\u4e2d\u200b\u6240\u6709\u200b\u53c2\u6570\u200b</li> </ul> \\[\\begin{equation}     \\begin{split}         &amp;\\widehat{r}_{i,t} = \\boldsymbol{\\widehat{\\beta}}_d(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{d,t} + \\boldsymbol{\\widehat{\\beta}}_b(\\mathbf{z}_{i,t-1})^\\intercal \\mathbf{f}_{b,t}\\\\         &amp;[\\boldsymbol{\\widehat{\\beta}}_d(\\mathbf{z}_{i,t-1})^\\intercal, \\boldsymbol{\\widehat{\\beta}}_b(\\mathbf{z}_{i,t-1})^\\intercal]^\\intercal = G(\\mathbf{z}_{i,t-1})     \\end{split} \\end{equation}\\] \\[\\begin{equation}     \\widehat{\\Theta } = \\text{arg min}\\mathcal{L}_\\lambda \\end{equation}\\]"},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/category/code/","title":"Code","text":""},{"location":"blog/category/git/","title":"Git","text":""},{"location":"blog/category/reinforcement-learning/","title":"Reinforcement Learning","text":""},{"location":"blog/category/deep-learning/","title":"Deep Learning","text":""}]}